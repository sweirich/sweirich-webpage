<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Stlc.Nominal</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Stlc.Nominal</h1>

<div class="code">
</div>

<div class="doc">
A nominal representation of STLC terms.

<div class="paragraph"> </div>

    This version looks a lot like we expect a representation of
    the lambda calculus to look like. Unlike the LN version,
    the syntax does not distinguish between bound and free
    variables and abstractions include the name of binding
    variables.  
<div class="paragraph"> </div>

<a name="lab95"></a><h1 class="section">Imports</h1>

<div class="paragraph"> </div>

 Some of our proofs are by induction on the *size* of
    terms. We'll use Coq's <span class="inlinecode"><span class="id" title="tactic">omega</span></span> tactic to easily dispatch
    reasoning about natural numbers. 
</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.omega.Omega.html#"><span class="id" title="library">Omega</span></a>.<br/>

<br/>
</div>

<div class="doc">
We will use the <span class="inlinecode"><span class="id" title="abbreviation">atom</span></span> type from the metatheory library to
    represent variable names. 
</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">Metalib.Metatheory</span>.<br/>

<br/>
</div>

<div class="doc">
Although we are not using LNgen, some of the tactics from
    its library are useful for automating reasoning about
    names.  
</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">Metalib.LibLNgen</span>.<br/>

<br/>
</div>

<div class="doc">
Some fresh variables 
</div>
<div class="code">
<span class="id" title="keyword">Notation</span> <a name="X"><span class="id" title="abbreviation">X</span></a> := (<span class="id" title="abbreviation">fresh</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="Y"><span class="id" title="abbreviation">Y</span></a> := (<span class="id" title="abbreviation">fresh</span> (<a class="idref" href="Stlc.Nominal.html#X"><span class="id" title="abbreviation">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)).<br/>
<span class="id" title="keyword">Notation</span> <a name="Z"><span class="id" title="abbreviation">Z</span></a> := (<span class="id" title="abbreviation">fresh</span> (<a class="idref" href="Stlc.Nominal.html#X"><span class="id" title="abbreviation">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="Stlc.Nominal.html#Y"><span class="id" title="abbreviation">Y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)).<br/>

<br/>
</div>

<div class="doc">
<a name="lab96"></a><h1 class="section">A nominal representation of terms</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="n_exp"><span class="id" title="inductive">n_exp</span></a> : <span class="id" title="keyword">Set</span> :=<br/>
&nbsp;| <a name="n_var"><span class="id" title="constructor">n_var</span></a> (<span class="id" title="var">x</span>:<span class="id" title="abbreviation">atom</span>)<br/>
&nbsp;| <a name="n_abs"><span class="id" title="constructor">n_abs</span></a> (<span class="id" title="var">x</span>:<span class="id" title="abbreviation">atom</span>) (<span class="id" title="var">t</span>:<a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>)<br/>
&nbsp;| <a name="n_app"><span class="id" title="constructor">n_app</span></a> (<span class="id" title="var">t1</span>:<a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) (<span class="id" title="var">t2</span>:<a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>).<br/>

<br/>
</div>

<div class="doc">
For example, we can encode the expression <span class="inlinecode">(\<span class="id" title="var">X.Y</span></span> <span class="inlinecode"><a class="idref" href="Stlc.Nominal.html#X"><span class="id" title="abbreviation">X</span></a>)</span> as below.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="demo_rep1"><span class="id" title="definition">demo_rep1</span></a> := <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#X"><span class="id" title="abbreviation">X</span></a> (<a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#Y"><span class="id" title="abbreviation">Y</span></a>) (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#X"><span class="id" title="abbreviation">X</span></a>)).<br/>

<br/>
</div>

<div class="doc">
For example, we can encode the expression <span class="inlinecode">(\<span class="id" title="var">Z.Y</span></span> <span class="inlinecode"><a class="idref" href="Stlc.Nominal.html#Z"><span class="id" title="abbreviation">Z</span></a>)</span> as below.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="demo_rep2"><span class="id" title="definition">demo_rep2</span></a> := <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#Z"><span class="id" title="abbreviation">Z</span></a> (<a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#Y"><span class="id" title="abbreviation">Y</span></a>) (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#Z"><span class="id" title="abbreviation">Z</span></a>)).<br/>

<br/>
</div>

<div class="doc">
As usual, the free variable function needs to remove the
    bound variable in the <span class="inlinecode"><a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a></span> case. 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <a name="fv_nom"><span class="id" title="definition">fv_nom</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) : <span class="id" title="abbreviation">atoms</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <span class="id" title="var">x</span> ⇒ <span class="id" title="notation">{{</span><span class="id" title="var">x</span><span class="id" title="notation">}}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ⇒ <span class="id" title="abbreviation">remove</span> <span class="id" title="var">x</span> (<a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <span class="id" title="var">t1</span> <span class="id" title="notation">`</span><span class="id" title="notation">union</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <span class="id" title="var">t2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The tactics for reasoning about lists and sets of atoms are useful here
    too. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="fv_nom_rep1"><span class="id" title="definition">fv_nom_rep1</span></a> : <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#demo_rep1"><span class="id" title="definition">demo_rep1</span></a> <span class="id" title="notation">[=]</span> <span class="id" title="notation">{{</span> <a class="idref" href="Stlc.Nominal.html#Y"><span class="id" title="abbreviation">Y</span></a> <span class="id" title="notation">}}</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="Stlc.Nominal.html#Y"><span class="id" title="abbreviation">Y</span></a> (<a class="idref" href="Stlc.Nominal.html#X"><span class="id" title="abbreviation">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)). &nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="axiom">Atom.fresh_not_in</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">elim_not_In_cons</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">fsetdec</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
What makes this a *nominal* representation is that our
    operations are based on the following swapping function for
    names.  Note that this operation is symmetric: <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#x"><span class="id" title="variable">x</span></a></span> becomes
    <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#y"><span class="id" title="variable">y</span></a></span> and <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#y"><span class="id" title="variable">y</span></a></span> becomes <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#x"><span class="id" title="variable">x</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="swap_var"><span class="id" title="definition">swap_var</span></a> (<span class="id" title="var">x</span>:<span class="id" title="abbreviation">atom</span>) (<span class="id" title="var">y</span>:<span class="id" title="abbreviation">atom</span>) (<span class="id" title="var">z</span>:<span class="id" title="abbreviation">atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <span class="id" title="notation">==</span> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>) <span class="id" title="keyword">then</span> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> (<a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <span class="id" title="notation">==</span> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>) <span class="id" title="keyword">then</span> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a>.<br/>

<br/>
</div>

<div class="doc">
The main insight of nominal representations is that we can
    rename variables, without capture, using a simple
    structural induction. Note how in the <span class="inlinecode"><a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a></span> case we swap
    all variables, both bound and free.

<div class="paragraph"> </div>

    For example:

<div class="paragraph"> </div>

      (swap x y) (\z. (x y)) = \z. (y x))

<div class="paragraph"> </div>

      (swap x y) (\x. x) = \y.y

<div class="paragraph"> </div>

      (swap x y) (\y. x) = \x.y

<div class="paragraph"> </div>


</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <a name="swap"><span class="id" title="definition">swap</span></a> (<span class="id" title="var">x</span>:<span class="id" title="abbreviation">atom</span>) (<span class="id" title="var">y</span>:<span class="id" title="abbreviation">atom</span>) (<span class="id" title="var">t</span>:<a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <span class="id" title="var">z</span>     ⇒ <a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> (<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <span class="id" title="var">z</span> <span class="id" title="var">t1</span>  ⇒ <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> (<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="var">z</span>) (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="var">t1</span>) (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Because swapping is a simple, structurally recursive
    function, it is highly automatable using the <span class="inlinecode"><span class="id" title="var">default_simp</span></span>
    tactic from LNgen library.

<div class="paragraph"> </div>

    This tactic "simplifies" goals using a combination of
    common proof steps, including case analysis of all disjoint
    sums in the goal. Because atom equality returns a sumbool,
    this makes this tactic useful for reasoning by cases about
    atoms.

<div class="paragraph"> </div>

    For more information about the <span class="inlinecode"><span class="id" title="var">default_simp</span></span> tactic, see
    <span class="inlinecode"><span class="id" title="var">metalib</span>/<span class="id" title="var">LibDefaultSimp.v</span></span>.

<div class="paragraph"> </div>

    WARNING: this tactic is not always safe. It's a power tool
    and can put your proof in an irrecoverable state. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="swap1"><span class="id" title="definition">swap1</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>, <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> (<a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>)(<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> (<a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>) (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a>; <span class="id" title="var">default_simp</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="swap2"><span class="id" title="definition">swap2</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a>; <span class="id" title="var">default_simp</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="swap3"><span class="id" title="definition">swap3</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a>; <span class="id" title="var">default_simp</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
We define the "alpha-equivalence" relation that declares
    when two nominal terms are equivalent (up to renaming of
    bound variables).

<div class="paragraph"> </div>

    Note the two different rules for <span class="inlinecode"><a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a></span>: either the
    binders are the same and we can directly compare the
    bodies, or the binders differ, but we can swap one side to
    make it look like the other.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="aeq"><span class="id" title="inductive">aeq</span></a> : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;| <a name="aeq_var"><span class="id" title="constructor">aeq_var</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>) (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>)<br/>
&nbsp;| <a name="aeq_abs_same"><span class="id" title="constructor">aeq_abs_same</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a>) (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a>)<br/>
&nbsp;| <a name="aeq_abs_diff"><span class="id" title="constructor">aeq_abs_diff</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">`</span><span class="id" title="notation">notin</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a>) (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a>)<br/>
&nbsp;| <a name="aeq_app"><span class="id" title="constructor">aeq_app</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t1'</span> <span class="id" title="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="Stlc.Nominal.html#t1'"><span class="id" title="variable">t1'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="Stlc.Nominal.html#t2'"><span class="id" title="variable">t2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> (<a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a>) (<a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> <a class="idref" href="Stlc.Nominal.html#t1'"><span class="id" title="variable">t1'</span></a> <a class="idref" href="Stlc.Nominal.html#t2'"><span class="id" title="variable">t2'</span></a>).<br/>

<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="aeq1"><span class="id" title="definition">aeq1</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#aeq"><span class="id" title="inductive">aeq</span></a> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>)) (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="Stlc.Nominal.html#aeq_abs_diff"><span class="id" title="constructor">aeq_abs_diff</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a>; <span class="id" title="var">default_simp</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab97"></a><h2 class="section">Properties about swapping</h2>

<div class="paragraph"> </div>

 Now let's look at some simple properties of swapping. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="swap_id"><span class="id" title="lemma">swap_id</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a>;  <span class="id" title="var">default_simp</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Demo: We will need the next two properties later in the tutorial,
    so we show that even though there are many cases to consider,
    <span class="inlinecode"><span class="id" title="var">default_simp</span></span> can find these proofs. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="fv_nom_swap"><span class="id" title="lemma">fv_nom_swap</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">z</span> <span class="id" title="var">y</span> <span class="id" title="var">n</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <span class="id" title="notation">`</span><span class="id" title="notation">notin</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="notation">`</span><span class="id" title="notation">notin</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a>; <span class="id" title="var">default_simp</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="shuffle_swap"><span class="id" title="lemma">shuffle_swap</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">w</span> <span class="id" title="var">y</span> <span class="id" title="var">n</span> <span class="id" title="var">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a>; <span class="id" title="var">default_simp</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a name="lab98"></a><h2 class="section">Exercises</h2>

<div class="paragraph"> </div>

<a name="lab99"></a><h3 class="section">Recommended Exercise: <span class="inlinecode"><a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a></span> properties</h3>


<div class="paragraph"> </div>

    Prove the following properties about swapping, either
    explicitly (by destructing <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">==</span> <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#y"><span class="id" title="variable">y</span></a></span>) or automatically
    (using <span class="inlinecode"><span class="id" title="var">default_simp</span></span>).  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="swap_symmetric"><span class="id" title="lemma">swap_symmetric</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">t</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="swap_involutive"><span class="id" title="lemma">swap_involutive</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">t</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab100"></a><h3 class="section">Challenge exercise: equivariance</h3>


<div class="paragraph"> </div>

    Equivariance is the property that all functions and
    relations are preserved under swapping. (Hint:
    <span class="inlinecode"><span class="id" title="var">default_simp</span></span> will be slow on some of these properties, and
    sometimes won't be able to do them automatically.)  
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="swap_var_equivariance"><span class="id" title="lemma">swap_var_equivariance</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">v</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">w</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="Stlc.Nominal.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="Stlc.Nominal.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> (<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a>) (<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#w"><span class="id" title="variable">w</span></a>) (<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#v"><span class="id" title="variable">v</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="swap_equivariance"><span class="id" title="lemma">swap_equivariance</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">t</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">w</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="Stlc.Nominal.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> (<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a>) (<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#w"><span class="id" title="variable">w</span></a>) (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="notin_fv_nom_equivariance"><span class="id" title="lemma">notin_fv_nom_equivariance</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x0</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">t</span> ,<br/>
&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#x0"><span class="id" title="variable">x0</span></a> <span class="id" title="notation">`</span><span class="id" title="notation">notin</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#x0"><span class="id" title="variable">x0</span></a>  <span class="id" title="notation">`</span><span class="id" title="notation">notin</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="in_fv_nom_equivariance"><span class="id" title="lemma">in_fv_nom_equivariance</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">x0</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#x0"><span class="id" title="variable">x0</span></a> <span class="id" title="notation">`</span><span class="id" title="keyword">in</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#swap_var"><span class="id" title="definition">swap_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#x0"><span class="id" title="variable">x0</span></a> <span class="id" title="notation">`</span><span class="id" title="keyword">in</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab101"></a><h1 class="section">An abstract machine for cbn evaluation</h1>

<div class="paragraph"> </div>

 The advantage of named terms is an efficient operational
    semantics! Compared to LN or de Bruijn representation, we
    don't need always need to modify terms (such as via open or
    shifting) as we traverse binders. Instead, as long as the
    binder is "sufficiently fresh" we can use the name as is,
    and only rename (via swapping) when absolutely
    necessary. 
<div class="paragraph"> </div>

 Below, we define an operational semantics based on an
    abstract machine. As before, it will model execution as a
    sequence of small-step transitions. However, transition
    will be between <i>machine configurations</i>, not just
    expressions.

<div class="paragraph"> </div>

    Our abstract machine configurations have three components:

<div class="paragraph"> </div>

<ul class="doclist">
<li> the current expression being evaluated the heap (aka

</li>
<li> environment): a mapping between variables and expressions

</li>
<li> the stack: the evaluation context of the current

</li>
<li> expression

</li>
</ul>

<div class="paragraph"> </div>

    Because we have a heap, we don't need to use substitution
    to define our semantics! To implement <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">~&gt;</span> <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#e"><span class="id" title="variable">e</span></a></span> we add a
    definition that <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#x"><span class="id" title="variable">x</span></a></span> maps to <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#e"><span class="id" title="variable">e</span></a></span> in the heap and then look
    up the definition when we get to <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#x"><span class="id" title="variable">x</span></a></span> during evaluation.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="heap"><span class="id" title="definition">heap</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<span class="id" title="abbreviation">atom</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="frame"><span class="id" title="inductive">frame</span></a> : <span class="id" title="keyword">Set</span> := | <a name="n_app2"><span class="id" title="constructor">n_app2</span></a> : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#frame"><span class="id" title="inductive">frame</span></a>.<br/>
<span class="id" title="keyword">Notation</span>  <a name="stack"><span class="id" title="abbreviation">stack</span></a> := (<a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Stlc.Nominal.html#frame"><span class="id" title="inductive">frame</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="configuration"><span class="id" title="definition">configuration</span></a> := (<a class="idref" href="Stlc.Nominal.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="Stlc.Nominal.html#stack"><span class="id" title="abbreviation">stack</span></a>)%<span class="id" title="var">type</span>.<br/>

<br/>
</div>

<div class="doc">
The (small-step) semantics is a <i>function</i> from
    configurations to configurations, until completion or
    error. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="Step"><span class="id" title="inductive">Step</span></a> <span class="id" title="var">a</span> := <a name="Error"><span class="id" title="constructor">Error</span></a>    : <a class="idref" href="Stlc.Nominal.html#Step"><span class="id" title="inductive">Step</span></a> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a name="Done"><span class="id" title="constructor">Done</span></a>     : <a class="idref" href="Stlc.Nominal.html#Step"><span class="id" title="inductive">Step</span></a> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a name="TakeStep"><span class="id" title="constructor">TakeStep</span></a> : <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#Step"><span class="id" title="inductive">Step</span></a> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="isVal"><span class="id" title="definition">isVal</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>         ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="machine_step"><span class="id" title="definition">machine_step</span></a> (<span class="id" title="var">avoid</span> : <span class="id" title="abbreviation">atoms</span>) (<span class="id" title="var">c</span> : <a class="idref" href="Stlc.Nominal.html#configuration"><span class="id" title="definition">configuration</span></a>) : <a class="idref" href="Stlc.Nominal.html#Step"><span class="id" title="inductive">Step</span></a> <a class="idref" href="Stlc.Nominal.html#configuration"><span class="id" title="definition">configuration</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Stlc.Nominal.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">h</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Stlc.Nominal.html#isVal"><span class="id" title="definition">isVal</span></a> <span class="id" title="var">t</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> ⇒ <a class="idref" href="Stlc.Nominal.html#Done"><span class="id" title="constructor">Done</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_app2"><span class="id" title="constructor">n_app2</span></a> <span class="id" title="var">t2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <span class="id" title="var">s'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <span class="id" title="var">x</span> <span class="id" title="var">t1</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="lemma">AtomSetProperties.In_dec</span> <span class="id" title="var">x</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">h</span> <span class="id" title="notation">`</span><span class="id" title="notation">union</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#avoid"><span class="id" title="variable">avoid</span></a>)  <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">y</span>,<span class="id" title="var">_</span>) := <span class="id" title="lemma">atom_fresh</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">h</span> <span class="id" title="notation">`</span><span class="id" title="notation">union</span><span class="id" title="notation">`</span> <a class="idref" href="Stlc.Nominal.html#avoid"><span class="id" title="variable">avoid</span></a>) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#TakeStep"><span class="id" title="constructor">TakeStep</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">((</span></a><a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">t2</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">h</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <span class="id" title="var">x</span> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">s'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#TakeStep"><span class="id" title="constructor">TakeStep</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">((</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">t2</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">h</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">s'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="Stlc.Nominal.html#Error"><span class="id" title="constructor">Error</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <span class="id" title="var">x</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="definition">get</span> <span class="id" title="var">x</span> <span class="id" title="var">h</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">t1</span>  ⇒ <a class="idref" href="Stlc.Nominal.html#TakeStep"><span class="id" title="constructor">TakeStep</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">h</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>    ⇒ <a class="idref" href="Stlc.Nominal.html#Error"><span class="id" title="constructor">Error</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <a class="idref" href="Stlc.Nominal.html#TakeStep"><span class="id" title="constructor">TakeStep</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">h</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Stlc.Nominal.html#n_app2"><span class="id" title="constructor">n_app2</span></a> <span class="id" title="var">t2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="Stlc.Nominal.html#Error"><span class="id" title="constructor">Error</span></a> <span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="initconf"><span class="id" title="definition">initconf</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) : <a class="idref" href="Stlc.Nominal.html#configuration"><span class="id" title="definition">configuration</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
Example: evaluation of  "(\y. (\x. x) y) Z"

<div class="paragraph"> </div>

<pre>
     machine                                       corresponding term

      {}, (\y. (\x. x) y) Z , nil                  (\y. (\x. x) y) Z
  ==&gt; {}, (\y. (\x. x) y), n_app2 Z :: nil         (\y. (\x. x) y) Z
  ==&gt; {y -&gt; Z}, (\x.x) y, nil                      (\x. x) Z
  ==&gt; {y -&gt; Z}, (\x.x), n_app2 y :: nil            (\x. x) Z
  ==&gt; {x -&gt; y, y -&gt; Z}, x, nil                     Z
  ==&gt; {x -&gt; y, y -&gt; Z}, y, nil                     Z
  ==&gt; {x -&gt; y, y -&gt; Z}, Z, nil                     Z
  ==&gt; Done
</pre>

<div class="paragraph"> </div>

(Note that the machine takes extra steps compared to the
substitution semantics.)

<div class="paragraph"> </div>

We will prove that this machine implements the substitution
semantics in the next section.

<div class="paragraph"> </div>


<div class="paragraph"> </div>

<a name="lab102"></a><h2 class="section">Recommended Exercise <span class="inlinecode"><a class="idref" href="Stlc.Nominal.html#values_are_done"><span class="id" title="lemma">values_are_done</span></a></span></h2>


<div class="paragraph"> </div>

    Show that values don't step using this abstract machine.
    (This is a simple proof.)

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="values_are_done"><span class="id" title="lemma">values_are_done</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">D</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#isVal"><span class="id" title="definition">isVal</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#machine_step"><span class="id" title="definition">machine_step</span></a> <a class="idref" href="Stlc.Nominal.html#D"><span class="id" title="variable">D</span></a> (<a class="idref" href="Stlc.Nominal.html#initconf"><span class="id" title="definition">initconf</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#Done"><span class="id" title="constructor">Done</span></a> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab103"></a><h1 class="section">Size based reasoning</h1>

<div class="paragraph"> </div>

 Some properties about nominal terms require calling the
    induction hypothesis not on a direct subterm, but on one
    that has first had a swapping applied to it.

<div class="paragraph"> </div>

    However, swapping names does not change the size of terms,
    so that means we can prove such properties by induction on
    that size.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="size"><span class="id" title="definition">size</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <span class="id" title="var">x</span> ⇒ 1<br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <span class="id" title="var">x</span> <span class="id" title="var">t</span> ⇒ 1 <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ 1 <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <span class="id" title="var">t1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <span class="id" title="var">t2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="swap_size_eq"><span class="id" title="lemma">swap_size_eq</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Rewrite</span> <a class="idref" href="Stlc.Nominal.html#swap_size_eq"><span class="id" title="lemma">swap_size_eq</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab104"></a><h2 class="section">Capture-avoiding substitution</h2>

<div class="paragraph"> </div>

 We need to use size to define capture avoiding
    substitution. Because we sometimes swap the name of the
    bound variable, this function is <i>not</i> structurally
    recursive. So, we add an extra argument to the function
    that decreases with each recursive call. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="subst_rec"><span class="id" title="definition">subst_rec</span></a> (<span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">t</span>:<a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) (<span class="id" title="var">u</span> :<a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) (<span class="id" title="var">x</span>:<span class="id" title="abbreviation">atom</span>)  : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m</span> ⇒ <span class="id" title="keyword">match</span> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <span class="id" title="var">y</span> ⇒ <span class="id" title="keyword">if</span> (<a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">==</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">then</span> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <span class="id" title="var">y</span> <span class="id" title="var">t1</span> ⇒ <span class="id" title="keyword">if</span> (<a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">==</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">then</span> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">let</span> (<span class="id" title="var">z</span>,<span class="id" title="var">_</span>) := <span class="id" title="lemma">atom_fresh</span> (<a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">u</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> (<a class="idref" href="Stlc.Nominal.html#subst_rec"><span class="id" title="definition">subst_rec</span></a> <span class="id" title="var">m</span> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <span class="id" title="var">y</span> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <span class="id" title="var">t1</span>) <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> (<a class="idref" href="Stlc.Nominal.html#subst_rec"><span class="id" title="definition">subst_rec</span></a> <span class="id" title="var">m</span> <span class="id" title="var">t1</span> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>) (<a class="idref" href="Stlc.Nominal.html#subst_rec"><span class="id" title="definition">subst_rec</span></a> <span class="id" title="var">m</span> <span class="id" title="var">t2</span> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Our real substitution function uses the size of the size of the term
    as that extra argument. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="subst"><span class="id" title="definition">subst</span></a> (<span class="id" title="var">u</span> : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) (<span class="id" title="var">x</span>:<span class="id" title="abbreviation">atom</span>) (<span class="id" title="var">t</span>:<a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#subst_rec"><span class="id" title="definition">subst_rec</span></a> (<a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>.<br/>

<br/>
</div>

<div class="doc">
This next lemma uses course of values induction <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Arith.Wf_nat.html#lt_wf_ind"><span class="id" title="lemma">lt_wf_ind</span></a></span> to prove that
    the size of the term <span class="inlinecode"><a class="idref" href="Stlc.Connect.html#t"><span class="id" title="variable">t</span></a></span> is enough "fuel" to completely calculate a
    substitution. Providing larger numbers produces the same result. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="subst_size"><span class="id" title="lemma">subst_size</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> (<span class="id" title="var">u</span> : <a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>) (<span class="id" title="var">x</span>:<span class="id" title="abbreviation">atom</span>) (<span class="id" title="var">t</span>:<a class="idref" href="Stlc.Nominal.html#n_exp"><span class="id" title="inductive">n_exp</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Peano.html#9b077c369e19739ef880736ba34623ff"><span class="id" title="notation">≤</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Stlc.Nominal.html#subst_rec"><span class="id" title="definition">subst_rec</span></a> <a class="idref" href="Stlc.Nominal.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#subst_rec"><span class="id" title="definition">subst_rec</span></a> (<a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="Stlc.Nominal.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Arith.Wf_nat.html#lt_wf_ind"><span class="id" title="lemma">lt_wf_ind</span></a> <span class="id" title="var">n</span>). <span class="id" title="tactic">clear</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">IH</span> <span class="id" title="var">u</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span> <span class="id" title="var">SZ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">default_simp</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">default_simp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="Stlc.Nominal.html#swap_size_eq"><span class="id" title="lemma">swap_size_eq</span></a> <span class="id" title="var">x0</span> <span class="id" title="var">x1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="Stlc.Nominal.html#swap_size_eq"><span class="id" title="lemma">swap_size_eq</span></a> <span class="id" title="var">x0</span> <span class="id" title="var">x1</span>) <span class="id" title="keyword">in</span> <span class="id" title="var">SZ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>. <span class="id" title="tactic">omega</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IH</span> <span class="id" title="var">n</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IH</span> <span class="id" title="var">n</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IH</span> (<a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <span class="id" title="var">t1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <span class="id" title="var">t2</span>)); <span class="id" title="tactic">try</span> <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IH</span> (<a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <span class="id" title="var">t1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Stlc.Nominal.html#size"><span class="id" title="definition">size</span></a> <span class="id" title="var">t2</span>)); <span class="id" title="tactic">try</span> <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab105"></a><h2 class="section">Challenge Exercise <span class="inlinecode"><span class="id" title="tactic">subst</span></span></h2>


<div class="paragraph"> </div>

    Use the definitions above to prove the following results about the
    nominal substitution function.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subst_eq_var"><span class="id" title="lemma">subst_eq_var</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">u</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subst_neq_var"><span class="id" title="lemma">subst_neq_var</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">u</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#n_var"><span class="id" title="constructor">n_var</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subst_app"><span class="id" title="lemma">subst_app</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">u</span> <span class="id" title="var">x</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Stlc.Nominal.html#n_app"><span class="id" title="constructor">n_app</span></a> (<a class="idref" href="Stlc.Nominal.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a>) (<a class="idref" href="Stlc.Nominal.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Stlc.Nominal.html#t2"><span class="id" title="variable">t2</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subst_abs"><span class="id" title="lemma">subst_abs</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">u</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">t1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">==</span> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a>) <span class="id" title="keyword">then</span> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">let</span> (<span class="id" title="var">z</span>,<span class="id" title="var">_</span>) := <span class="id" title="lemma">atom_fresh</span> (<a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">u</span> <a class="idref" href="Stlc.Nominal.html#fv_nom"><span class="id" title="definition">fv_nom</span></a> (<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a>)) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Stlc.Nominal.html#n_abs"><span class="id" title="constructor">n_abs</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> (<a class="idref" href="Stlc.Nominal.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Stlc.Nominal.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="Stlc.Nominal.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Stlc.Nominal.html#swap"><span class="id" title="definition">swap</span></a> <a class="idref" href="Stlc.Nominal.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Stlc.Nominal.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="Stlc.Nominal.html#t1"><span class="id" title="variable">t1</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>