%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: cast.dvi
%%CreationDate: Thu Jul 06 15:07:21 2000
%%Pages: 10
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Helvetica-Bold Helvetica Times-Bold Times-Italic
%%+ Times-Roman
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips cast.dvi
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2000.07.06:1458
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "1 July 1998",
%   filename = "8r.enc",
%   email = "tex-fonts@@tug.org",
%   docstring = "Encoding for TrueType or Type 1 fonts
%                to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both 
% ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
TeXDict begin 40258431 52099146 1000 600 600 (cast.dvi)
@start
%DVIPSBitmapFont: Fa cmr6 6 5
/Fa 5 54 df<13E01201120712FF12F91201B3A7487EB512C0A212217AA01E>49
D<EA01FC3807FF80381C0FC0383003E0386001F0EB00F812F86C13FCA2147C1278003013
FCC7FC14F8A2EB01F0EB03E014C0EB0780EB0F00131E13385B5B3801C00CEA0380380600
185A5A383FFFF85AB512F0A216217CA01E>I<13FF000313C0380F03E0381C00F014F800
3E13FC147CA2001E13FC120CC712F8A2EB01F0EB03E0EB0FC03801FF00A2380003E0EB00
F01478147C143E143F1230127812FCA2143E48137E0060137C003813F8381E03F0380FFF
C00001130018227DA01E>I<14E01301A213031307A2130D131D13391331136113E113C1
EA01811203EA07011206120C121C12181230127012E0B6FCA2380001E0A6EB03F0EB3FFF
A218227DA11E>I<00101330381E01F0381FFFE014C01480EBFE00EA1BF00018C7FCA513
FE381BFF80381F03C0381C01E0381800F014F8C71278A2147CA21230127812F8A2147848
13F8006013F0387001E01238381E07803807FF00EA01F816227CA01E>I
E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fb cmmi6 6 2
/Fb 2 106 df<90B512FCEDFF80903907C00FC0ED03F090380F800116F81500A290381F
0001A3ED03F0013E14E0ED07C0ED1F80ED7E0090387FFFF815E090387C01F0EC00784913
7C153C153EA24848137EA448485BEDFE06A20007EC7E0CD8FFFE1418ED3FF0C8EA07E027
237CA12E>82 D<1338137CA2137813701300A7EA0780EA1FC0EA38E01230EA60F0EAC1E0
A3EA03C0A3EA0780A2EA0F0013041306EA1E0CA21318121CEA1E70EA0FE0EA07800F237D
A116>105 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fc cmti7 6 2
/Fc 2 78 df<EBFFFCA2010FC7FCA2131EA45BA45BA45BA4485A150CA21518485AA21530
1570485A15E01403140FB612C0A21E227BA125>76 D<D9FF80EB01FFA2010FEC03E01606
011BEC07C0160D1619A2D931C0EB33801663A216C30161ECC700ED0187ED0307EB60E001
C0EB060E150CA21518D801805C153015601470D80300495AEC7180A2EC7300000601765B
A2143C121F3AFFE0380FFF143030227AA134>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fd cmsy6 6 1
/Fd 1 49 df<EA01E0EA03F0A4EA07E0A213C0120FA21380A2EA1F00A2121EA2123E123C
A25AA3127012F05A12600C1A7E9B12>48 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fe cmmi9 9 9
/Fe 9 60 df<147F903803FFE090380FC0F890383F007C017C017E1360497F484815E048
4890381F80C0120748481481EEC1804848130F003F15C390C7140016C74815C6007E15CE
16DC16D816F8485D5E5E127CA3151F6C143F037713C06C903801E7E03A0F800783E13B07
C07E03E3803B01FFF801FF003A007F80007C2B227EA031>11 D<ED0FE0ED7FF8913801F0
3E913803801F913907000F80020E13074A14C05C5C146014E0495A5C130391C7120F1780
49141F010615005E010E143E010C5C913807F8F890391C0FFFE09039181C0FC091381FFF
E0913807F9F00138C77E1330167CA20170147E1360A313E05BA3000115FE495CA300034A
5AA24B5A4B5A487E00064A5A6D495A0170013EC7FCD80E3813FC390C1E03F090380FFFC0
D901FCC8FC001CCAFC1218A312381230A312701260A312E0A22A447FB42B>I<EB1FC0D9
7FF0130348486C1307486D1306486D130E486D130C261FC03F131C3A3E000F8018003C01
07133848903803C03000700101137048010013604814E016E0C8EA60C01561ED71801533
1600A215371536A2153E153CA21538A31530A21570A3156015E0A44A5AA44A5AA44AC7FC
A328327FA028>I<EC7FE0903801FFFC903803C7FEEB0701EB0600153C010E1300130FA2
6D7EA280A2806D7E801301806D7E8080903803FF80010F13C0EB3F3FEB7C1F01F813E0EA
01F03803E00F1207390FC007F01380121F123F010013E0A25A127EA315C05A140FA2007C
1480141F1500A26C133E5C6C13786C6C5A3807C1E03801FFC0D8007EC7FC1F367EB422>
I<137001FCEB07C00001EC1FE0157F9038F801EFEC038F00039038070FC091381E0780D9
F038C7FC5C00075BEBF3C049C8FC13FE380FFFE014FE9038C1FF809038C01FE0001FEB07
F0A2EB8003EDF808003F151CEDF0181300A24815381630007EECE070166000FE903801F0
E0EDF1C0489038007F800038EC1E0026227DA02C>20 D<137CEB7F80EB1FE0130F6D7EA2
6D7EA36D7EA36D7EA28080A26E7EA36E7EA281140FA26E7EA381140F141FEC3DFC1479EC
F8FEEB01F0EB03E0903807C07FEB0F80EB1F00013EEB3F80137E4914C04848131F485A48
48EB0FE0EA1FC0123F4848EB07F048C7FC4815F848140348EC01FC48140026357CB32D>
I<017FB512F048B612F85A5A4815E0261F0070C7FC123C1238485B126012E0EA0001A349
5AA31307A25C130FA3131FA291C8FC5BA35BA2137E133C25217E9F22>28
D<123C127E12FFA4127E123C08087A8715>58 D<123C127EB4FCA21380A2127F123D1201
A412031300A25A1206120E120C121C5A5A126009177A8715>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Ff cmtt9 9 70
/Ff 70 126 df<00101320007C13F838FE01FCAAEAFC00007C13F8A900381370161778AE
27>34 D<120FEA1FC0123F13E0A213F0121F120F1201A4120313E01207EA0FC0A2EA3F80
EA7F005A5A12F812700C1773AD27>39 D<EB01C0EB03E0130F131FEB3FC0EB7F80EBFE00
485A5B1203485A5B485AA2485AA248C7FCA3127EA45AAC127EA47EA36C7EA26C7EA26C7E
7F6C7E12017F6C7EEB7F80EB3FC0EB1FE0130F1303EB01C0133A73B327>I<127012F812
FE7E6C7E6C7EEA0FE06C7E12037F6C7E1200137EA27FA2EB1F80A3EB0FC0A4EB07E0ACEB
0FC0A4EB1F80A3EB3F00A2137EA25B1201485A5B1207485AEA3FC0485A48C7FC5A12F812
70133A7AB327>I<EB03C0497EAD007FB512FEB7FCA46C14FE390007E000AD6D5A20227D
A727>43 D<120FEA3FC013E0EA7FF0A213F8A2123FA2120F120113F01203EA07E0121FEA
7FC0EAFF8013005A12700D14738927>I<007FB512F8B612FCA46C14F81E067C9927>I<12
1EEA7F80A2EAFFC0A4EA7F80A2EA1E000A0A728927>I<130E131FA25B5BA25B5A5A127F
B5FCA213BFEA7E3F1200B3AA003FB512805A15C01580A21A2F79AE27>49
D<EB3FE03801FFF84813FE000FEBFF804814C0393FE07FE0EB800F397F0007F0007EEB03
F800FE13015A6C14FC1400A3127CC8FCA2140115F8A2140315F01407EC0FE0EC1FC0143F
EC7F80ECFF00495A495A495A495A495A495A495A01FEC7FC485AD807F81378484813FC48
5A485A48B5FCB6FCA36C14F81E2F7CAE27>I<EB1FF8EBFFFE0003EBFF80000F14C015E0
391FF01FF0393FC007F8EB800115FC1400A26CC7FC1204C8FC140115F81403EC07F0140F
EC3FE090381FFFC0491380A215E06D13F09038001FF8EC03FC1401EC00FE157E157F153F
A21238127C12FEA2157F48147E6C14FE007FEB01FCEB8003393FF01FF86CB512F06C14E0
00031480C6EBFE00EB1FF820307DAE27>I<14FF010713C0011F13F04913F890B5FC48EB
81FC3803FE0113F8EA07F0EA0FE09038C000F8001F1400485A90C8FCA25A127EEB0FF838
FE3FFE48B51280B612C015E09038F80FF09038E007F890388001FC90C7FC15FE48147E15
7F153F5A7E127EA3127F6C147F157E6C6C13FE9038C001FC120F9038F007F83907F81FF0
6CB512E06C14C06C148090383FFE00EB0FF820307DAE27>54 D<1278B612FE15FFA315FE
39FC0001FCEC03F8EC07F0007814E0C7120FEC1FC01580143FEC7F00147E14FE5C13015C
13035C13075CA2495AA3495AA3133F91C7FCA55B137EA9133C20307DAE27>I<EB0FF0EB
7FFE48B512804814C0000F14F0EBF81F391FE007F8393F8001FC90C7FC4814FE007E147E
A56C14FCEB8001391FC003F8390FE007F03907FC3FE00001B5128039007FFE006D5A90B5
FC000314C0390FF00FF0391FC003F8393F8001FC90C7FC007E147EA248143FA6007E147E
A2007F14FE393F8001FC391FE007F8EBF81F6CB512F06C14E00001148039007FFE00EB0F
F020307DAE27>I<121EEA7F80A2EAFFC0A4EA7F80A2EA1E00C7FCAC121EEA7F80A2EAFF
C0A4EA7F80A2EA1E000A20729F27>58 D<120FEA3FC0A2EA7FE0A4EA3FC0A2EA0F00C7FC
AC120FEA3F8013C0127F13E0A3123FA2120F120713C0120FA2EA3F80EA7F005A5A12F812
700B2A739F27>I<153815FC14011407140FEC3FF8EC7FE0ECFFC001031300495AEB1FF8
495A495A3801FF804890C7FCEA0FFC485AEA7FF0EAFFC05BA27FEA7FF0EA1FF86C7EEA03
FF6C7F38007FE06D7E6D7EEB07FE6D7E010013C0EC7FE0EC3FF8EC0FFC14071401140015
381E287CAA27>I<007FB512FEB7FCA4003F14FEC9FCA6003FB512FEB7FCA46C14FE2012
7D9F27>I<127012FC7E6C7E7FEA7FF0EA1FF86C7EEA03FF6C7F38007FE06D7E6D7EEB07
FE6D7E010013C0EC7FE0EC3FF8EC0FFC1407A2140FEC3FF8EC7FE0ECFFC001031300495A
EB1FF8495A495A3801FF804890C7FCEA0FFC485AEA7FF0EAFFC05B48C8FC5A12701E287C
AA27>I<EB03F0497EA2497EA4143CEB1F3EA5EB3F3FA3EB3E1FA2017E7FA4496C7EA548
486C7EA390B5FCA24880A3EBF003A248486C7EA4000F803A7FFC0FFF8000FF15C06D5A49
7E007F1580222F7EAE27>65 D<007FB5FCB612C08115F87E3907E003FCEC00FE157E157F
81A6157EA25D1403EC0FF890B55A15C015F081819038E000FE157FED3F80151FA2ED0FC0
A6151F1680153FED7F004A5A007FB55AB65A5D15E06C1480222E7FAD27>I<903803F80E
90381FFE1F90383FFFBF90B6FC5A3803FE0F3807F803497E48487E485A49137FA248C712
3FA25A127E151E150012FE5AAA7E127EA2151E007F143F7EA26C7E157F6D137E6C6C13FE
3907F001FCEBF8033903FE0FF86CB512F06C14E0013F13C06D1300EB03F820307DAE27>
I<387FFFFC14FFB612C06C80813907E00FF81407EC01FC6E7EA2157E157F811680151FA3
16C0150FABED1F80A3153F1600A25D15FEA24A5A4A5A140F007FB55A5DB65A6C91C7FC14
FC222E7FAD27>I<007FB61280B712C0A37E3907E0000FA6ED078092C7FCA4EC07804A7E
A390B5FCA5EBE00FA36E5A91C8FCA4ED03C0ED07E0A7007FB6FCB7FCA36C15C0232E7FAD
27>I<007FB61280B712C0A37E3907E0000FA6ED078092C7FCA4EC07804A7EA390B5FCA5
EBE00FA36E5A91C8FCAC387FFF80B57EA36C5B222E7EAD27>I<007FB512E0B612F0A36C
14E039001F8000B3B2007FB512E0B612F0A36C14E01C2E7BAD27>73
D<90381FFFF84913FCA36D13F89038001F80B3AC127CA212FEA2EC3F005C387F81FE13FF
6C5B6C5B000713E0C690C7FC1E2F7BAD27>I<387FFFC080B5FC7E5CD803F0C8FCB3AAED
0780ED0FC0A7007FB6FCA2B7FC7E1680222E7FAD27>76 D<D87FE0EB7FE0486CEBFFF0A2
6D5A007F15E0000F150001B813DFEBBC03A3EBBE07019E139FA3EB9F0FA2018F131FA214
9FA2EB879EA4EB839C14FCA3EB81F8A2EB80F01400AAD87FF0EBFFE0486C4813F0A36C48
6C13E0242E7FAD27>I<3A7FF003FFE0486C4813F0A213FC007F6D13E000079038003E00
13DEA313CFA3148013C714C0A213C314E0A213C114F0A3EBC0F8A31478147CA2143C143E
A2141E141F140FA3EC07BEA3EC03FEEA7FFCEAFFFE1401A26C486C5A242E7FAD27>I<EB
FFFC0007EBFF80001F14E0A24814F0EBC00F397F8007F8EB0003007E1301A348EB00FCB3
A76C1301007E14F8A3007F1303EB8007393FE01FF090B5FC6C14E0A200071480C6EBFC00
1E307CAE27>I<007FB5FCB612E081816C803907E003FEEC00FF81ED3F80151F16C0150F
A6151F1680153FED7F005DEC03FE90B55A5D5D5D92C7FC01E0C8FCADEA7FFEB5FCA36C5A
222E7FAD27>I<387FFFF0B512FE6E7E816C803907E01FF014076E7E1401811400A51401
5D14034A5A141F90B55A5D5DA281EBE01F6E7E14076E7EA816F0EDF1F8A4397FFE01FBB5
EBFFF08016E06C48EB7FC0C8EA1F00252F7FAD27>82 D<90387FC0E03901FFF1F0000713
FF5A5AEA3FE0EB801F387F000F007E130712FE5A1403A3EC01E06C90C7FC127E127FEA3F
C013F86CB47E6C13F86C13FE6CEBFF80C614C0010F13E0010013F0140FEC07F814031401
15FC1400127812FCA46CEB01F8A26C130390388007F09038F01FE090B5FC15C0150000F8
5B38701FF81E307CAE27>I<007FB61280B712C0A439FC03F00FA60078EC0780000091C7
FCB3AB90B512C04880A36C5C222E7EAD27>I<3A7FFE01FFF8B54813FCA36C486C13F83A
07E0001F80B3AB6D133F00031500A26D5B0001147E6D13FE6C6C485A90387F87F814FF6D
5B010F13C06D5BD901FEC7FC262F80AD27>I<D87FE0EB7FE0486CEBFFF0A36C48EB7FE0
001FC7EA0F80A76C6CEB1F00A614F0EB81F83907C3FC3EA4149CEBC79EA30003143CA301
E7137CEBEF9FA2140FA200011478A49038FE07F8A300005CA2EBFC0390387801E0242F7F
AD27>87 D<387FFFF0B512F8A314F000FCC7FCB3B3ACB512F014F8A36C13F0153A71B327
>91 D<127812F87EA27E127E127F7E7F121F7F120F7F12077F1203A27F12017F12007F13
7E137F7F80131F80130FA280130780130380130180130080147E147F80A21580141F15C0
140F15E0140715F0140315F8140115FC1400A2157C15381E3A7CB327>I<387FFFF0B512
F8A37EEA0001B3B3ACEA7FFFB5FCA36C13F0153A7EB327>I<13E0EA01F01207120F13E0
EA1FC0EA3F00A2127E127C12FC5AA4B4FC138013C0127FA2123F1380EA0F000C1773B227
>96 D<3803FFC0000F13F04813FC4813FF811380EC1FC0381F000F000480C71207A2EB0F
FF137F0003B5FC120F5A383FFC07EA7FC0130012FE5AA46C130F007F131FEBC0FF6CB612
806C15C07E000313F1C69038807F8022207C9F27>I<EA7FE0487EA3127F1203A914FF01
F313C090B512F08181EC81FE49C67E49EB3F8049131F16C049130FA216E01507A6150F16
C07F151F6DEB3F80157F6DEBFF009038FF83FEECFFFC5D5D01F313C02601E0FEC7FC232E
7FAD27>I<EB0FFF017F13C048B512E04814F05A380FF807EA1FE0393FC003E090388000
8048C8FC127EA212FE5AA67E127EA2007F14F0393F8001F813C0381FE003390FF80FF06C
B5FC6C14E06C14C06C6C1300EB0FF81D207B9F27>I<EC3FF04A7EA3143F1401A9EB0FE1
EB7FFD48B5FC5A5A380FF83F381FE00F383FC007EB8003EA7F00007E1301A212FE5AA67E
007E1303A2127F6C1307EB800F381FE01F380FF03F6CB612C06C15E06C13FD38007FF9D9
1FE013C0232E7EAD27>I<EB0FF8EB3FFE90B51280000314C04814E0390FFC0FF0391FE0
03F8EBC001D83F8013FC48C7FC127E157E12FEB612FEA415FC00FCC8FC7E127E127F6C14
3C6D137E6C7E01F013FE390FFC07FC6CB5FC000114F86C14F0013F13C0903807FE001F20
7D9F27>I<EC1FF0ECFFF84913FC4913FE5BEB0FF014C0011F137CEC8000A6007FB512F0
B612F8A36C14F039001F8000B3A4003FB512C04814E0A36C14C01F2E7EAD27>I<153F90
391FC0FF80D97FF313C048B612E05A4814EF390FF07F873A1FC01FC3C0EDC000EB800F48
486C7EA66C6C485AEBC01FA2390FF07F8090B5C7FC5C485BEB7FF0EB1FC090C9FCA27F6C
B5FC15E015F84814FE4880EB8001007EC7EA3F80007C140F00FC15C0481407A46C140F00
7C1580007F143F6C6CEB7F009038F807FF6CB55A000714F86C5CC614C0D90FFCC7FC2333
7EA027>I<EA7FE0487EA3127F1203A9147F9038F1FFC001F713F090B5FC8114C1EC01FC
EBFE005B5BA25BB03A7FFF83FFE0B500C713F0A36C018313E0242E7FAD27>I<130F497E
497EA46D5A6DC7FC90C8FCA7383FFF80487FA37EEA000FB3A4007FB512F0B6FC15F815F0
7E1D2F7BAE27>I<143C147E14FFA4147E143C1400A73801FFFE4813FFA37EC7123FB3B0
147E1238007C13FE38FE01FC1303B512F814F06C13E06C13803807FE0018407CAE27>I<
EA7FE07F12FF127FA21201A991383FFFC04A13E0A36E13C0913803F8004A5A4A5A4A5A4A
5A02FFC7FCEBF1FEEBF3FCEBF7F8EBFFFC8080143F496C7E496C7E01F87FEBF0076E7E6E
7E816E7E157E3A7FFFC1FFF002C313F8B512E36C13C316F0252E80AD27>I<387FFF80B5
7EA37EEA000FB3B2007FB512F8B612FCA36C14F81E2E7CAD27>I<397F07C01F3AFF9FF0
7FC09039FFF9FFE091B57E7E3A0FFC7FF1F89038F03FC001E0138001C01300A3EB803EB0
3A7FF0FFC3FF486C01E3138001F913E701F813E36C4801C313002920819F27>I<387FE0
7F39FFF1FFC001F713F090B5FC6C80000313C1EC01FCEBFE005B5BA25BB03A7FFF83FFE0
B500C713F0A36C018313E024207F9F27>I<EB1FE0EB7FF83801FFFE487F481480390FF0
3FC0391FC00FE0393F8007F0EB00034814F8007E1301A248EB00FCA76C1301007E14F8A2
007F1303393F8007F0A2391FE01FE0390FF03FC06CB512806C14006C5B38007FF8EB1FE0
1E207C9F27>I<387FE0FFD8FFF313C090B512F0816C800003EB81FE49C67E49EB3F8049
131F16C049130FA216E01507A6150F16C07F151F6DEB3F80157F6DEBFF009038FF83FEEC
FFFC5D5D01F313C0D9F0FEC7FC91C8FCAC387FFF80B57EA36C5B23317F9F27>I<90380F
F03C90383FFE7E90B5FC000314FE5A380FFC1F381FE007EBC003383F800148C7FC127EA2
00FE147E5AA67E007E14FEA2007F1301EA3F80EBC003381FE007380FF81F6CB5FC7E6C14
7E38007FFCEB0FF090C7FCAC91381FFFF8A24A13FC6E13F8A226317E9F27>I<397FFC03
FC39FFFE0FFF023F13804A13C0007F90B5FC39007FFE1F14F89138F00F809138E002004A
C7FC5CA291C8FCA2137EAD007FB57EB67EA36C5C22207E9F27>I<9038FFF3800007EBFF
C0121F5A5AEB803F38FC000F5AA2EC07806C90C7FCEA7F8013FC383FFFF06C13FC000713
FF00011480D8000F13C09038003FE014070078EB03F000FC1301A27E14036CEB07E0EBE0
1F90B512C01580150000FB13FC38707FF01C207B9F27>I<133C137EA8007FB512F0B612
F8A36C14F0D8007EC7FCAE1518157EA415FE6D13FC1483ECFFF86D13F06D13E0010313C0
010013001F297EA827>I<397FE01FF8486C487EA3007F131F00031300B21401A21403EB
FC0F6CB612E016F07EEB3FFE90390FF87FE024207F9F27>I<3A7FFC0FFF80486C4813C0
A36C486C13803A07C000F800EBE00100035CA2EBF00300015CA2EBF80700005CA390387C
0F80A36D48C7FCA3EB3F3FEB1F3EA214FE6D5AA36D5AA26D5A22207E9F27>I<3A7FFE07
FFE000FF15F06D5A497E007F15E03A0F80001F00A36D5B0007143EA414F0EBC1F83903E3
FC7CA4EBE79EA200011478A301F713F8A2EBFF0F6C5CA3EBFE0790387C03E024207F9F27
>I<393FFC1FFF486C5A168016006C487E3901F807E06C6C485A4A5A017E90C7FC6D5AEB
1F7E5C6D5A13076D5A5C80497E130F497E143EEB3E3FEB7E1F90387C0F8001F87F00016D
7E3803F0033A7FFE1FFF80A2B54813C06C486C1380A222207E9F27>I<3A7FFC0FFF8048
6C4813C0A36C486C13803A07E000F800000313015D13F00001130301F85B1200A26D485A
137CA290387E0F80133EA2011F90C7FC5CA2130F149E14BE130714FC1303A25C1301A25C
A213035CA213075C1208EA3E0F007F5B131FD87E7FC8FCEA7FFE6C5A5B6C5AEA07C02231
7E9F27>I<001FB512FE4814FFA490380001FEEC03FCEC07F8EC0FF0001EEB1FE0C7EA3F
C0EC7F80ECFF00495A495A495AEB1FE0495A495A49C7FC485A4848131E4848133F485A48
5A485A485AB7FCA46C14FE20207E9F27>I<EC07F8EC3FFC14FF130315F8903807FE00EB
0FF05C5CB0131FEB7F80EA3FFFB5C7FC5BA27F003F7FEA007FEB1FC0130FB08080EB07FE
903803FFF815FC1300143FEC07F81E3A7CB327>I<127812FCB3B3B3A21278063A70B327>
I<EA7F80EAFFF013FC13FF7E00017F38003FC0131F130FB080EB07F8ECFFF06D13FC7FA2
5B4913F0ECF800EB0FE05CB0131F133F48B45A007F90C7FCB5FC13FC13F0EA7F801E3A7C
B327>I E
%EndDVIPSBitmapFont
/Fg 138[33 18 1[22 2[33 33 1[18 6[29 33 29 33 29 15[48
3[59 9[44 18[33 3[17 4[22 39[{TeXBase1Encoding ReEncodeFont}17
66.4176 /Times-Roman rf /Fh 175[41 6[22 2[41 2[44 67[{
TeXBase1Encoding ReEncodeFont}4 66.4176 /Times-Italic
rf
%DVIPSBitmapFont: Fi cmti9 9 48
/Fi 48 122 df<923803FF80031F13F092383F00F803F8133C4A48133E4A48137E17FE4A
5A17FC17384A481300A3141F92C8FCA55C143E011FB612E0A217C09039007E0007147C16
0F1780A214FC4A131F1700A301015C4A133EA3167E0103147C5C1718EEFC1CEEF83C0107
15385C1778177016F0010F15F04AEBF8E01679EE3FC0011FEC0F0093C7FC91C9FCA3133E
A21238EA7E3C137CEAFE7812FC485AEA79E0EA3FC0000FCAFC2F4582B42B>12
D<130E131F133F137E13FCEA01F8EA03F0EA07E0EA0F80EA1F00123E5A5A5A100E67B327
>19 D<EA0380EA0FE0121FA5EA0760120013E013C0A2120113801203EA07001206120E5A
5A5A5A5A0B176FB318>39 D<1560EC01E0EC03C0EC0700140E5C143C5C5C495A495A1307
5C49C7FC5B131E5B137C137813F85B12015B12035B1207A25B120FA290C8FC5AA2121E12
3EA3123C127CA31278A212F8A35AAF12701278A21238A2123C121CA27EA27E6C7E12011B
4A75B71F>I<14301438A28080A2140F801580A2140315C0A4140115E0A81403A415C0A3
1407A31580140FA315005CA3141E143EA2143C147CA25CA25C13015C13035C13075C130F
91C7FC131E133E133C5B5B485AA2485A485A48C8FC121E5A12705A5A1B4A7EB71F>I<EA
0380EA0FE0121FA5EA0760120013E013C0A2120113801203EA07001206120E5A5A5A5A5A
0B177A8718>44 D<B51280A46C1300110579911B>I<EC01801403A21407140FEC1F005C
14FF5BEB1FFEEB7FBEEB7E7E1320EB007CA214FCA25CA21301A25CA21303A25CA21307A2
5CA2130FA25CA2131FA291C7FCA25BA2133EA2137EA2137C13FCB512FCA3193277B127>
49 D<EC07E0EC3FFC4A7E903801F81F903903E00F809038078007D90F0013C049130313
1E5BA21507017C1480A2150F1600017E131E017F133E6E5A6D6C5AECE1E090381FFBC06D
B4C7FC6D5A6D7E497F011E7F90387C7FE09038F01FF048486C7E3807C007EB8003380F00
01001E1300123E003C1478127C1278A215F800F85C5A6C495A007813035D007C495A003C
011FC7FC003E133E381F81FC380FFFF0000313C0C648C8FC223479B127>56
D<EC0FC0EC7FF0ECFFFC903803F07E903807C03E49487EEB1F00013E7F017E14805BA248
5AA2485A151FA212075BA2ED3F00A2485A5DA2000714FEA21401140300035CEBE0070001
131E3900F039F8EB7FF1EB0FC190380003F0A24A5AA25D4A5A141F003891C7FC007E133E
00FE137E5C48485A48485A48485A38781F80D87FFFC8FCEA1FFCEA07E0213478B127>I<
161C163CA2167C16FCA21501821503A2ED077E150F150E151CA21538A2157015F015E0EC
01C0A2913803807F82EC0700A2140E141E141C5CA25CA25C49B6FCA25B913880003F49C7
EA1F80A2130E131E131C133C13385B13F05B12011203D80FF0EC3FC0D8FFFE903807FFFE
A32F367BB539>65 D<DB1FF013C09238FFFC010203EBFF03913A0FF00F878091393F8003
CF9139FE0001EF4948EB00FFD903F01500D90FE080495A49488091C8123E137E13FE485A
4848153CA2485AA248481538A2485A94C7FC123F5BA3127F90CBFCA412FEA2EE03C0A25F
127E160794C7FC5E160E007F151E6C5D5E6C6C147016F06C6C495A6C6CEB07C06C6C49C8
FC6C6C133E6CB413FC90387FFFF0011F13C0D903FEC9FC323775B437>67
D<0107B612C04915F017FC903A003F8001FEEE007FEF1F8092C7EA0FC0EF07E05CEF03F0
147E170102FE15F8A25CA21301A25CA2130317035CA2130718F04A1407A2130F18E04A14
0F18C0011F151F18805CEF3F00133F177E91C85AA2494A5A4C5A017E4A5A4C5A01FE4A5A
047EC7FC49495A0001EC0FF8007FB612E0B7C8FC15F835337BB23A>I<0107B712F05B18
E0903A003F80001F1707170392C7FC17015C18C0147EA214FEA24A130EA20101EC1E0304
1C13804A91C7FC163C13035E9138F001F891B5FC5B5EECE0011500130F5E5C1707011F01
015BEEC00E0280141E92C7121C133F173C91C812381778495DA2017E14014C5A01FE1407
4C5A49141F00014AB45A007FB7FCB8FC94C7FC34337CB234>I<0107B712E05B18C0903A
003F80003F170F170792C7FC17035C1880147EA214FEA25C161C0101EC3C07043813004A
91C7FCA20103147816704A13F0150349B5FCA25EECE003130F6F5A14C0A2011F13035E14
80A2013F90C9FCA291CAFCA25BA2137EA213FEA25B1201387FFFFCB5FCA233337CB232>
I<010FB51280A216009038003FC05DA292C7FCA25CA2147EA214FEA25CA21301A25CA213
03A25CA21307A25CA2130FA25CA2131FA25CA2133FA291C8FCA25BA2137EA213FEA25B12
01B512F8A25C21337BB21E>73 D<91381FFFFE5C16FC9138003F80A31600A25D157EA315
FE5DA314015DA314035DA314075DA3140F5DA3141F5DA3143F92C7FCA2121C007E5B00FE
137EA214FE485BEAF80100E05B495A387007E038780FC06C48C8FCEA1FFCEA07F0273579
B228>I<0107B512C05BA29026003FC0C7FC5DA292C8FCA25CA2147EA214FEA25CA21301
A25CA21303A25CA21307A25CA2130FA25C17E0011F140117C05C1603013F1580160791C7
FCEE0F005B5E017E143EA201FE5CED01FC4913030001EC1FF8007FB6FCB7FC5E2B337CB2
30>76 D<902607FFC0ED7FFC4917FF81D9003F4B1300611803023BED077CA2027BED0EFC
610273151C1838DAF1F01439F071F014E118E10101ED01C36102C1EC0383EF0703010316
07050E5BEC80F8171C0107ED380F6102001470A249EDE01FDC01C090C7FC130EEE038001
1E017C5C933807003E011C140EA2013C4A137E187C01385C5E017816FC6F485B1370ED3F
C001F0EC80016000011500D807F81503277FFF803E90B512C0B5EB3C01151C46337BB245
>I<902607FF8090383FFFC0496D5BA2D9001F913803F8004A6C6D5A6060EC3BF0027B14
0360EC71F8A202F11407DAF0FC91C7FC14E0A20101017E5B170E14C0810103151EEE801C
EC801FA20107ECC03C030F1338140016E049010713781770010E14F01503011E15F0705A
011C1301A2013C14FD03005B133816FF0178147F5F0170143FA213F070C8FC1201EA07F8
267FFF807FB5140EA23A337BB239>I<0107B612C04915F883903A003F8001FEEE003FEF
1F8092C713C0170F5C18E0147EA214FEEF1FC05CA201011680173F4A1500177E010315FE
5F4AEB03F8EE07E00107EC3FC091B6C7FC16F802E0C9FC130FA25CA2131FA25CA2133FA2
91CAFCA25BA2137EA213FEA25B1201387FFFF0B5FCA233337CB234>80
D<0107B512FE49ECFFC017F0903A003F8007F8EE01FCEE007E92C7127F835C1880147EA2
14FEEF7F005CA2010115FE5F4A13015F01034A5AEE0FC04A495A04FEC7FC49B512F016C0
9138E003E0ED01F8010F6D7E167C4A137EA2131FA25CA2013F14FEA291C7FCA24913015E
137EEF01C001FE150318805B00011607277FFFF0001400B5ECFE0EEE7E1CC9EA1FF8EE07
E032357BB238>82 D<913901FC018091380FFF03023F13C791387E07EF903A01F801FF00
49487E4A7F495A4948133E131F91C7FC5B013E143CA3137E1638A293C7FC137FA26D7E14
E014FE90381FFFC06D13F86D7F01017F6D6C7E020F7F1400153F6F7E150FA4120EA2001E
5D121CA2151F003C92C7FCA2003E143E5D127E007F5C6D485A9038C007E039F3F80FC000
F0B5C8FC38E03FFC38C00FF029377AB42B>I<0003B812C05A1880903AF800FC003F260F
C001141F0180150F01005B001EEE07001403121C003C4A5BA200380107140E127800705C
A2020F141E00F0161CC74990C7FCA2141FA25DA2143FA292C9FCA25CA2147EA214FEA25C
A21301A25CA21303A25CA21307A25C497E001FB512F05AA2323374B237>I<EB03F0EB0F
F890383E1C6090387C0FF0EBF807EA01F0EA03E00007EB03E0EA0FC0A2381F800715C0EA
3F00A2140F481480127EA2141F00FE14005A1506EC3F07EC3E0F150E147E007C141EECFE
1CEB01FCD83C03133C393E07BE38391F0E1E783907FC0FF03901F003C0202278A027>97
D<137EEA0FFE121F5B1200A35BA21201A25BA21203A25BA21207A2EBC3E0EBCFF8380FDC
3EEBF81F497E01E01380EA1FC0138015C013005AA2123EA2007E131F1580127CA2143F00
FC14005AA2147EA25CA2387801F85C495A6C485A495A6C48C7FCEA0FFCEA03F01A3578B3
23>I<14FCEB07FF90381F078090383E03C0EBFC013801F8033803F0073807E00F13C012
0F391F80070091C7FC48C8FCA35A127EA312FE5AA4007C14C0EC01E0A2EC03C06CEB0F80
EC1F006C137C380F81F03803FFC0C648C7FC1B2278A023>I<ED0FC0EC03FFA21680EC00
1FA31600A25DA2153EA2157EA2157CA215FCA2903803F0F8EB0FF8EB3E1DEB7C0F496C5A
EA01F0EA03E000071303D80FC05BA2381F8007A2D83F005BA2140F5A007E5CA2141F12FE
4891C7FC1506EC3F075DEC3E0E147E007C141EECFE1CEB01FCD83C03133C393E07BE3839
1F0E1E783907FC0FF03901F003C0223578B327>I<EB03F8EB0FFEEB3E0F9038F8078038
01F003EA03E0EA07C0120FEA1F801407D83F0013005C007E133EEB03F8387FFFE04848C7
FC00FCC8FCA45AA4EC0180EC03C0A2007CEB0780EC1F00003C133E6C13F8380F03E03807
FF80D801FCC7FC1A2277A023>I<151FED7FC0EDF0E0020113F0EC03E3A2EC07C316E0ED
C1C091380FC0005DA4141F92C7FCA45C143E90381FFFFEA3D9007EC7FC147CA414FC5CA5
13015CA413035CA413075CA3130FA25CA3131F91C8FCA35B133E1238EA7E3CA2EAFE7812
FC485AEA78E0EA3FC0000FC9FC244582B418>I<143FECFF80903803E1E6903807C0FF90
380F807FEB1F00133E017E133F49133EA24848137EA24848137CA215FC12074913F8A214
01A2D80FC013F0A21403120715E01407140F141F3903E03FC00001137FEBF0FF38007FCF
90381F0F801300141FA21500A25C143E1238007E137E5C00FE5B48485A387803E0387C0F
80D81FFFC7FCEA07F820317CA023>I<EB0FC0EA03FFA25CEA001FA391C8FCA25BA2133E
A2137EA2137CA213FCA29038F83F80ECFFE03901FBE0F09038FF80F8EC007849137C485A
5B5BA2484813FC5D5BA2000F13015D1380A2001F13035DEB0007EDC0C048ECC1E0020F13
C0003E1481A2007E1483ED0380007C1407160000FC140E151E48EB07F80070EB01F02335
7BB327>I<EB0180EB07E0A2130FEB07C0EB038090C7FCABEA01F0EA03FCEA0F1E120E12
1C123C1238EA783E1270A2137EEAF07CEA60FCC65AA212015BA212035BA2000713C0EBC1
E0000F13C01381A21383EB038013071400130E131EEA07F8EA01F013337AB118>I<EB0F
C0EA01FF5A5CEA001FA391C7FCA25BA2133EA2137EA2137CA213FCA2491378EC01FE0001
EB078FEC0E0F9038F01C3F143800031370ECE03E9038E1C01C9038E38000D807E7C7FC13
EE5B13F8120F13FFEB9FC0EB83F0EA1F81EB80F81300150C48141E151C123EA2007E143C
1538127C157800FCEB787015E048EB3FC00070EB0F8020357BB323>107
D<133FEA07FF5A13FEEA007EA3137CA213FCA213F8A21201A213F0A21203A213E0A21207
A213C0A2120FA21380A2121FA21300A25AA2123EA2127EA2127C1318EAFC1C133CEAF838
A21378137012F013F0EAF8E01279EA3FC0EA0F00103579B314>I<2703C003F8137F3C0F
F00FFE01FFC03C1E783C1F07C1E03C1C7CF00F8F01F03B3C3DE0079E0026383FC001FC7F
D97F805B007001005B5E137ED8F0FC90380FC00100E05FD860F8148012000001021F1303
60491400A200034A13076049013E130FF081800007027EEC83C0051F138049017C1403A2
000F02FC1407053E130049495CEF1E0E001F01015D183C010049EB0FF0000E6D48EB03E0
3A227AA03F>I<3903C007F0390FF01FFC391E787C1E391C7CF01F393C3DE00F26383FC0
1380EB7F8000781300EA707EA2D8F0FC131F00E01500EA60F8120000015C153E5BA20003
147E157C4913FCEDF8180007153C0201133801C013F0A2000F1578EDE070018014F016E0
001FECE1C015E390C7EAFF00000E143E26227AA02B>I<14FCEB07FF90381F07C090383E
03E09038FC01F0EA01F83903F000F8485A5B120F484813FCA248C7FCA214014814F8127E
A2140300FE14F05AA2EC07E0A2007CEB0FC01580141FEC3F006C137E5C381F01F0380F83
E03803FF80D800FCC7FC1E2278A027>I<011E137C90387F81FF9039F3C387C09039E3EF
03E03901E1FE01D9C1FC13F0EBC3F8000313F0018314F814E0EA07871307000313C01200
010F130316F01480A2011F130716E01400A249EB0FC0A2013EEB1F80A2017EEB3F00017F
133E5D5D9038FF81F09038FDC3E09038F8FF80027EC7FC000190C8FCA25BA21203A25BA2
1207A25BB5FCA325307FA027>I<903803F01890380FF83890383E1C7890387C0EF89038
F807F0EA01F0EA03E000071303D80FC013E0A2EA1F801407D83F0013C0A348130F007E14
80A300FE131F481400A35C143E147E127C14FE495AEA3C03EA3E07EA1F0E3807FCF8EA01
F0C7FC13015CA313035CA21307A25C48B5FCA25C1D3078A023>I<3903C00FC0390FF03F
F0391E78F078391C7DE03C393C3FC0FC00381380EB7F00007814F8D8707E13701500EAF0
FC12E0EA60F812001201A25BA21203A25BA21207A25BA2120FA25BA2121FA290C8FC120E
1E227AA020>I<EB03F0EB1FFCEB3C1EEB780FEBF007EA01E0140F0003131F13C0A2EBE0
0414007FEBFF8014E06C13F06C13F8EB7FFC1307EB00FE147E143E123800FC133CA3147C
00F013784813F0EAF001387803E0383C0F80381FFE00EA03F818227AA01F>I<1303EB0F
80A3131FA21400A25BA2133EA2137EA2137C387FFFF8A2B5FC3800F800A21201A25BA212
03A25BA21207A25BA2120FA25B1460001F13F014E01300130114C01303001E1380EB0700
5BEA0F1EEA07F8EA01E015307AAE19>I<EA01F0D803FC1307D80F1E5B000E5C121C123C
00385CD8783E133E1270A2017E137ED8F07C137CEA60FCC65A15FC00015C5BA214010003
5C13E0166002031370EDE0F0D807C014E0A20003EB07E116C09038E00FC1EC1FC3000190
383FE3809038F071E73A007FE0FF0090381F803C24227AA029>I<01F01338D803FC13FC
EA0F1E120E121C123C0038147CEA783E0070143CA2137ED8F07C1338EA60FCC65A157800
0114705BA215F0000314E05BA2EC01C0A2EBC003158014071500EBE00EA26C6C5A3800F8
78EB7FE0EB1F801E227AA023>I<D801F01538D803FC010E13FCD80F1E131E000E143E12
1C123C0038027E137CD8783E137C0070163CA2017E13FCD8F07C491338EA60FCC65A0201
147800014A137013F0A2020314F0000316E001E05BA2160117C001C013C00207EB0380A2
9039E00FE0071700021F130E3A01F03DF01E3A00F878F83C90393FF03FF090390FC00FC0
2E227AA033>I<011F137C90387FC1FF3A01E1E787803A03C0F703C0903880FE0FEA0700
4813FC000E1580001E9038F80700001C91C7FC1301003C5B1218120013035CA31307A25C
1506010F130F150E14800038141ED87C1F131C00FC143C1538013F5B39F07FC0E03970F3
C3C0393FE1FF80260F807EC7FC22227CA023>I<13F0D803FC1307D80F1E130F000E141F
121C123C0038143FD8783E133E1270A2017E137ED8F07C137CEA60FCC65A15FC000114F8
5BA21401000314F013E0A2140315E0EA07C0A20003130715C0EBE00F141F0001133F9038
F07F8038007FEFEB1F8FEB001F1500A25C003E133E007E137E147C5C007C5BEA7001495A
38380780D83C1FC7FCEA0FFCEA07F020317AA025>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fj cmbx9 9 23
/Fj 23 118 df<147814F81303131FEA03FFB5FCA3EAFC1F1200B3B2007FB512FEA41F31
7AB02C>49 D<EB1FFC90B57E000314E0000F14F8391FE03FFC393F800FFF48487E6D6C13
80D8FFC014C06D7E16E080A36C5A6C5A6CC7FCC8FC16C05C16805C16004A5A4A5A5D4A5A
EC3FC04A5A02FEC7FC495A495A903907E001E0EB0FC0EB1F8090383E00034914C05B4848
130748B6FC5A5A5A5A5AB71280A423317CB02C>I<120FEA3FC0EA7FE0EAFFF0A6EA7FE0
EA3FC0EA0F00C7FCA9120FEA3FC0EA7FE0EAFFF0A6EA7FE0EA3FC0EA0F000C217AA019>
58 D<B812FCA4C69038E0001FEE03FE16011600177E173EA2171EA3923803C01F170FA4
03071300A2150F153F91B5FCA4ECE03F150F1507A21503A592C8FCABB612F8A430337DB2
38>70 D<B612F8A4C601E0C8FCB3A81778A417F817F0A31601A21603A21607160F161F16
7F923803FFE0B8FCA42D337DB235>76 D<B500E093387FFFF86E93B5FCA26E5DC6F1F800
D9F7FCED03DFA3D9F3FEED079FA2D9F1FFED0F1FA201F06D141EA26E6C143CA26E6C1478
A26E6C14F0A36E6CEB01E0A26E6CEB03C0A26E6CEB0780A26E6CEB0F00A26EEB801EA26F
6C5AA36F6C5AA26F6C5AA292380FF9E0A26FB45AA26F5BA26F90C7FCA3B526F000FE011F
B512F8A2167C16384D337DB254>I<B712F8EEFF8017E017F8C69039E0007FFCEE0FFE70
7E701380A27013C0A218E0A718C0A24C1380A24C13004C5AEE7FFC91B612F017C04CC7FC
02E0C9FCB3B612E0A433337DB23C>80 D<D90FFC137090397FFF80F048B512E1000714FB
390FF803FF391FE0007F4848133F49130F007F140790C7FC1503481401A36D1300A27F6D
140013F8387FFFC014FCECFFE06C14F86C14FE816C1580000315C06C15E06C6C14F0131F
010014F8140F9138007FFC153F151F150F00F01407A21503A27EA216F86C14076C15F07E
6DEB0FE001E0131F01FEEB7FC000FDB61200D8F87F5BD8F01F13F8D8E00113C026357BB3
31>83 D<EB7FFE0003B512E04814F8390FF00FFC391FF803FF806E138016C0157F6C5A6C
5AEA0180C8FCEC7FFF010FB5FC90B6FC0003EBF07F000F1300EA1FF8485A485A485A5BA3
15FF7F007F5B6D4813E03A3FF80FBFFF000FB5121F0003EBFC0F39007FE00728217EA02B
>97 D<903807FF80013F13F090B512FC3903FE01FE4848487EEA0FF8EA1FF0EA3FE0A200
7F6D5A496C5A153000FF91C7FCA9127F7FA2003FEC07807F6C6C130F000FEC1F00D807FE
133E3903FF80FCC6EBFFF8013F13E0010790C7FC21217DA027>99
D<ED01FC15FFA4150F1507ADEB07FE90383FFFC790B512F70003EB01FF3907FC003F4848
131F4848130F48481307A2127F5BA212FFA9127FA27F123F150F6C6C131F6C6C133F6C6C
497E2603FE03B512E0C6B512E7013F1387903807FC072B347DB331>I<903803FF80013F
13F090B512FC48EB03FE3907FC007F4848EB3F804848EB1FC05B003FEC0FE0127F5B16F0
12FF150790B6FCA301C0C8FCA4127F7F123F16F06C7E000F14016C6CEB03E0D803FEEB0F
C03A01FF807F806C6CB51200011F13FC010313E024217EA029>I<EC3FE0903803FFF801
0F13FC90383FF1FE90387FC3FFEBFF83481303A2EA03FEEC01FEA2EC00781500A7B512FE
A4D803FEC7FCB3A7387FFFF8A420347EB31B>I<16F890390FFC07FE90387FFF9F48B612
7F3907FC0FFC380FF003001F14FED9E001133E003FECFF1C1600A6001F5CEBF003000F5C
3907FC0FF890B512E0486C1380D90FFCC7FC48C9FCA37F7F90B512F015FE6CECFF8016E0
6C15F06C15F84815FC121F393F80001F48C7EA03FE481401481400A46C14016C6CEB03FC
6C6CEB07F86C6CEB0FF0D80FFCEB7FE00003B61280C6ECFE00010F13E028327EA12C>I<
EA03F0487E487E487EA66C5A6C5A6C5AC8FCA8EA01FC12FFA4120F1207B3A5B512C0A412
357DB418>105 D<EA01FC12FFA4120F1207B3B3A6B512E0A413347DB318>108
D<2703F803FEEB03FE00FF903B1FFFC01FFFC0027FD9E07F7F913BF81FF0F81FF0903CF9
E00FF9E00FF8260FFBC0EBFBC06CB4486CB4486C7E02001400495CA3495CB2B500E0B500
E0B512E0A443217CA04A>I<3901F803FF00FF010F13C0023F13F09138FC0FF89039F9E0
07FC380FFBC06CB4486C7E1400A25BA25BB2B539E07FFFF0A42C217DA031>I<903803FF
80011F13F090B512FE48EB01FF3A07FC007FC0D80FF0EB1FE0001F15F049130F003F15F8
491307007F15FCA300FF15FEA8007F15FCA26D130F003F15F8001F15F06D131F6C6CEB3F
E06C6CEB7FC03A01FF01FF006CEBFFFE013F13F80103138027217EA02C>I<3901F81F80
00FFEB7FF0ECFFF89038F9E3FC9038FBC7FE380FFF876C1307A213FEEC03FCEC01F8EC00
60491300B1B512F0A41F217EA024>114 D<9038FFE1C0000713FF5A383F803F387E000F
14075A14037EA26C6CC7FC13FCEBFFE06C13FC806CEBFF80000F14C06C14E0C6FC010F13
F0EB007F140F00F0130714037EA26C14E06C13076CEB0FC09038C01F8090B5120000F913
FC38E03FE01C217DA023>I<133CA5137CA313FCA21201A212031207001FB51280B6FCA3
D807FCC7FCB0EC03C0A79038FE078012033901FF0F006C13FEEB3FFCEB0FF01A2F7EAE22
>I<D801FC14FE00FF147FA4000F140700071403B21507A2150F151F6C6C497E6C6C01FB
13F06CEBFFF3013F13C3903807FE032C217DA031>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fk cmr9 9 86
/Fk 86 128 df<4A7E4A7EA34A7EA34A7EA44A7E141BA2EC33FC1431A2EC61FE1460A24A
7E81A2D901807F153FA2D903007F151FA2010680150FA249801507A249801503A2498015
01A249801500A2498082A200011680163F487ED80FF0ECFFC0D8FFFE010F13FFA330367E
B535>3 D<91393FE00FE0903A01FFF83FF8903A07E01EF83C903A1F800FF07E903A3F00
1FE0FE017E133F4914C0485A1738484890381F8000ACB812C0A33B03F0001F8000B3A748
6C497EB50083B5FCA32F357FB42D>11 D<EC1FE0ECFFFC903803F01E90390FC00780EB1F
8090393F000FC0017E131F5BA2485AED0F8092C7FCA9ED0FC0B7FCA33901F8001F150FB3
A6486CEB1FE0267FFFC1B5FCA328357FB42B>I<EC1FF891B512C0903803F00F90380FC0
1FEB1F80EB3F00137E5B150F485AACB7FCA33901F8000FB3A7486CEB1FE0267FFFE3B5FC
A328357FB42B>I<DA1FE013FF9126FFFC0713E0903B03F01E1F80F0903B0FC0077E003C
D91F805B90273F001FF8137E017E4A13FE495CA248485C030F147C95C7FCA9187EB912FE
A33B01F8000FC000187EB3A6486C496C13FF297FFFC1FFFE0F13F8A33D357FB440>I<13
7813FCA212011203EA07F813E0EA0FC0EA1F801300123C5A5A12400E0E71B326>19
D<123C127E12FFA8127EAB123E123CAB1218A61200A7123C127E12FFA4127E123C08367A
B515>33 D<003C13F0387E01F838FF03FCA2EB83FEA2EA7F81383D80F600011306A40003
130EEB000CA248131C00061318000E1338000C1330001C13704813E0387001C000601380
17177EB326>I<123C127EB4FCA21380A2127F123D1201A412031300A25A1206120E120C
121C5A5A126009177AB315>39 D<14C01301EB0380EB0F00130E5B133C5B5BA2485A485A
A212075B120F90C7FC5AA2121E123EA3123C127CA55AB0127CA5123C123EA3121E121FA2
7E7F12077F1203A26C7E6C7EA213787F131C7F130FEB0380EB01C01300124A79B71E>I<
12C07E1270123C121C7E120F6C7E6C7EA26C7E6C7EA27F1378137C133C133EA2131E131F
A37F1480A5EB07C0B0EB0F80A514005BA3131E133EA2133C137C137813F85BA2485A485A
A2485A48C7FC120E5A123C12705A5A124A7CB71E>I<123C127EB4FCA21380A2127F123D
1201A412031300A25A1206120E120C121C5A5A126009177A8715>44
D<B512F0A514057F921A>I<123C127E12FFA4127E123C08087A8715>I<1530157815F8A2
15F01401A215E01403A215C01407A21580140FA215005CA2143EA2143C147CA2147814F8
A25C1301A25C1303A25C1307A2495AA291C7FC5BA2131E133EA2133C137CA2137813F8A2
5B1201A25B1203A2485AA25B120FA290C8FC5AA2121E123EA2123C127CA2127812F8A25A
12601D4B7CB726>I<EB0FE0EB7FFCEBF83E3903E00F803907C007C0EB8003000F14E039
1F0001F0A24814F8A2003E1300007E14FCA500FE14FEB2007E14FCA56CEB01F8A36C14F0
A2390F8003E03907C007C0A23903E00F803900F83E00EB7FFCEB0FE01F347DB126>I<13
075B5B137FEA07FFB5FC13BFEAF83F1200B3B3A2497E007FB51280A319327AB126>I<EB
3FC0EBFFF0000313FC380F80FF391E007F80001CEB3FC048EB1FE048130F15F000601307
12FC6C14F87E1403A3007E1307123CC7FC15F0A2140F15E0EC1FC0A2EC3F801500147E5C
495A5C495A495A495A49C7FC133E133C4913185B485A48481330485A48C7FC001C147000
1FB512F05A5AB612E0A31D327CB126>I<EB1FE0EBFFFC4813FF3907E03F80390F001FC0
001EEB0FE0001CEB07F0123F018013F8140313C01380A2381F0007C7FC15F0A2EC0FE015
C0141FEC3F80EC7E00EB01F8EB7FE014FCEB003FEC1FC0EC0FE0EC07F015F8140315FC14
0115FEA3127EB4FCA415FC48130312780070EB07F86C14F0003C130F001FEB1FE0390FE0
3F800003B51200C613FCEB1FE01F347DB126>I<EC01C0A214031407A2140F141FA2143F
147F146F14CF1301EB038F140F1307130E130C131C13381330137013E013C0EA01801203
13001206120E120C5A123812305A12E0B71280A3C7380FC000A94A7E0107B51280A32133
7EB226>I<000C14C0380FC00F90B5128015005C5C14F014C0D80C18C7FC90C8FCA9EB0F
C0EB7FF8EBF07C380FC03F9038001F80EC0FC0120E000CEB07E0A2C713F01403A215F8A4
1218127E12FEA315F0140712F8006014E01270EC0FC06C131F003C14806CEB7F00380F80
FE3807FFF8000113E038003F801D347CB126>I<14FE903807FF80011F13E090383F00F0
017C13703901F801F8EBF003EA03E01207EA0FC0EC01F04848C7FCA248C8FCA35A127EEB
07F0EB1FFC38FE381F9038700F809038E007C039FFC003E0018013F0EC01F8130015FC14
00A24814FEA5127EA4127F6C14FCA26C1301018013F8000F14F0EBC0030007EB07E03903
E00FC03901F81F806CB51200EB3FFCEB0FE01F347DB126>I<1230123C003FB6FCA34814
FEA215FC0070C7123800601430157015E04814C01401EC0380C7EA07001406140E5C1418
14385CA25CA2495A1303A3495AA2130FA3131F91C7FCA25BA55BA9131C20347CB126>I<
EB0FE0EB7FFC90B5FC3903F01F803907C007C0390F0003E0000EEB01F0001E1300001C14
F8003C1478A3123EA2003F14F86D13F0EBC001D81FF013E09038F803C0390FFE07803907
FF0F006C13DE6C13F87EEB3FFE8001F713C0D803E313E0D8078013F0390F007FF8001E13
1F003EEB07FC003C1303481301EC007E12F848143EA2151EA37E153C1278007C14787E6C
14F0390F8003E03907F01FC00001B5120038007FFCEB1FE01F347DB126>I<EB0FE0EB7F
F8EBFFFE3803F83F3907E00F80390FC007C0D81F8013E0EC03F0EA3F0048EB01F8127EA2
00FE14FC1400A415FEA5007E1301A2127F7E1403EA1F80000F13073807C00E3803E01C38
01F03838007FF090381FC0FC90C7FC1401A215F8A215F01403001F14E0383F800715C014
0FEC1F809038003F00001C137E381F01FC380FFFF0000313C0C690C7FC1F347DB126>I<
123C127E12FFA4127E123C1200B0123C127E12FFA4127E123C08207A9F15>I<123C127E
12FFA4127E123C1200B0123C127E12FE12FFA3127F123F1203A412071206A3120E120C12
1C1238123012701260082F7A9F15>I<EBFFC0000313F8380F00FE001C133F48EB1F8048
14C0140F00FC14E07EA4127CC7EA1FC0A2EC3F80EC7F0014FE14F8495A495A5C495AA249
C7FC130EA2130C131CA21318A890C8FCA7133C137E13FFA4137E133C1B357CB424>63
D<15E0A34A7EA24A7EA34A7EA3EC0DFE140CA2EC187FA34A6C7EA202707FEC601FA202E0
7FECC00FA2D901807F1507A249486C7EA301066D7EA2010E80010FB5FCA249800118C77E
A24981163FA2496E7EA3496E7EA20001821607487ED81FF04A7ED8FFFE49B512E0A33336
7DB53A>65 D<B7FC16E016F83A03FC0003FE0001EC00FFEE7F80EE3FC0161F17E0160F17
F0A617E0161F17C0EE3F80EE7F0016FEED03FC90B612F05E9039FC0007FCED00FEEE3F80
EE1FC0EE0FE017F0160717F8160317FCA617F81607A2EE0FF0EE1FE0163FEE7FC0000391
3803FF00B75A16F816C02E337DB236>I<DA03FE130C91393FFF801C91B512E0903A03FE
01F83C903A0FF0003C7CD91FC0EB0EFCD97F80130701FEC7120348481401000315005B48
48157C485A173C485A171C123F5B007F160CA390C9FC481600AB7E6D150CA3123F7F001F
161C17186C7E17386C6C15306C6C15706D15E012016C6CEC01C0D97F80EB0380D91FC0EB
0F00D90FF0131ED903FE13FC0100B512F0023F13C0DA03FEC7FC2E377CB437>I<B77E16
F016FE3A01FE0001FF00009138003FC0EE0FE0707E707E707E707E177E177FEF3F80A2EF
1FC0A3EF0FE0A418F0AA18E0A3171F18C0A21880173F18005F17FE5F4C5AEE07F04C5AEE
3FC000014AB45AB748C7FC16F8168034337EB23B>I<B812C0A3D803FCC7127F0001150F
EE03E01601A21600A21760A403061330A41700150EA2151E157E90B512FEA39038FC007E
151E150EA21506170CA3171892C7FCA41738A21770A217F01601160316070003157FB812
E0A32E337DB234>I<B81280A3D803FCC7FC0001151FEE07C01603A21601A21600A41760
150CA31700A2151CA2153C15FC90B5FCA3EBFC00153C151CA2150CA592C8FCAB487EB512
FEA32B337DB232>I<DA03FE130C91393FFF801C91B512E0903A03FE01F83C903A0FF000
3C7CD91FC0EB0EFCD97F80130701FEC7120348481401000315005B4848157C485A173C48
5A171C123F5B007F160CA390C9FC4893C7FCAA0303B512E07E7F92390003FE00705A123F
7F121FA26C7E7F12076C7E7F6C6C14036C7E6D6C1307D91FC0EB0E7CD90FF0EB1C3CD903
FEEBF81C0100B5EAF00C023F01C0C7FCDA03FEC8FC33377CB43C>I<B5D8FE03B512F8A3
000190C73807FC006C486E5AB390B7FCA349C71203B3A3486C4A7EB5D8FE03B512F8A335
337EB23A>I<B512FEA3000113006C5AB3B3A7487EB512FEA317337EB21C>I<017FB5FCA3
9038003FE0EC1FC0B3B1127EB4FCA4EC3F805A0060140000705B6C13FE6C485A380F03F0
3803FFC0C690C7FC20357DB227>I<B500FE903807FFF8A3000190C7000113006C48EC00
FC17F04C5A4C5A4CC7FC160E5E5E5E5E4B5A4B5A4BC8FC150E5D5D15F84A7E14034A7EEC
0EFF5C4A6C7E4A6C7EECE01FD9FFC07F4A6C7E4A6C7E5B6F7E6F7EA26F7E707EA2707E70
7E160F83707E707EA283486C913807FF80B500FE013F13FCA336337EB23C>I<B512FEA3
D803FEC9FC6C5AB3A9EE0180A416031700A45EA25E5E5E5E16FE00031407B7FCA329337D
B230>I<D8FFFC923801FFF86D5DA20003EFFE00D801BFED06FCA3D99F80140CA2D98FC0
1418A3D987E01430A2D983F01460A3D981F814C0A3D980FCEB0180A2027EEB0300A36E13
06A26E6C5AA36E6C5AA36E6C5AA26E6C5AA36E6C5AA3913800FD80A2037FC7FCA3486C13
3ED80FF04B7EB5011C90387FFFF8A33D337CB246>I<D8FFFE91381FFFF87F80C6030013
006E143CD9DFE01418EBCFF0A2EBC7F8EBC3FCA2EBC1FEEBC0FF6E7EA26E7E6E7EA26E7E
6E7E6E7EA26E7E6E7EA2ED7F80ED3FC0ED1FE0A2ED0FF0ED07F8A2ED03FCED01FEED00FF
A2EE7F98EE3FD8A2EE1FF8160F1607A216031601A2486C1400D807F81578B500C01438A2
171835337EB23A>I<EC07FC91387FFFC0903901FC07F0903907E000FCD90F80133E013F
C76C7E017E6E7E496E7E48486E7E48486E7EA248486E7E000F8249157E001F167FA24848
ED3F80A2007F17C0A290C9121FA24817E0AB6C17C06D153FA3003F17806D157FA2001F17
006D5D000F5E6C6C4A5AA26C6C4A5A00015E6C6C4A5A017E4A5A6D4A5AD91FC0017FC7FC
D907E013FC903901FC07F09039007FFFC0DA07FCC8FC33377CB43C>I<B612FEEDFFC016
F03A03FC0007FC0001EC00FE167FEE3F80EE1FC017E0160FA217F0A617E0A2EE1FC0A2EE
3F80EE7F0016FEED07F890B65A168001FCC9FCB3A2487EB512F8A32C337DB234>I<EC07
FC91387FFFC0903901FC07F0903907E000FC4948137E013FC7EA1F80017E6E7E496E7E48
486E7E00038249140148486E7E000F8249157E001F167FA24848ED3F80A2007F17C0A390
C9121F4817E0AB6C17C0A26D153FA2003F1780A26D157F001F1700A2270FE001F013FE00
07D907FC5B9039F00E0E013B03F80C0703F8000190391C0383F03B00FC180187E0017EEC
CFC0013FECDF8090271F9C00FFC7FCD907EC13FC902701FE07F013609038007FFF913807
FC7091C7007813E0A2EE7C01EE7E0393387F07C0EE3FFFA21880821800705A705AEE01F0
33447CB43C>I<B612FCEDFF8016F03A01FE0007FC0000EC01FEED007F707E707E83160F
83A65FA24C5AA24C5A047EC7FC4B5AED0FF090B612C093C8FC9039FE001FC0ED07F06F7E
6F7E150082167E167FA583A5180C17C0A2043F131C486C1618B500FEEB1FE0040F133893
3807F070C93801FFE09338003F8036357EB239>I<90381FE00390387FFC0748B5FC3907
F01FCF390F8003FF48C7FC003E80814880A200788000F880A46C80A27E92C7FC127F13C0
EA3FF013FF6C13F06C13FF6C14C06C14F0C680013F7F01037F9038003FFF140302001380
157F153FED1FC0150F12C0A21507A37EA26CEC0F80A26C15006C5C6C143E6C147E01C05B
39F1FC03F800E0B512E0011F138026C003FEC7FC22377CB42B>I<007FB712FEA3903980
07F001D87C00EC003E0078161E0070160EA20060160600E01607A3481603A6C71500B3AB
4A7E011FB512FCA330337DB237>I<B500FE90381FFFF8A3000190C813006C48153C1718
B3AF1738017F1530A217706D6C1460011F15E06E495A010F14036D6C495A6D6C49C7FCD9
01FC131E6DB413FC91383FFFF0020F13C0020190C8FC35357EB23A>I<B500F0903803FF
F8A3D807FEC8EA7FC06C48ED1F000001161E6D151C00001618A26D15386D1530A26D6C5C
A26E14E0011F5DA26D6C495AA28001074AC7FCA26D6C1306A28001015CA26E131C010014
18806E5BA2ED8070023F1360A26E6C5AA215E1020F5BA2DA07F3C8FCA215FBEC03FEA36E
5AA26E5AA31570A235357EB23A>I<B5D8F007B539800FFFF0A3000390C7273FF0000113
00D801FC6E48EB007C1A386D140F00001930836D020715706D1860A26E496C14E0013F60
A26ED919FC1301011F60A26ED930FE1303010F95C7FCA26ED9607F5B01071706A26E9039
C03F800E0103170CA2913BFC01801FC01C01011718A2913BFE03000FE03801001730A2DA
FF06EB07F0027F5EA2038CEB03F8023F5EA203D8EB01FC021FEDFD80A203F0EB00FF020F
93C8FCA24B800207157EA24B143E0203153CA24B141C020115184C357FB24F>I<267FFF
FC90B512C0A3000101E090381FF80026007F80EB0FC0013F6E5A6E91C7FC6D6C130E010F
140C6E5B6D6C133801035C6E13606D6C13E06D6C485A5EDA7F83C8FCEC3FC715C6EC1FEC
EC0FFC5D14076E7EA26E7E815C6F7E9138063FC0140E4A6C7E9138180FF0EC380702707F
91386003FCECC0010101804A6C7E49C77E4981010E6E7E010C6E7E131C496E7E01786E7E
13FCD807FEEC1FFEB56C90B512F8A335337EB23A>I<B500F8ECFFFEA300030180EC3FE0
6C90C8EA1F806CEE0E006D6C5C6D6C141817386D6C14305F6D6C14E06D6C5C16016D6C5C
6D6C49C7FC5E6D6C13065E91387F801C91383FC018163891381FE0306E6C5A16E06E6C5A
EDF980EC03FF6E90C8FC5D1400B14A7E91B512FCA337337FB23A>I<003FB612FCA39039
F80007F813C090C7EA0FF0003EEC1FE0123C0038EC3FC00078EC7F801270EDFF004A5AA2
0060495AA24A5A4A5AC7FC4A5A4A5AA24A5A4AC7FCA2495A495AA2495A495AA24948130C
495AA2495A49C7FCA24848141CA2485A485A1638485A4848147816F84848130148481307
153FB7FCA326337CB22F>I<EAFFF0A4EAF000B3B3B3ADEAFFF0A40C4B79B715>I<000313
0C48131C000E133848137000181360003813E0003013C0EA700100601380A2EAE00300C0
1300A400DE137800FF13FCEB83FEA2EA7F81A2383F00FC001E1378171774B326>I<EAFF
F0A41200B3B3B3AD12FFA40C4B7FB715>I<EB7F803803FFF0380F80FC381C003E003F13
3F6D6C7E6E7EA26E7EEA1F00C7FCA4EB01FF131FEBFF873803FC07EA0FF0EA1FC0EA3F80
127F13004815C05AA3140FA26C131F6C133B3A3F8071F180391FC1E1FF2607FFC0130039
00FE003C22237DA126>97 D<EA03F012FFA312071203AEEC3F80ECFFE09038F3C0F89038
F7007E01FE7F49EB1F8049EB0FC05BED07E016F0A2150316F8AA16F0150716E0A2ED0FC0
7F6DEB1F8001ECEB3F0001CF137C90388381F8903801FFE0C76CC7FC25357EB32B>I<EB
07F8EB3FFF9038FC07C03901F000E03903E003F03807C007120FEA1F80123F90380003E0
4890C7FCA2127E12FEAA127FA26C14187F001F14386D1330000F14706C6C13E03903F001
C03900FC0F8090383FFE00EB07F01D237EA122>I<153FEC0FFFA3EC007F81AEEB07F0EB
3FFCEBFC0F3901F003BF3907E001FF48487E48487F8148C7FCA25A127E12FEAA127E127F
A27E6C6C5BA26C6C5B6C6C4813803A03F007BFFC3900F81E3FEB3FFCD90FE0130026357D
B32B>I<EB0FE0EB7FFCEBF83F3903F00F80D807E013C0390FC007E0381F800315F0EA3F
0014014814F8127EA212FEA2B6FCA248C8FCA5127E127FA26C1418A26C6C1338000F1430
6D13706C6C13E03901F003C03900FC0F00EB3FFEEB07F01D237EA122>I<EB01FCEB07FF
90381F078090383E0FC0EB7C1F13FCEA01F8A20003EB070049C7FCACB512F0A3D803F0C7
FCB3A7487E387FFFE0A31A357FB417>I<151F90391FC07F809039FFF8E3C03901F07FC7
3907E03F033A0FC01F83809039800F8000001F80EB00074880A66C5CEB800F000F5CEBC0
1F6C6C48C7FCEBF07C380EFFF8380C1FC0001CC9FCA3121EA2121F380FFFFEECFFC06C14
F06C14FC4880381F0001003EEB007F4880ED1F8048140FA56C141F007C15006C143E6C5C
390FC001F83903F007E0C6B51280D91FFCC7FC22337EA126>I<EA03F012FFA312071203
AEEC1FC0EC7FF09038F1E0FC9038F3807C9038F7007E13FE497FA25BA25BB3486CEB7F80
B538C7FFFCA326347EB32B>I<EA0780EA0FC0EA1FE0A4EA0FC0EA0780C7FCAAEA07E012
FFA3120F1207B3A6EA0FF0B5FCA310337EB215>I<EB03C0EB07E0EB0FF0A4EB07E0EB03
C090C7FCAAEB03F013FFA313071303B3B01238127C00FE13E0130714C0130F007C138038
381F00EA1FFCEA07F0144384B217>I<EA03F012FFA312071203AF913803FFE0A36E1300
EC00F8EC01E05D4A5A020FC7FC141C5C5C14F0EBF3F8EBF7FC13FEEBFC7EEBF87F496C7E
141F6E7E8114076E7E8114016E7E81486CEBFF80B500C313F0A324347EB329>I<EA07E0
12FFA3120F1207B3B3A7EA0FF0B5FCA310347EB315>I<2703F01FE013FF00FF90267FF8
0313C0903BF1E07C0F03E0903BF3803E1C01F02807F7003F387FD803FE1470496D486C7E
A2495CA2495CB3486C496C487EB53BC7FFFE3FFFF0A33C217EA041>I<3903F01FC000FF
EB7FF09038F1E0FC9038F3807C3907F7007EEA03FE497FA25BA25BB3486CEB7F80B538C7
FFFCA326217EA02B>I<EB07F0EB3FFE9038FC1F803901F007C03903C001E00007804848
6C7E48C7127CA248147E003E143E007E143FA300FE1580A8007E1500A36C147EA26C147C
6D13FC6C6C485A00075C3903F007E03900FC1F80D93FFEC7FCEB07F021237EA126>I<39
03F03F8000FFEBFFE09038F3C0F89038F7007ED807FE7F6C48EB1F804914C049130F16E0
ED07F0A3ED03F8A9150716F0A216E0150F16C06D131F6DEB3F80160001FF13FC9038F381
F89038F1FFE0D9F07FC7FC91C8FCAA487EB512C0A325307EA02B>I<903807F00390383F
FC07EBFC0F3901F8038F3807E001000F14DF48486CB4FC497F123F90C77E5AA25A5AA912
7FA36C6C5B121F6D5B000F5B3907E003BF3903F0073F3800F81EEB3FF8EB0FE090C7FCAA
ED7F8091380FFFFCA326307DA029>I<3803E07C38FFE1FF9038E38F809038E71FC0EA07
EEEA03ECA29038FC0F8049C7FCA35BB2487EB512E0A31A217FA01E>I<EBFF06000713CE
381F00FE003C133E48131E140E5A1406A27EA200FE90C7FC6C7EEA7FFC383FFFC014F000
0F7F6C7FC67FEB0FFF1300EC3F8000C0131F140F6C1307A37E15006C5B6C130E6C5B38F7
807838E1FFE038C07F8019237EA11E>I<1330A51370A313F0A21201A212031207381FFF
FEB5FCA23803F000AF1403A814073801F806A23800FC0EEB7E1CEB1FF8EB07E0182F7FAD
1E>I<D803F0133F00FFEB0FFFA30007EB007F000380B35DA35D12016D48138000009038
03BFFC90387E073FEB1FFED907F8130026227EA02B>I<B5EBFFF0A3D80FF0EB3F800007
EC1F000003140E150C6D131C00011418A26C6C5BA26D1370017E1360137F6D5BA290381F
8180A214C3010F90C7FCA2EB07E6A214FE6D5AA26D5AA36D5AA2146024217E9F29>I<B5
3A1FFF81FFF0A33C07F801FC003F8001F049EB1E0000030100141C816C6C017C1318A26D
017E1338000002FE1330A290267E01FF5B159F168090263F030F5BA216C0903A1F8607C1
80A202C613E390260FCC0390C7FCA2D907FC13F6ECF80116FE6D486C5AA36D481378A36D
48133034217F9F37>I<B53801FFF8A32603FE0013806C48EB7C0000001478017E137001
7F5B90383F81C090381F8380D90FC3C7FCEB07E614FE6D5A6D5A6D7E80805B9038039F80
9038071FC09038060FE0EB0C0790381C03F0496C7E01707FEBF000000180000FECFF8026
FFFC0313FCA326207F9F29>I<3A7FFF807FF8A33A07F8001FC00003EC0F800001EC0700
15066C6C5BA26D131C017E1318A26D5BA2EC8070011F1360ECC0E0010F5BA2903807E180
A214F3010390C7FC14FBEB01FEA26D5AA31478A21430A25CA214E05CA2495A1278D8FC03
C8FCA21306130EEA701CEA7838EA1FF0EA0FC025307F9F29>I<003FB512F0A2EB000F00
3C14E00038EB1FC00030EB3F800070137F1500006013FE495A13035CC6485A495AA2495A
495A49C7FC153013FE485A12035B48481370485A001F14604913E0485A387F000348130F
90B5FCA21C207E9F22>I<B712F8A22502809426>I<BC12F0A24C0280944D>I<001C1370
387F01FC00FF13FEA4007F13FC381C0070170879B226>127 D E
%EndDVIPSBitmapFont
/Fl 82[33 51[50 1[72 1[55 33 39 44 1[55 50 55 83 28 55
33 28 1[50 1[44 55 44 55 50 7[72 72 100 1[72 66 55 72
1[61 78 72 94 66 78 1[39 78 78 61 66 72 72 66 72 8[50
50 50 50 50 50 50 50 2[25 46[{TeXBase1Encoding ReEncodeFont}52
99.6264 /Times-Bold rf /Fm 134[42 2[42 46 23 42 28 1[46
46 46 69 18 2[18 46 1[23 46 1[42 1[46 7[55 3[60 1[55
4[60 4[23 4[60 60 10[46 2[46 46 46 1[46 4[23 44[{
TeXBase1Encoding ReEncodeFont}30 83.022 /Helvetica rf
%DVIPSBitmapFont: Fn cmsy9 9 8
/Fn 8 104 df<0060153000F815F86C1401007EEC03F06CEC07E06C6CEB0FC06C6CEB1F
806C6CEB3F006C6C137E6C6C5B6C6C485A90387E03F06D485A90381F8FC090380FDF806D
B4C7FC6D5A6D5AA2497E497E90380FDF8090381F8FC090383F07E090387E03F0496C7E48
486C7E4848137E48487F4848EB1F804848EB0FC048C7EA07E0007EEC03F048EC01F84814
0000601530252475A43C>2 D<130E131FA639700E01C000F8EB03E000FE130F00FF131F
397F8E3FC0391FEEFF003803FFF8C613E0EB3F80A2EBFFE0000313F8381FEEFF397F8E3F
C039FF0E1FE000FE130F00F813030070EB01C0D8001FC7FCA6130E1B207BA226>I<EB1F
C0EBFFF8487F000713FF390FF07F80391F800FC0393F0007E0003E130348EB01F0A248EB
00F8A2481478A56C14F8A2007CEB01F0A26CEB03E0003F1307391F800FC0390FF07F806C
B51200000113FC6C5BEB1FC01D1D7CA126>14 D<187018F0A2841878A2187C183C183E84
A2727E727E85727E727E727E197F007FBA12C0BB12F0A26C19C0CCEA7F0019FC4E5A4E5A
4E5A614E5A4EC7FCA2183E183C187C1878A218F860A2187044287CA64D>33
D<0060ED018000F0ED03C06C1507A200781680007C150FA2003C1600003E5DA26C153EA2
6C153C6D147CA26C6C5CA200035D90B6FCA26C5DA29038F000036C6C495AA201785C017C
130FA2013C91C7FC013E5BA26D133EA26D133CEC807CA201071378ECC0F8A2903803E1F0
A201015B14F3A26DB45AA26E5AA36EC8FCA3141E140C2A3680B32B>56
D<007FB61280B712C0A27EC81203B3A2003FB6FC5AA27EC81203B3A2007FB6FCB7FCA26C
158022347CB32B>I<EC07E0143FECFE00EB03F8495A495A5C131F5CB3A5133F91C7FC13
7E5BEA03F8EA7FE048C8FCEA7FE0EA03F8C67E137E7F80131FB3A580130F806D7E6D7EEB
00FEEC3FE014071B4B7BB726>102 D<12FCEAFFC0EA07F0EA01FC6C7E137F7F80131FB3
A580130F6D7E6D7EEB01FC9038007FC0EC1FE0EC7FC0903801FC00EB03F0495A495A131F
5CB3A5133F91C7FC5B13FE485AEA07F0EAFFC000FCC8FC1B4B7BB726>I
E
%EndDVIPSBitmapFont
/Fo 136[72 1[55 28 50 33 1[55 55 55 1[22 2[22 55 2[55
55 50 1[55 9[94 3[66 18[101 17[28 46[{TeXBase1Encoding ReEncodeFont}19
99.6264 /Helvetica rf /Fp 138[65 32 1[39 2[65 65 1[26
2[26 3[65 1[58 1[65 16[78 9[71 70[{TeXBase1Encoding ReEncodeFont}12
116.231 /Helvetica rf /Fq 82[50 51[83 4[50 83 2[91 9[50
83 3[83 12[91 100 15[108 67[{TeXBase1Encoding ReEncodeFont}11
149.44 /Helvetica-Bold rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
letter

%%EndSetup
%%Page: 1 1
1 0 bop 1406 111 a Fq(T)-9 b(ype\255Saf)o(e)41 b(Cast)1523
392 y Fp(Functional)30 b(P)-6 b(ear)r(l)1504 621 y Fo(Stephanie)30
b(W)m(eir)q(ich)2309 546 y Fn(\003)1323 708 y Fm(Depar)s(tment)24
b(of)f(Computer)h(Science)1615 795 y(Cor)r(nell)g(Univ)n(ersity)1620
883 y(Ithaca,)f(NY)g(14853)1403 1003 y Fo(s)m(w)o(eir)q(ich@cs)o(.cor)r
(nell.edu)-152 1304 y Fl(ABSTRA)-5 b(CT)-152 1395 y Fk(In)19
b(a)h(language)h(with)e(non-parametric)g(or)h(ad-ho)r(c)f(p)r
(olymorphism,)-152 1482 y(it)26 b(is)g(p)r(ossible)h(to)f(determine)f
(the)g(iden)n(tit)n(y)g(of)h(a)h(t)n(yp)r(e)d(v)l(ariable)j(at)-152
1569 y(run)c(time.)33 b(With)24 b(this)g(facilit)n(y)-6
b(,)25 b(w)n(e)f(can)g(write)g(a)g(function)g(to)g(con-)-152
1656 y(v)n(ert)32 b(a)g(term)g(from)g(one)g(abstract)h(t)n(yp)r(e)e(to)
h(another,)j(if)e(the)e(t)n(w)n(o)-152 1744 y(hidden)24
b(t)n(yp)r(es)f(are)i(iden)n(tical.)34 b(Ho)n(w)n(ev)n(er,)25
b(the)f(naiv)n(e)g(implemen)n(ta-)-152 1831 y(tion)18
b(of)h(this)f(function)g(requires)g(that)f(the)g(term)g(b)r(e)h
(destructed)f(and)-152 1918 y(rebuilt.)42 b(In)27 b(this)h(pap)r(er,)h
(w)n(e)f(sho)n(w)h(ho)n(w)f(to)g(eliminate)g(this)g(o)n(v)n(er-)-152
2005 y(head)g(using)h(higher-order)f(t)n(yp)r(e)g(abstraction.)43
b(W)-6 b(e)28 b(demonstrate)-152 2092 y(this)k(solution)h(in)e(t)n(w)n
(o)i(framew)n(orks)f(for)g(ad-ho)r(c)g(p)r(olymorphism:)-152
2180 y(in)n(tensional)27 b(t)n(yp)r(e)e(analysis)i(and)e(t)n(yp)r(e)g
(classes.)-152 2387 y Fl(Categories)g(and)g(Subject)i(Descriptors)-152
2478 y Fk(D.3.3)k([)p Fj(Programming)36 b(Languages)p
Fk(]:)43 b(Language)30 b(Constructs)-152 2565 y(and)39
b(F)-6 b(eatures|)p Fi(abstr)l(act)43 b(data)f(typ)l(es,)i(p)l
(olymorphism,)f(c)l(ontr)l(ol)-152 2652 y(structur)l(es)6
b Fk(;)38 b(F.3.3)33 b([)p Fj(Logics)k(and)g(Meanings)f(of)g(Programs)p
Fk(]:)-152 2740 y(Soft)n(w)n(are|)p Fi(typ)l(e)26 b(structur)l(e,)h(c)l
(ontr)l(ol)d(primitives,)g(functional)g(c)l(on-)-152
2827 y(structs)-152 3034 y Fl(General)h(T)-9 b(erms)-152
3125 y Fk(Languages)-152 3332 y Fl(K)n(eyw)o(ords)-152
3424 y Fk(Ad-ho)r(c)17 b(p)r(olymorphism,)g(dynamic)f(t)n(yping,)i(in)n
(tensional)g(t)n(yp)r(e)f(anal-)-152 3511 y(ysis,)27
b(t)n(yp)r(e)e(classes)-152 3718 y Fl(1.)100 b(THE)25
b(SETUP)-152 3810 y Fk(Supp)r(ose)i(y)n(ou)g(w)n(an)n(ted)h(to)g
(implemen)n(t)d(a)j(heterogeneous)h(sym)n(b)r(ol)-152
3897 y(table)37 b(|)e(a)i(\014nite)e(map)g(from)h(strings)h(to)f(v)l
(alues)g(of)h(an)n(y)e(t)n(yp)r(e.)-152 3984 y(Y)-6 b(ou)27
b(could)i(imagine)f(that)f(the)h(in)n(terface)h(to)f(this)g(mo)r(dule)f
(w)n(ould)-152 4071 y(declare)d(an)f(abstract)g(t)n(yp)r(e)f(for)i(the)
e(table,)i(a)f(v)l(alue)g(for)g(the)g(empt)n(y)p -152
4139 797 4 v -152 4196 a Fn(\003)-113 4229 y Fk(This)j(pap)r(er)g(is)g
(based)g(on)f(w)n(ork)h(supp)r(orted)f(in)h(part)f(b)n(y)g(the)g(Na-)
-152 4303 y(tional)30 b(Science)e(F)-6 b(oundation)29
b(under)e(Gran)n(t)i(No.)43 b(CCR-9875536.)-152 4378
y(An)n(y)22 b(opinions,)j(\014ndings)e(and)g(conclusions)i(or)f
(recommendations)-152 4453 y(expressed)g(in)g(this)f(publication)i(are)
f(those)g(of)g(the)g(author)f(and)h(do)-152 4528 y(not)i(re\015ect)f
(the)h(views)g(of)h(this)e(agency)-6 b(.)-152 5321 y
Fh(ICFP)17 b Fg('00)g(Montreal,)h(Quebec)h(Canada)2040
1304 y Fk(table,)h(and)e(t)n(w)n(o)h(p)r(olymorphic)e(functions)h(for)h
(inserting)g(items)f(in)n(to)2040 1391 y(and)24 b(retrieving)i(items)e
(from)g(the)g(table.)35 b(In)24 b(a)h(syn)n(tax)f(resem)n(bling)2040
1478 y(Standard)h(ML)h([10],)h(this)f(in)n(terface)h(is)2040
1711 y Ff(sig)2119 1798 y(type)40 b(table)2119 1886 y(val)f(empty)80
b(:)40 b(table)2119 1973 y(val)f(insert)i(:)f Fn(8)p
Fe(\013)p Ff(.)f(table)h Fn(!)f Ff(\(string)i Fn(\002)e
Fe(\013)p Ff(\))h Fn(!)f Ff(table)2119 2060 y(val)g(find)i(:)e
Fn(8)p Fe(\013)p Ff(.)g(table)i Fn(!)e Ff(string)h Fn(!)f
Fe(\013)2040 2147 y Ff(end)2040 2380 y Fk(Ho)n(w)n(ev)n(er,)22
b(lo)r(oking)f(at)f(the)g(t)n(yp)r(e)f(of)27 b Ff(find)21
b Fk(rev)n(eals)g(something)e(o)r(dd:)2040 2468 y(If)h(this)g(p)r
(olymorphic)f(function)h(b)r(eha)n(v)n(es)g(parametrically)h(with)f
(re-)2040 2555 y(sp)r(ect)31 b(to)g Fe(\013)p Fk(,)i(that)e(is)g(it)g
(executes)g(the)f(same)h(co)r(de)g(regardless)i(of)2040
2642 y(the)c(iden)n(tit)n(y)e(of)j Fe(\013)p Fk(,)g(there)f(cannot)g(p)
r(ossibly)g(b)r(e)g(an)n(y)f(correct)i(im-)2040 2729
y(plemen)n(tation)25 b(of)h Ff(find)g Fk([15].)36 b(All)25
b(implemen)n(tations)f(m)n(ust)g(either)2040 2816 y(div)n(erge)h(or)g
(raise)h(an)f(exception.)35 b(Let)24 b(us)h(examine)f(sev)n(eral)i(p)r
(ossi-)2040 2903 y(ble)g(implemen)n(tations)e(to)i(see)h(where)f(they)e
(go)j(wrong.)2040 3078 y(W)-6 b(e)28 b(will)i(assume)e(that)h(the)f
(data)h(structure)f(used)g(to)h(implemen)n(t)2040 3165
y(the)i(sym)n(b)r(ol)f(table)h(is)g(not)g(the)g(issue,)i(so)f(for)f
(simplicit)n(y)g(w)n(e)g(will)2040 3252 y(use)26 b(an)f(asso)r(ciation)
k(list.)2040 3485 y Ff(val)40 b(empty)g(=)g([])2040 3719
y Fk(Giv)n(en)25 b(a)g(string)g(and)g(a)g(list,)h(the)e(follo)n(wing)k
(v)n(ersion)d(of)31 b Ff(find)26 b Fk(iter-)2040 3806
y(ates)g(o)n(v)n(er)g(the)f(list)i(lo)r(oking)f(for)h(the)e(matc)n
(hing)g(string:)2040 4039 y Ff(let)40 b(rec)g(find)g(=)2119
4126 y Fk(\003)p Fe(\013:)g Ff(fn)f(table)i(=>)e(fn)h(symbol)h(=>)2236
4214 y(case)f(table)h(of)2315 4301 y([])e(=>)h(raise)g(NotFound)2236
4388 y(|)g(\()f(\(name,)i(value\))f(::)g(rest)g(\))g(=>)2354
4475 y(if)g(symbol)g(=)g(name)g(then)g(value)2354 4562
y(else)g(find[)p Fe(\013)p Ff(])h(rest)f(symbol)2040
4796 y Fk(Note)22 b(that,)h(unlik)n(e)e(in)h(SML,)g(w)n(e)g(mak)n(e)f
(t)n(yp)r(e)g(application)i(explicit)2040 4883 y(in)j(a)h(manner)f
(similar)h(to)f(the)g(p)r(olymorphic)g(lam)n(b)r(da)g(calculus)h(or)
2040 4970 y(System)33 b(F)i([4,)j(14].)63 b(The)36 b(notation)f(\003)p
Fe(\013)g Fk(abstracts)h(the)e(t)n(yp)r(e)g Fe(\013)2040
5057 y Fk(and)j Ff(find[)p Fe(\013)p Ff(])h Fk(instan)n(tiates)g(this)f
(t)n(yp)r(e)f(for)i(the)f(recursiv)n(e)g(call.)2040 5144
y(Unfortunately)-6 b(,)25 b(this)h(function)g(is)g(of)g(t)n(yp)r(e)2040
5378 y Fn(8)p Fe(\013)p Ff(.)39 b(\(string)i Fn(\002)e
Fe(\013)p Ff(\))h(list)g Fn(!)f Ff(string)i Fn(!)e Fe(\013)p
Ff(.)p eop
%%Page: 2 2
2 1 bop -152 -69 a Fk(If)27 b(w)n(e)g(w)n(ere)h(lo)r(oking)g(up)e(an)h
Ff(int)p Fk(,)h(the)e(list)i(passed)f(to)g Ff(find)h
Fk(could)-152 19 y(only)j(con)n(tain)g(pairs)g(of)h Ff(string)q
Fk(s)f(and)g Ff(int)q Fk(s.)50 b(W)-6 b(e)30 b(w)n(ould)h(not)g(b)r(e)
-152 106 y(able)20 b(to)g(store)h(v)l(alues)e(of)i(an)n(y)e(other)g(t)n
(yp)r(e)g(than)g Ff(int)h Fk(in)g(our)g(sym)n(b)r(ol)-152
193 y(table.)-152 367 y(The)30 b(problem)f(is)h(that,)h(in)e(a)h
(statically)h(t)n(yp)r(ed)e(language,)j(all)f(el-)-152
454 y(emen)n(ts)h(of)h(a)g(list)h(need)e(to)h(ha)n(v)n(e)f(the)g(same)g
(t)n(yp)r(e:)48 b(It)32 b(w)n(ould)h(b)r(e)-152 542 y(incorrect)k(to)g
(form)f(an)h(asso)r(ciation)i(list)e Ff([)i(\("x",)i(1\))e(;)h(\("y",)
-152 629 y(\(2,3\)\))h(])p Fk(.)34 b(As)23 b(w)n(e)g(do)h(not)f(w)n(an)
n(t)g(to)g(constrain)h(the)f(sym)n(b)r(ol)f(table)-152
716 y(to)32 b(con)n(tain)g(only)f(one)h(t)n(yp)r(e,)h(w)n(e)f(need)f
(to)h(hide)f(the)g(t)n(yp)r(e)g(of)h(the)-152 803 y(v)l(alue)26
b(for)i(eac)n(h)e(en)n(try)g(in)g(the)g(list.)38 b(One)25
b(p)r(ossibilit)n(y)j(is)f(to)f(use)h(an)-152 890 y(existen)n(tial)g(t)
n(yp)r(e)e([12].)35 b(The)26 b(instruction)-152 1113
y Ff(pack)40 b(v)g(as)g Fn(9)p Fe(\014)t(:\034)47 b Ff(hiding)41
b Fe(\034)751 1082 y Fd(0)-152 1336 y Fk(co)r(erces)28
b(a)f(v)l(alue)f(of)i(t)n(yp)r(e)d Fe(\034)35 b Fk(with)27
b Fe(\034)926 1305 y Fd(0)974 1336 y Fk(substituted)f(for)h
Fe(\014)k Fk(in)n(to)c(one)-152 1424 y(of)g(t)n(yp)r(e)e
Fn(9)p Fe(\014)t(:\034)9 b Fk(.)34 b(Con)n(v)n(ersely)-6
b(,)25 b(the)h(instruction)-152 1647 y Ff(unpack)41 b(\()p
Fe(\014)t Ff(,x\))f(=)g(e)f(in)h(e')-152 1870 y Fk(destructs)33
b(an)f(existen)n(tial)h(pac)n(k)l(age)g Ff(e)f Fk(of)h(t)n(yp)r(e)f
Fn(9)p Fe(\014)t(:\034)9 b Fk(,)33 b(binding)f(a)-152
1957 y(new)i(t)n(yp)r(e)e(v)l(ariable)i Fe(\014)j Fk(and)c(a)g(new)h
(term)e(v)l(ariable)i Ff(x)f Fk(of)h(t)n(yp)r(e)e Fe(\034)-152
2044 y Fk(within)26 b(the)g(expression)g Ff(e')p Fk(.)-152
2219 y(Therefore,)h(w)n(e)e(can)g(create)g(a)g(sym)n(b)r(ol)e(table)i
(of)h(t)n(yp)r(e)d Ff(\(string)41 b Fn(\002)-152 2306
y(9)p Fe(\014)t(:\014)t Ff(\))f(list)27 b Fk(with)f(the)f(expression)
-73 2529 y Ff([)39 b(\("x",)i(pack)f(1)f(as)h Fn(9)p
Fe(\014)t(:\014)j Ff(hiding)e(int\))f(;)5 2616 y(\("y",)h(pack)f
(\(2,3\))g(as)g Fn(9)p Fe(\014)t(:\014)j Ff(hiding)e(int)f
Fn(\002)f Ff(int)h(])-152 2839 y Fk(So)29 b(the)f(co)r(de)h(for)g
(insert)g(should)f(just)h(pac)n(k)l(age)f(up)g(its)h(argumen)n(t)-152
2926 y(and)d(cons)g(it)g(to)f(the)h(rest)g(of)g(the)f(table.)-152
3149 y Ff(val)40 b(insert)h(=)-34 3237 y Fk(\003)p Fe(\013:)f
Ff(fn)g(table)g(=>)g(fn)g(\(symbol,)h(obj\))f(=>)84 3324
y(\(symbol,)h(pack)f(obj)g(as)f Fn(9)p Fe(\014)t(:\014)44
b Ff(hiding)d Fe(\013)p Ff(\))e(::)h(table)-152 3547
y Fk(Ho)n(w)n(ev)n(er,)23 b(the)e(existen)n(tial)h(t)n(yp)r(e)e(has)i
(not)f(really)h(solv)n(ed)g(the)e(prob-)-152 3634 y(lem.)32
b(W)-6 b(e)19 b(can)g(create)h(the)f(list,)j(but)c(what)i(do)f(w)n(e)h
(do)f(when)g(w)n(e)h(lo)r(ok)-152 3721 y(up)26 b(a)g(sym)n(b)r(ol?)34
b(It)26 b(will)h(ha)n(v)n(e)e(t)n(yp)r(e)g Fn(9)p Fe(\014)t(:\014)t
Fk(,)i(but)e Ff(find)i Fk(m)n(ust)d(return)-152 3808
y(a)g(v)l(alue)f(of)h(t)n(yp)r(e)e Fe(\013)p Fk(.)34
b(If)24 b(w)n(e)f(use)g(the)g(sym)n(b)r(ol)g(table)g(correctly)-6
b(,)24 b(then)-152 3896 y Fe(\013)k Fk(and)e Fe(\014)32
b Fk(will)c(abstract)g(the)e(same)h(t)n(yp)r(e,)g(but)f(w)n(e)i(need)f
(to)g(v)n(erify)-152 3983 y(this)g(prop)r(ert)n(y)e(b)r(efore)i(w)n(e)g
(can)f(con)n(v)n(ert)f(something)h(of)h(t)n(yp)r(e)e
Fe(\014)31 b Fk(to)-152 4070 y(t)n(yp)r(e)23 b Fe(\013)p
Fk(.)33 b(W)-6 b(e)23 b(can)g(not)g(compare)g Fe(\013)g
Fk(and)g Fe(\014)k Fk(and)c(still)h(remain)f(para-)-152
4157 y(metric)29 b(in)h Fe(\013)f Fk(and)h Fe(\014)t
Fk(.)46 b(Therefore,)32 b(it)e(seems)f(as)h(though)f(w)n(e)h(need)-152
4244 y(a)24 b(language)i(that)d(supp)r(orts)h(some)f(sort)i(of)f
(non-parametric)f(p)r(oly-)-152 4332 y(morphism)29 b(\(also)j(called)f
(run-time)e(t)n(yp)r(e)g(analysis,)k(o)n(v)n(erloading,)-152
4419 y(or)i(\\ad)f(ho)r(c")g(p)r(olymorphism\).)58 b(F)-6
b(orm)n(ulations)33 b(of)i(this)f(feature)-152 4506 y(include)24
b(Hask)n(ell)g(t)n(yp)r(e)e(classes)k([16],)f(t)n(yp)r(e)e(Dynamic)f
([1,)j(7,)g(9],)g(ex-)-152 4593 y(tensional)31 b(p)r(olymorphism)d
([3],)k(and)e(in)n(tensional)g(p)r(olymorphism)-152 4680
y([6].)-152 4855 y(F)-6 b(or)21 b(no)n(w,)h(w)n(e)f(will)h(consider)g
(the)e(last,)j(in)d(Harp)r(er)h(and)f(Morrisett's)-152
4942 y(language)25 b Fe(\025)211 4910 y Fc(ML)211 4956
y Fb(i)303 4942 y Fk(.)34 b(This)23 b(language)i(con)n(tains)e(the)g
(core)g(of)h(SML)f(plus)-152 5029 y(an)30 b(additional)g
Ff(typerec)h Fk(op)r(erator)f(to)f(recursiv)n(ely)h(examine)e(un-)-152
5116 y(kno)n(wn)k(t)n(yp)r(es)f(at)g(run)g(time.)52 b(F)-6
b(or)32 b(simplicit)n(y)-6 b(,)33 b(w)n(e)f(will)h(separate)-152
5203 y(recursion)24 b(from)g(t)n(yp)r(e)e(analysis)j(and)e(use)g(the)h
(op)r(erator)g Ff(typecase)-152 5290 y Fk(to)d(discriminate)g(b)r(et)n
(w)n(een)g(t)n(yp)r(es,)h(and)e Ff(rec)i Fk(to)f(compute)e(the)i(least)
-152 5378 y(\014xed)k(p)r(oin)n(t)g(of)i(a)f(recursiv)n(e)g(equation.)
2040 -69 y(This)33 b(language)g(is)g(in)n(terpreted)e(b)n(y)g(a)66
b Fi(typ)l(e-p)l(assing)41 b Fk(seman)n(tics.)2040 19
y(In)32 b(other)g(w)n(ords,)j(at)d(run)g(time)g(a)g(t)n(yp)r(e)g
(argumen)n(t)f(is)i(passed)f(to)2040 106 y(a)k(t)n(yp)r(e)e
(abstraction)i(of)g(t)n(yp)r(e)e Fn(8)p Fe(\013:\034)9
b Fk(,)38 b(and)d(can)g(b)r(e)g(analyzed)h(b)n(y)2040
193 y Ff(typecase)p Fk(.)44 b(Dually)-6 b(,)28 b(when)g(w)n(e)h(create)
g(an)f(ob)t(ject)h(of)g(an)f(existen-)2040 280 y(tial)g(t)n(yp)r(e,)f
Fn(9)p Fe(\013:\034)9 b Fk(,)27 b(the)g(hidden)f(t)n(yp)r(e)g(is)i
(included)e(in)h(the)g(pac)n(k)l(age,)2040 367 y(and)h(when)g(the)f
(pac)n(k)l(age)i(is)f(op)r(ened,)h Fe(\013)f Fk(ma)n(y)f(also)i(b)r(e)f
(examined.)2040 454 y(In)e Fe(\025)2182 423 y Fc(ML)2182
468 y Fb(i)2274 454 y Fk(,)i(univ)n(ersal)e(and)h(existen)n(tial)g(t)n
(yp)r(es)f(ha)n(v)n(e)g(di\013eren)n(t)g(prop-)2040 542
y(erties)e(from)f(a)h(system)f(with)g(a)49 b Fi(typ)l(e-er)l(asur)l(e)
33 b Fk(seman)n(tics,)24 b(suc)n(h)f(as)2040 629 y(the)e(p)r
(olymorphic)g(lam)n(b)r(da)g(calculus.)34 b(In)21 b(a)h(t)n(yp)r
(e-erasure)f(system,)2040 716 y(t)n(yp)r(es)28 b(ma)n(y)f(ha)n(v)n(e)h
(no)g(e\013ect)h(on)f(run-time)f(execution)h(and)g(there-)2040
803 y(fore)j(ma)n(y)e(b)r(e)g(erased)i(after)f(t)n(yp)r(e)f(c)n(hec)n
(king.)47 b(There,)32 b Fn(8)p Fe(\013:\013)e Fk(is)h(an)2040
890 y(empt)n(y)d(t)n(yp)r(e)g(\(suc)n(h)h(as)69 b Ff(void)p
Fk(\),)32 b(and)d Fn(9)p Fe(\014)t(:\014)34 b Fk(is)c(equiv)l(alen)n(t)
e(to)i(the)2040 977 y(singleton)22 b(t)n(yp)r(e)e Ff(unit)p
Fk(.)34 b(Ho)n(w)n(ev)n(er,)22 b(in)e Fe(\025)3195 946
y Fc(ML)3195 991 y Fb(i)3288 977 y Fk(,)i Fn(8)p Fe(\013:\013)f
Fk(is)h(not)e(empt)n(y)-6 b(,)20 b(as)2040 1065 y(w)n(e)j(can)f(use)h
Ff(typecase)h Fk(to)e(de\014ne)g(an)g(appropriate)h(v)l(alue)f(for)h
(eac)n(h)2040 1152 y(t)n(yp)r(e,)29 b(and)g Fn(9)p Fe(\014)t(:\014)k
Fk(is)d(the)f(implemen)n(tation)e(of)j(t)n(yp)r(e)e(Dynamic,)h(as)2040
1239 y(w)n(e)d(can)g(use)g Ff(typecase)h Fk(to)f(reco)n(v)n(er)g(the)f
(hidden)g(t)n(yp)r(e.)2040 1413 y(In)g Fe(\025)2181 1382
y Fc(ML)2181 1427 y Fb(i)2274 1413 y Fk(,)h(a)g(simple)g(function,)g
Ff(sametype)p Fk(,)i(to)e(compare)g(t)n(w)n(o)g(t)n(yp)r(es)2040
1500 y(and)36 b(return)g(true)g(if)h(they)f(matc)n(h,)i(can)f(b)r(e)f
(implemen)n(ted)e(with)2040 1588 y(nested)65 b Ff(typecase)p
Fk(s.)38 b(The)26 b(outer)g Ff(typecase)i Fk(disco)n(v)n(ers)e(the)g
(head)2040 1675 y(normal)h(form)f(of)i(the)e(\014rst)h(t)n(yp)r(e,)f
(and)h(then)f(the)g(inner)h Ff(typecase)2040 1762 y Fk(compares)33
b(it)f(to)h(the)f(head)g(normal)h(form)f(of)h(the)g(second.)3831
1730 y Fa(1)3920 1762 y Fk(F)-6 b(or)2040 1849 y(pro)r(duct)22
b(and)g(function)g(t)n(yp)r(es,)h Ff(sametype)g Fk(calls)h(itself)g
(recursiv)n(ely)2040 1936 y(on)k(the)f(sub)r(comp)r(onen)n(ts)g(of)h
(the)g(t)n(yp)r(e.)39 b(Eac)n(h)28 b(of)h(these)f(branc)n(hes)2040
2023 y(binds)e(t)n(yp)r(e)g(v)l(ariables)i(\(suc)n(h)e(as)i
Fe(\013)3089 2031 y Fa(1)3150 2023 y Fk(and)f Fe(\013)3350
2031 y Fa(2)3385 2023 y Fk(\))f(to)h(the)g(sub)r(comp)r(o-)2040
2111 y(nen)n(ts)c(of)h(the)e(t)n(yp)r(es)h(so)h(that)f(they)f(ma)n(y)g
(b)r(e)h(used)g(in)g(the)f(recursiv)n(e)2040 2198 y(call.)2040
2667 y Ff(let)40 b(rec)g(sametype)80 b(=)2158 2754 y
Fk(\003)p Fe(\013:)40 b Fk(\003)p Fe(\014)t(:)2275 2842
y Ff(typecase)i(\()p Fe(\013)p Ff(\))d(of)2354 2929 y(int)h(=>)2432
3016 y(typecase)h(\()p Fe(\014)t Ff(\))f(of)2511 3103
y(int)g(=>)f(true)2432 3190 y(|)p 2516 3190 24 4 v 186
w(=>)g(false)2275 3277 y(|)h(\()p Fe(\013)2442 3285 y
Fa(1)2494 3277 y Fn(\002)17 b Fe(\013)2620 3285 y Fa(2)2655
3277 y Ff(\)=>)2432 3365 y(typecase)41 b(\()p Fe(\014)t
Ff(\))f(of)2511 3452 y(\()p Fe(\014)2593 3460 y Fa(1)2645
3452 y Fn(\002)17 b Fe(\014)2765 3460 y Fa(2)2800 3452
y Ff(\))39 b(=>)2511 3539 y(sametype[)p Fe(\013)2911
3547 y Fa(1)2948 3539 y Ff(][)p Fe(\014)3069 3547 y Fa(1)3104
3539 y Ff(])2629 3626 y(andalso)h(sametype[)p Fe(\013)3342
3634 y Fa(2)3379 3626 y Ff(][)p Fe(\014)3500 3634 y Fa(2)3536
3626 y Ff(])2432 3713 y(|)p 2516 3713 V 107 w(=>)g(false)2275
3801 y(|)g(\()p Fe(\013)2442 3809 y Fa(1)2498 3801 y
Fn(!)21 b Fe(\013)2645 3809 y Fa(2)2680 3801 y Ff(\))40
b(=>)2432 3888 y(typecase)h(\()p Fe(\014)t Ff(\))f(of)2511
3975 y(\()p Fe(\014)2593 3983 y Fa(1)2649 3975 y Fn(!)21
b Fe(\014)2790 3983 y Fa(2)2825 3975 y Ff(\))40 b(=>)2511
4062 y(sametype[)p Fe(\013)2911 4070 y Fa(1)2948 4062
y Ff(][)p Fe(\014)3069 4070 y Fa(1)3104 4062 y Ff(])2629
4149 y(andalso)g(sametype[)p Fe(\013)3342 4157 y Fa(2)3379
4149 y Ff(][)p Fe(\014)3500 4157 y Fa(2)3536 4149 y Ff(])2432
4236 y(|)p 2516 4236 V 107 w(=>)g(false)2040 4706 y Fk(As)28
b(these)g(nested)f Ff(typecase)p Fk(s)j(are)f(tedious)f(to)g(write,)h
(w)n(e)g(b)r(orro)n(w)2040 4793 y(from)24 b(the)f(pattern)h(matc)n
(hing)f(syn)n(tax)f(of)j(Standard)e(ML,)i(and)e(ab-)2040
4880 y(breviate)j(this)g(function)f(as:)p 2040 5217 797
4 v 2044 5271 a Fa(1)2078 5303 y Fk(F)-6 b(or)26 b(brevit)n(y)-6
b(,)24 b(w)n(e)i(only)f(include)h Ff(int)p Fk(,)g(pro)r(duct)f(t)n(yp)r
(es,)g(and)g(func-)2040 5378 y(tion)h(t)n(yp)r(es)f(in)h(the)f
(examples.)p eop
%%Page: 3 3
3 2 bop -152 -69 a Ff(let)40 b(rec)g(sametype)80 b(=)-34
19 y Fk(\003)p Fe(\013:)40 b Fk(\003)p Fe(\014)t(:)84
106 y Ff(typecase)h(\()p Fe(\013;)13 b(\014)t Ff(\))40
b(of)162 193 y(\(int,int\))h(=>)f(true)84 280 y(|)f(\()p
Fe(\013)250 288 y Fa(1)302 280 y Fn(\002)17 b Fe(\013)428
288 y Fa(2)463 280 y Ff(,)p Fe(\014)545 288 y Fa(1)597
280 y Fn(\002)g Fe(\014)717 288 y Fa(2)752 280 y Ff(\))39
b(=>)162 367 y(sametype[)p Fe(\013)562 375 y Fa(1)599
367 y Ff(][)p Fe(\014)720 375 y Fa(1)755 367 y Ff(])280
454 y(andalso)i(sametype[)p Fe(\013)994 462 y Fa(2)1030
454 y Ff(][)p Fe(\014)1151 462 y Fa(2)1187 454 y Ff(])84
542 y(|)e(\()p Fe(\013)250 550 y Fa(1)307 542 y Fn(!)21
b Fe(\013)454 550 y Fa(2)488 542 y Ff(,)p Fe(\014)570
550 y Fa(1)627 542 y Fn(!)g Fe(\014)768 550 y Fa(2)803
542 y Ff(\))39 b(=>)162 629 y(sametype[)p Fe(\013)562
637 y Fa(1)599 629 y Ff(][)p Fe(\014)720 637 y Fa(1)755
629 y Ff(])280 716 y(andalso)i(sametype[)p Fe(\013)994
724 y Fa(2)1030 716 y Ff(][)p Fe(\014)1151 724 y Fa(2)1187
716 y Ff(])84 803 y(|)e(\()p 206 803 24 4 v 29 w(,)p
274 803 V 28 w(\))h(=>)f(false)-152 1073 y Fk(Ho)n(w)n(ev)n(er,)34
b(though)e(this)g(function)h(do)r(es)f(allo)n(w)i(us)e(to)h(determine)
-152 1160 y(if)i(t)n(w)n(o)g(t)n(yp)r(es)e(are)i(equal,)h(it)e(do)r(es)
h(not)f(solv)n(e)g(our)h(problem.)58 b(In)-152 1247 y(fact,)43
b(it)c(is)g(just)f(ab)r(out)h(useless.)74 b(If)39 b(w)n(e)g(try)f(to)g
(use)h(it)f(in)h(our)-152 1334 y(implemen)n(tation)25
b(of)32 b Ff(find)-152 1604 y(let)40 b(rec)g(find)g(=)-34
1691 y Fk(\003)p Fe(\013:)g Ff(fn)g(table)g(=>)g(fn)g(symbol)g(=>)84
1779 y(case)g(table)g(of)162 1866 y([])g(=>)g(raise)g(NotFound)84
1953 y(|)f(\()h(\(name,)g(package\))h(::)f(rest)g(\))g(=>)162
2040 y(unpack)h(\()p Fe(\014)t Ff(,value\))g(=)e(package)i(in)162
2127 y(if)f(symbol)g(=)g(name)398 2214 y(andalso)g(sametype[)p
Fe(\013)p Ff(][)p Fe(\014)t Ff(])162 2302 y(then)g(value)162
2389 y(else)g(find[)p Fe(\013)p Ff(])h(rest)f(symbol)-152
2659 y Fk(w)n(e)31 b(disco)n(v)n(er)f(that)f(this)h(use)g(do)r(es)h
(not)f(t)n(yp)r(e)f(c)n(hec)n(k.)46 b(The)30 b(return)-152
2746 y(t)n(yp)r(e)25 b(for)h Ff(find)h Fk(is)f(the)f(existen)n(tially)h
(b)r(ound)f Fe(\014)k Fk(whic)n(h)d(escap)r(es)g(its)-152
2833 y(scop)r(e.)53 b(Ev)n(en)31 b(though)g(w)n(e)h(ha)n(v)n(e)f(added)
g(a)h(dynamic)e(c)n(hec)n(k)h(that)-152 2920 y Fe(\013)d
Fk(is)f(equiv)l(alen)n(t)g(to)g Fe(\014)t Fk(,)h(the)f(c)n(hec)n(k)f
(do)r(es)i(not)f(c)n(hange)g(the)g(t)n(yp)r(e)f(of)-152
3007 y Ff(value)h Fk(from)f Fe(\014)j Fk(to)d Fe(\013)p
Fk(.)-152 3182 y(Our)33 b(problem)g(is)h(that)f(w)n(e)g(did)g(not)h
(use)f(the)g(full)h(p)r(o)n(w)n(er)g(of)g(the)-152 3269
y(t)n(yp)r(e)22 b(system.)32 b(In)22 b(a)g(standard)h(case)g
(expression)g(\(as)f(opp)r(osed)h(to)f(a)-152 3356 y
Ff(typecase)r Fk(\),)g(eac)n(h)f(branc)n(h)f(m)n(ust)f(b)r(e)i(of)h
(the)e(same)h(t)n(yp)r(e.)32 b(Ho)n(w)n(ev)n(er,)-152
3443 y(in)e Fe(\025)-13 3411 y Fc(ML)-13 3457 y Fb(i)110
3443 y Fk(the)f(t)n(yp)r(e)g(of)i(eac)n(h)f(branc)n(h)g(of)h(a)f
Ff(typecase)i Fk(can)e(dep)r(end)-152 3530 y(on)c(the)f(analyzed)h(t)n
(yp)r(e.)-152 3800 y Ff(typecase)41 b Fe(\034)48 b Ff(of)-34
3887 y(int)40 b(=>)g(fn)f(\(x:int\))i(=>)f(x)f(+)h(3)-112
3975 y(|)f Fe(\013)22 b Fn(!)f Fe(\014)43 b Ff(=>)-34
4062 y(fn\(x:)p Fe(\013)23 b Fn(!)e Fe(\014)t Ff(\))40
b(=>)f(x)-112 4149 y(|)g Fe(\013)17 b Fn(\002)g Fe(\014)44
b Ff(=>)-34 4236 y(fn\(x:)p Fe(\013)18 b Fn(\002)f Fe(\014)t
Ff(\))40 b(=>)g(x)-152 4506 y Fk(F)-6 b(or)41 b(example,)j(although)d
(the)f(\014rst)g(branc)n(h)g(ab)r(o)n(v)n(e)h(is)g(of)h(t)n(yp)r(e)-152
4593 y Ff(int)32 b Fn(!)g Ff(int)p Fk(,)i(the)d(second)h(of)g(t)n(yp)r
(e)f(\()p Fe(\014)36 b Fn(!)31 b Fe(\015)t Fk(\))g Fn(!)g
Fk(\()p Fe(\014)36 b Fn(!)31 b Fe(\015)t Fk(\),)i(and)-152
4680 y(the)28 b(third)f(of)h(t)n(yp)r(e)f(\()p Fe(\014)22
b Fn(\002)c Fe(\015)t Fk(\))25 b Fn(!)f Fk(\()p Fe(\014)f
Fn(\002)18 b Fe(\015)t Fk(\),)28 b(all)g(three)g(branc)n(hes)f(are)-152
4767 y(instances)37 b(of)f(the)f(t)n(yp)r(e)g(sc)n(hema)g
Fe(\015)42 b Fn(!)37 b Fe(\015)t Fk(,)h(when)e Fe(\015)j
Fk(is)d(replaced)-152 4855 y(with)23 b(the)f(iden)n(tit)n(y)f(of)i
Fe(\034)31 b Fk(for)23 b(that)f(branc)n(h.)33 b(Therefore,)24
b(this)f(en)n(tire)-152 4942 y Ff(typecase)j Fk(expression)f(can)g(b)r
(e)f(safely)h(assigned)h(the)e(t)n(yp)r(e)f Fe(\034)30
b Fn(!)21 b Fe(\034)9 b Fk(.)-152 5116 y(With)21 b(this)g(facilit)n(y)
-6 b(,)22 b(in)f(order)g(to)g(mak)n(e)e(t)n(yp)r(ec)n(hec)n(king)h(a)h
Ff(typecase)-152 5203 y Fk(term)32 b(syn)n(tax-directed,)h(it)g(is)g
(annotated)f(with)h(a)g(t)n(yp)r(e)e(v)l(ariable)-152
5290 y(and)26 b(a)g(t)n(yp)r(e)e(sc)n(hema)h(where)h(that)g(v)l
(ariable)g(ma)n(y)e(o)r(ccur)i(free.)36 b(F)-6 b(or)-152
5378 y(example)25 b(w)n(e)h(annotate)g(the)g(previous)f(example)g(as)p
2040 -148 1993 4 v 2040 -32 a Ff(cast)40 b(:)g Fn(8)p
Fe(\013:)f Fn(8)p Fe(\014)t(:)h(\013)21 b Fn(!)g Fe(\014)2040
55 y Ff(let)40 b(rec)g(cast)g(=)2158 142 y Fk(\003)p
Fe(\013:)g Fk(\003)p Fe(\014)t(:)2236 229 y Ff(typecase)h([)p
Fe(\016)2662 237 y Fa(1)2697 229 y Fe(;)53 b(\016)2805
237 y Fa(2)2839 229 y Fe(:)40 b(\016)2934 237 y Fa(1)2990
229 y Fn(!)21 b Fe(\016)3122 237 y Fa(2)3157 229 y Ff(]\()p
Fe(\013;)13 b(\014)t Ff(\))40 b(of)2275 317 y(\(int,)h(int\))f(=>)2354
404 y(fn)g(\(x:int\))g(=>)g(x)2197 491 y(|)f(\()p Fe(\013)2363
499 y Fa(1)2416 491 y Fn(\002)16 b Fe(\013)2541 499 y
Fa(2)2576 491 y Fe(;)53 b(\014)2693 499 y Fa(1)2744 491
y Fn(\002)17 b Fe(\014)2864 499 y Fa(2)2899 491 y Ff(\))40
b(=>)2354 578 y(let)g(val)g(f)f(=)h(cast)g([)p Fe(\013)3109
586 y Fa(1)3144 578 y Ff(][)p Fe(\014)3265 586 y Fa(1)3300
578 y Ff(])2511 665 y(val)g(g)f(=)h(cast)g([)p Fe(\013)3109
673 y Fa(2)3144 665 y Ff(][)p Fe(\014)3265 673 y Fa(2)3300
665 y Ff(])2354 752 y(in)2472 840 y(fn)f(\(x:)p Fe(\013)2755
848 y Fa(1)2808 840 y Fn(\002)17 b Fe(\013)2934 848 y
Fa(2)2968 840 y Ff(\))40 b(=>)2550 927 y(\(f)g(\(fst)g(x\),)g(g)f
(\(snd)h(x\)\))2354 1014 y(end)2197 1101 y(|)f(\()p Fe(\013)2363
1109 y Fa(1)2420 1101 y Fn(!)21 b Fe(\013)2567 1109 y
Fa(2)2602 1101 y Fe(;)52 b(\014)2718 1109 y Fa(1)2774
1101 y Fn(!)21 b Fe(\014)2915 1109 y Fa(2)2950 1101 y
Ff(\))40 b(=>)2354 1188 y(let)g(val)g(f)f(=)h(cast)g([)p
Fe(\014)3103 1196 y Fa(1)3138 1188 y Ff(][)p Fe(\013)3265
1196 y Fa(1)3300 1188 y Ff(])2511 1275 y(val)g(g)f(=)h(cast)g([)p
Fe(\013)3109 1283 y Fa(2)3144 1275 y Ff(][)p Fe(\014)3265
1283 y Fa(2)3300 1275 y Ff(])2354 1363 y(in)2432 1450
y(fn)g(\(x:)p Fe(\013)2716 1458 y Fa(1)2773 1450 y Fn(!)21
b Fe(\013)2920 1458 y Fa(2)2955 1450 y Ff(\))39 b(=>)2550
1537 y(g)h Fn(\016)f Ff(x)h Fn(\016)f Ff(f)2354 1624
y(end)2197 1711 y(|)g(\()p 2319 1711 24 4 v 29 w(,)p
2387 1711 V 28 w(\))h(=>)g(raise)g(CantCast)2575 1962
y Fj(Figure)30 b(1:)39 b(First)30 b(Solution)p 2040 2012
1993 4 v 2040 2236 a Ff(typecase)41 b([)p Fe(\015)t(:\015)26
b Fn(!)21 b Fe(\015)t Ff(])39 b Fe(\034)48 b Ff(of)2275
2323 y(int)40 b(=>)g(fn)g(\(x:int\))h(=>)e(x)h(+)f(3)2197
2410 y(|)g(...)2040 2636 y Fk(In)20 b(later)i(examples,)f(when)g(w)n(e)
h(use)e(the)h(pattern)f(matc)n(hing)g(syn)n(tax)2040
2723 y(for)31 b(t)n(w)n(o)g(nested)f(t)n(yp)r(ecases,)i(w)n(e)f(will)g
(need)f(the)g(sc)n(hema)g(to)g(ha)n(v)n(e)2040 2810 y(t)n(w)n(o)c(free)
h(t)n(yp)r(e)d(v)l(ariables.)2040 2984 y(W)-6 b(e)42
b(no)n(w)h(ha)n(v)n(e)f(ev)n(erything)g(w)n(e)h(need)g(to)g(write)g(a)g
(v)n(ersion)g(of)2040 3072 y Ff(sametype)c Fk(that)d(c)n(hanges)h(the)g
(t)n(yp)r(e)f(of)h(a)h(term)d(and)i(allo)n(ws)i(us)2040
3159 y(to)26 b(write)g Ff(find)p Fk(.)36 b(In)25 b(the)g(rest)h(of)g
(this)g(pap)r(er)f(w)n(e)h(will)h(dev)n(elop)e(this)2040
3246 y(function,)39 b(suggestiv)n(ely)e(called)g Ff(cast)p
Fk(,)j(of)c(t)n(yp)r(e)g Fn(8)p Fe(\013:)p Fn(8)p Fe(\014)t(:\013)j
Fn(!)f Fe(\014)t Fk(.)2040 3333 y(This)21 b(function)f(will)h(just)f
(return)g(its)g(argumen)n(t)f(\(at)h(the)f(new)i(t)n(yp)r(e\))2040
3420 y(if)27 b(the)g(t)n(yp)r(e)f(argumen)n(ts)g(matc)n(h,)g(and)g
(raise)i(an)e(exception)h(other-)2040 3507 y(wise.)2201
3476 y Fa(2)2040 3682 y Fk(An)18 b(initial)h(implemen)n(tation)e(app)r
(ears)i(in)f(Section)h(2.)32 b(Though)18 b(cor-)2040
3769 y(rect,)25 b(its)g(op)r(eration)g(requires)f(undesirable)h(o)n(v)n
(erhead)e(for)i(what)g(is)2040 3856 y(essen)n(tially)d(an)f(iden)n(tit)
n(y)g(function.)33 b(W)-6 b(e)20 b(impro)n(v)n(e)g(it,)j(in)e(Section)g
(3,)2040 3943 y(through)j(the)g(aid)g(of)h(an)f(additional)i(t)n(yp)r
(e)d(constructor)i(argumen)n(t)2040 4031 y(to)d Ff(cast)p
Fk(.)34 b(T)-6 b(o)22 b(demonstrate)f(the)g(applicabilit)n(y)h(of)g
(this)g(solution)g(to)2040 4118 y(other)28 b(non-parametric)f(framew)n
(orks,)i(in)f(Section)g(4,)h(w)n(e)f(dev)n(elop)2040
4205 y(the)34 b(analogous)i(t)n(w)n(o)f(solutions)g(in)g(Hask)n(ell)f
(using)h(t)n(yp)r(e)e(classes.)2040 4292 y(In)f(Section)h(5,)i(w)n(e)f
(compare)e(these)h(solutions)h(with)f(sev)n(eral)h(im-)2040
4379 y(plemen)n(tations)f(of)g(t)n(yp)r(e)f(Dynamic.)55
b(Finally)-6 b(,)36 b(in)d(Section)g(6,)i(w)n(e)2040
4466 y(conclude)f(b)n(y)f(eliminating)h(the)f(t)n(yp)r(e)g(classes)i
(from)f(the)f(Hask)n(ell)2040 4554 y(solution)k(to)f(pro)r(duce)g(a)h
(sym)n(b)r(ol)e(table)i(implemen)n(tation)d(using)2040
4641 y(only)e(parametric)g(p)r(olymorphism.)51 b(As)32
b(suc)n(h,)h(the)f(t)n(yp)r(es)f(of)i(the)2040 4728 y(functions)26
b Ff(insert)h Fk(and)e Ff(find)i Fk(m)n(ust)d(b)r(e)i(mo)r(di\014ed.)
2040 4923 y Fl(2.)99 b(FIRST)26 b(SOLUTION)2040 5014
y Fk(An)21 b(initial)h(implemen)n(tation)e(of)28 b Ff(cast)22
b Fk(using)g(the)f(facilities)j(of)e Fe(\025)3940 4982
y Fc(ML)3940 5028 y Fb(i)2040 5101 y Fk(app)r(ears)i(in)f(Figure)g(1.)
34 b(In)23 b(the)f(\014rst)h(branc)n(h)f(of)i(the)62
b Ff(typecase)p Fk(,)25 b Fe(\013)p 2040 5143 797 4 v
2044 5196 a Fa(2)2078 5228 y Fk(It)j(w)n(ould)h(also)h(b)r(e)e
(reasonable)i(to)e(pro)r(duce)g(a)h(function)f(of)h(t)n(yp)r(e)2040
5303 y Fe(\013)22 b Fn(!)f Fk(\()p Fe(\014)43 b Ff(option\))p
Fk(,)23 b(but)18 b(c)n(hec)n(king)h(the)g(return)g(v)l(alues)g(of)h
(recursiv)n(e)2040 5378 y(calls)27 b(for)g Ff(NONE)f
Fk(only)g(lengthens)g(the)f(example.)p eop
%%Page: 4 4
4 3 bop -152 -69 a Fk(and)26 b Fe(\014)k Fk(ha)n(v)n(e)25
b(b)r(een)g(determined)g(to)g(b)r(oth)h(b)r(e)f(to)h
Ff(int)q Fk(.)35 b(Casting)27 b(an)-152 19 y Ff(int)g
Fk(to)e(an)h Ff(int)g Fk(is)h(easy;)f(just)g(an)f(iden)n(tit)n(y)g
(function.)-152 193 y(In)34 b(the)h(second)f(branc)n(h)g(of)i(the)e
Ff(typecase)p Fk(,)39 b(b)r(oth)34 b Fe(\013)h Fk(and)g
Fe(\014)j Fk(are)-152 280 y(pro)r(duct)23 b(t)n(yp)r(es)g(\()p
Fe(\013)414 288 y Fa(1)461 280 y Fn(\002)12 b Fe(\013)582
288 y Fa(2)640 280 y Fk(and)23 b Fe(\014)830 288 y Fa(1)877
280 y Fn(\002)12 b Fe(\014)992 288 y Fa(2)1050 280 y
Fk(resp)r(ectiv)n(ely)23 b(\).)34 b(Through)-152 367
y(recursion,)g(w)n(e)d(can)h(cast)f(the)g(sub)r(comp)r(onen)n(ts)f(of)i
(the)f(t)n(yp)r(e)f(\()p Fe(\013)1806 375 y Fa(1)-152
454 y Fk(to)25 b Fe(\014)-16 462 y Fa(1)43 454 y Fk(and)f
Fe(\013)240 462 y Fa(2)299 454 y Fk(to)h Fe(\014)435
462 y Fa(2)469 454 y Fk(\).)34 b(Therefore,)27 b(to)d(cast)h(a)g(pro)r
(duct,)f(w)n(e)h(break)-152 542 y(it)h(apart,)g(cast)g(eac)n(h)f(comp)r
(onen)n(t)f(separately)-6 b(,)26 b(and)f(then)g(create)g(a)-152
629 y(new)h(pair.)-152 803 y(The)33 b(co)r(de)h(is)f(a)h(little)f
(di\013eren)n(t)g(for)h(the)e(next)g(branc)n(h,)j(when)e
Fe(\013)-152 890 y Fk(and)23 b Fe(\014)k Fk(are)d(b)r(oth)f(function)g
(t)n(yp)r(es,)g(due)g(to)g(con)n(tra)n(v)l(ariance.)35
b(Here,)-152 977 y(giv)n(en)j Ff(x)p Fk(,)k(a)d(function)f(from)g
Fe(\013)796 985 y Fa(1)869 977 y Fk(to)h Fe(\013)1025
985 y Fa(2)1060 977 y Fk(,)i(w)n(e)e(w)n(an)n(t)f(to)h(return)e(a)-152
1065 y(function)27 b(from)f Fe(\014)375 1073 y Fa(1)437
1065 y Fk(to)g Fe(\014)574 1073 y Fa(2)609 1065 y Fk(.)37
b(W)-6 b(e)26 b(can)h(apply)f(cast)h(to)g Fe(\013)1457
1073 y Fa(2)1518 1065 y Fk(and)f Fe(\014)1711 1073 y
Fa(2)1773 1065 y Fk(to)-152 1152 y(get)g(a)g(function,)g
Ff(g)p Fk(,)g(that)f(casts)i(the)e(result)h(t)n(yp)r(e,)f(and)g(comp)r
(ose)h Ff(g)-152 1239 y Fk(with)g(the)f(argumen)n(t)f
Ff(x)i Fk(to)g(get)f(a)h(function)g(from)f Fe(\013)1379
1247 y Fa(1)1439 1239 y Fk(to)h Fe(\014)1576 1247 y Fa(2)1611
1239 y Fk(.)34 b(Then)-152 1326 y(w)n(e)28 b(can)g(comp)r(ose)g(that)f
(resulting)h(function)g(with)g(a)f(rev)n(erse)h(cast)-152
1413 y(from)e Fe(\014)73 1421 y Fa(1)133 1413 y Fk(to)g
Fe(\013)276 1421 y Fa(1)337 1413 y Fk(to)f(get)h(a)g(function)g(from)g
Fe(\014)1148 1421 y Fa(1)1208 1413 y Fk(to)g Fe(\014)1345
1421 y Fa(2)1380 1413 y Fk(.)-152 1588 y(Finally)37 b(if)g(the)f(t)n
(yp)r(es)g(do)g(not)h(matc)n(h)e(w)n(e)i(raise)g(the)f(exception)-152
1675 y Ff(CantCast)p Fk(.)-152 1849 y(Ho)n(w)n(ev)n(er,)28
b(there)f(is)h(a)g(problem)f(with)g(this)h(solution.)40
b(In)n(tuitiv)n(ely)-6 b(,)-152 1936 y(all)25 b(a)f(cast)h(function)f
(should)g(do)g(at)g(run)f(time)g(is)i(recursiv)n(ely)f(com-)-152
2023 y(pare)g(the)f(t)n(w)n(o)h(t)n(yp)r(es.)33 b(But)24
b(unless)f(the)g(t)n(yp)r(es)g Fe(\034)1262 2031 y Fa(1)1320
2023 y Fk(and)g Fe(\034)1501 2031 y Fa(2)1559 2023 y
Fk(are)h(b)r(oth)-152 2111 y Ff(int)q Fk(,)40 b(the)d(result)g(of)44
b Ff(cast[)p Fe(\034)730 2119 y Fa(1)765 2111 y Ff(][)p
Fe(\034)877 2119 y Fa(2)912 2111 y Ff(])37 b Fk(do)r(es)h(m)n(uc)n(h)d
(more.)68 b(Ev)n(ery)-152 2198 y(pair)31 b(in)f(the)g(argumen)n(t)f(is)
h(brok)n(en)g(apart)g(and)g(remade,)h(and)f(ev-)-152
2285 y(ery)c(function)h(is)g(wrapp)r(ed)g(b)r(et)n(w)n(een)f(t)n(w)n(o)
h(instan)n(tiations)h(of)f(cast.)-152 2372 y(This)e(op)r(eration)f
(resem)n(bles)g(a)g(virus,)g(infecting)h(ev)n(ery)e(function)h(it)-152
2459 y(comes)29 b(in)g(con)n(tact)g(with)h(and)e(causing)i(needless)g
(w)n(ork)f(for)h(ev)n(ery)-152 2547 y(pro)r(duct.)-152
2721 y(The)20 b(reason)h(w)n(e)f(had)f(to)h(break)g(apart)g(the)f(pair)
h(in)g(forming)f(the)h(co-)-152 2808 y(ercion)i(function)f(for)h(pro)r
(duct)f(t)n(yp)r(es)f(is)i(that)e(all)j(w)n(e)e(had)g(a)n(v)l(ailable)
-152 2895 y(w)n(as)g(a)f(function)g(\(from)g Fe(\013)598
2903 y Fa(1)654 2895 y Fn(!)h Fe(\014)795 2903 y Fa(1)830
2895 y Fk(\))f(to)g(co)r(erce)h(the)e(\014rst)h(comp)r(onen)n(t)-152
2982 y(of)27 b(the)f(pair.)37 b(If)26 b(w)n(e)h(could)f(someho)n(w)h
(create)g(a)f(function)h(that)f(co-)-152 3070 y(erces)e(this)f(comp)r
(onen)n(t)f(while)i(it)g(w)n(as)g(still)g(a)f(part)g(of)h(the)f(pair,)h
(w)n(e)-152 3157 y(could)f(ha)n(v)n(e)f(applied)g(it)h(to)f(the)g(pair)
h(as)g(a)f(whole.)35 b(In)21 b(other)i(w)n(ords,)-152
3244 y(w)n(e)h(w)n(an)n(t)g(t)n(w)n(o)f(functions,)i(one)f(from)f(\()p
Fe(\013)1035 3252 y Fa(1)1082 3244 y Fn(\002)12 b Fe(\013)1203
3252 y Fa(2)1238 3244 y Fk(\))21 b Fn(!)h Fk(\()p Fe(\014)1461
3252 y Fa(1)1508 3244 y Fn(\002)12 b Fe(\013)1629 3252
y Fa(2)1664 3244 y Fk(\))23 b(and)-152 3331 y(one)j(from)g(\()p
Fe(\014)244 3339 y Fa(1)295 3331 y Fn(\002)17 b Fe(\013)421
3339 y Fa(2)456 3331 y Fk(\))k Fn(!)g Fk(\()p Fe(\014)678
3339 y Fa(1)730 3331 y Fn(\002)c Fe(\014)850 3339 y Fa(2)885
3331 y Fk(\).)-152 3583 y Fl(3.)100 b(SECOND)25 b(SOLUTION)-152
3674 y Fk(Motiv)l(ated)g(b)n(y)f(the)g(last)h(example,)f(w)n(e)h(w)n
(an)n(t)g(to)g(write)g(a)g(function)-152 3762 y(that)h(can)g(co)r(erce)
h(the)f(t)n(yp)r(e)f(of)55 b Fi(p)l(art)34 b Fk(of)27
b(its)f(argumen)n(t.)35 b(This)26 b(will)-152 3849 y(allo)n(w)j(us)d
(to)h(pass)g(the)f(same)h(v)l(alue)f(as)i(the)e Ff(x)h
Fk(argumen)n(t)e(for)j(eac)n(h)-152 3936 y(recursiv)n(e)i(call)i(and)d
(only)h(re\014ne)g(part)f(of)i(its)g(t)n(yp)r(e.)46 b(W)-6
b(e)30 b(can)g(not)-152 4023 y(eliminate)h Ff(x)f Fk(completely)-6
b(,)31 b(as)g(w)n(e)f(are)h(c)n(hanging)g(its)g(t)n(yp)r(e.)47
b(Since)-152 4110 y(w)n(e)34 b(w)n(an)n(t)f(to)h(cast)g(man)n(y)d
(parts)j(of)g(the)f(t)n(yp)r(e)f(of)40 b Ff(x)p Fk(,)c(w)n(e)e(need)f
(to)-152 4197 y(abstract)d(the)e(relationship)i(b)r(et)n(w)n(een)e(the)
h(t)n(yp)r(e)e(argumen)n(t)h(to)h(b)r(e)-152 4285 y(analyzed)d(and)g
(the)f(t)n(yp)r(e)g(of)32 b Ff(x)p Fk(.)-152 4459 y(The)h(solution)h
(in)e(Figure)i(2)f(de\014nes)f(a)h(help)r(er)g(function)72
b Ff(cast')-152 4546 y Fk(that)19 b(abstracts)i(not)e(just)h(the)f(t)n
(yp)r(es)g Fe(\013)g Fk(and)g Fe(\014)24 b Fk(for)c(analysis,)i(but)d
(an)-152 4633 y(additional)40 b Fi(typ)l(e)22 b(c)l(onstructor)759
4602 y Fa(3)816 4633 y Fk(argumen)n(t)17 b Fe(\015)t
Fk(.)32 b(When)18 b Fe(\015)k Fk(is)d(applied)-152 4721
y(to)31 b(the)e(t)n(yp)r(e)g Fe(\013)i Fk(w)n(e)f(get)g(the)g(t)n(yp)r
(e)f(of)76 b Ff(x)p Fk(,)32 b(when)e(it)g(is)g(applied)h(to)-152
4808 y Fe(\014)k Fk(w)n(e)d(get)f(the)f(return)g(t)n(yp)r(e)g(of)i(the)
f(cast.)50 b(F)-6 b(or)31 b(example,)h(if)g Fe(\015)i
Fk(is)-152 4895 y Fe(\025\016)s Fk(:)16 b Fn(\003)g Fe(:\016)j
Fn(\002)c Fe(\013)219 4903 y Fa(2)254 4895 y Fk(,)25
b(w)n(e)g(get)h(a)f(function)g(from)g(t)n(yp)r(e)f Fe(\013)16
b Fn(\002)f Fe(\013)1445 4903 y Fa(2)1505 4895 y Fk(to)25
b Fe(\014)19 b Fn(\002)d Fe(\013)1785 4903 y Fa(2)1820
4895 y Fk(.)p -152 4993 797 4 v -148 5047 a Fa(3)-113
5079 y Fk(W)-6 b(e)20 b(create)i(t)n(yp)r(e)e(constructors)i(with)f
Fe(\025)p Fk(-notation,)i(and)d(annotate)-152 5153 y(the)27
b(b)r(ound)f(v)l(ariable)h(with)g(its)56 b Fi(kind)p
Fk(.)39 b(Kinds)26 b(classify)j(t)n(yp)r(es)d(and)-152
5228 y(t)n(yp)r(e)i(constructors:)42 b Fn(\003)29 b Fk(is)h(the)e(kind)
g(of)i(t)n(yp)r(es,)g(and)e(if)i Fe(\024)1546 5236 y
Fa(1)1609 5228 y Fk(and)f Fe(\024)1806 5236 y Fa(2)-152
5303 y Fk(are)23 b(kinds,)g Fe(\024)239 5311 y Fa(1)296
5303 y Fn(!)e Fe(\024)438 5311 y Fa(2)495 5303 y Fk(is)i(the)g(the)f
(kind)f(of)j(t)n(yp)r(e)e(constructors)h(from)-152 5378
y Fe(\024)-108 5386 y Fa(1)-47 5378 y Fk(to)j Fe(\024)91
5386 y Fa(2)125 5378 y Fk(.)p 2040 -148 1993 4 v 2040
-28 a Ff(cast')40 b(:)g Fn(8)p Fe(\013;)13 b(\014)t Fk(:)18
b Fn(\003)f Fe(:)c Fn(8)p Fe(\015)t Fk(:)p Fn(\003)22
b(!)f(\003)p Fe(:)13 b Fk(\()p Fe(\015)21 b(\013)p Fk(\))h
Fn(!)f Fk(\()p Fe(\015)g(\014)t Fk(\))2040 59 y Ff(let)40
b(rec)g(cast')g(=)2119 146 y Fk(\003)p Fe(\013)p Fk(:)18
b Fn(\003)f Fe(:)c Fk(\003)p Fe(\014)t Fk(:)18 b Fn(\003)f
Fe(:)d Fk(\003)p Fe(\015)t Fk(:)p Fn(\003)22 b(!)f(\003)p
Fe(:)2197 234 y Ff(typecase)41 b([)p Fe(\016)2623 242
y Fa(1)2658 234 y Fe(;)52 b(\016)2765 242 y Fa(2)2800
234 y Fe(:)40 b Fk(\()p Fe(\015)j(\016)3008 242 y Fa(1)3042
234 y Fk(\))21 b Fn(!)h Fk(\()p Fe(\015)43 b(\016)3339
242 y Fa(2)3373 234 y Fk(\))p Ff(]\()p Fe(\013;)14 b(\014)t
Ff(\))40 b(of)2315 321 y(\(int,)g(int\))g(=>)2393 408
y(fn)g(\(x:)p Fe(\015)k Ff(int\))c(=>)f(x)2236 495 y(|)h(\()p
Fe(\013)2403 503 y Fa(1)2455 495 y Fn(\002)17 b Fe(\013)2581
503 y Fa(2)2615 495 y Fe(;)d(\014)2693 503 y Fa(1)2744
495 y Fn(\002)j Fe(\014)2864 503 y Fa(2)2899 495 y Ff(\))40
b(=>)2393 582 y(let)g(val)g(f)f(=)h(cast'[)p Fe(\013)3147
590 y Fa(1)3183 582 y Ff(][)p Fe(\014)3304 590 y Fa(1)3339
582 y Ff(][)p Fe(\025\016)s Fk(:)18 b Fn(\003)f Fe(:)40
b(\015)t Fk(\()p Fe(\016)20 b Fn(\002)c Fe(\013)3907
590 y Fa(2)3942 582 y Fk(\))p Ff(])2550 669 y(val)40
b(g)f(=)h(cast'[)p Fe(\013)3147 677 y Fa(2)3183 669 y
Ff(][)p Fe(\014)3304 677 y Fa(2)3339 669 y Ff(][)p Fe(\025\016)s
Fk(:)18 b Fn(\003)f Fe(:)40 b(\015)t Fk(\()p Fe(\014)3771
677 y Fa(1)3823 669 y Fn(\002)16 b Fe(\016)s Fk(\))p
Ff(])2393 757 y(in)2472 844 y(fn)39 b(\(x:)p Fe(\015)t
Fk(\()p Fe(\013)2829 852 y Fa(1)2882 844 y Fn(\002)16
b Fe(\013)3007 852 y Fa(2)3042 844 y Fk(\))p Ff(\))40
b(=>)2550 931 y(g)g(\(f)f(x\))2393 1018 y(end)2236 1105
y(|)h(\()p Fe(\013)2403 1113 y Fa(1)2459 1105 y Fn(!)21
b Fe(\013)2606 1113 y Fa(2)2641 1105 y Fe(;)13 b(\014)2718
1113 y Fa(1)2774 1105 y Fn(!)21 b Fe(\014)2915 1113 y
Fa(2)2950 1105 y Ff(\))40 b(=>)2393 1192 y(let)g(val)g(f)f(=)h(cast'[)p
Fe(\013)3147 1200 y Fa(1)3183 1192 y Ff(][)p Fe(\014)3304
1200 y Fa(1)3339 1192 y Ff(][)p Fe(\025\016)s Fk(:)16
b Fn(\003)f Fe(:)40 b(\015)t Fk(\()p Fe(\016)24 b Fn(!)d
Fe(\013)3929 1200 y Fa(2)3964 1192 y Fk(\))p Ff(])2550
1280 y(val)40 b(g)f(=)h(cast'[)p Fe(\013)3147 1288 y
Fa(2)3183 1280 y Ff(][)p Fe(\014)3304 1288 y Fa(2)3339
1280 y Ff(][)p Fe(\025\016)s Fk(:)18 b Fn(\003)f Fe(:)40
b(\015)t Fk(\()p Fe(\014)3771 1288 y Fa(1)3827 1280 y
Fn(!)21 b Fe(\016)s Fk(\))p Ff(])2393 1367 y(in)2472
1454 y(fn)39 b(\(x:)p Fe(\015)t Fk(\()p Fe(\013)2829
1462 y Fa(1)2886 1454 y Fn(!)21 b Fe(\013)3033 1462 y
Fa(2)3068 1454 y Fk(\))p Ff(\))39 b(=>)2550 1541 y(g)h(\(f)f(x\))2393
1628 y(end)2236 1715 y(|)h(\()p 2359 1715 24 4 v 28 w(,)p
2426 1715 V 29 w(\))f(=>)h(raise)g(CantCast)2532 1966
y Fj(Figure)30 b(2:)39 b(Second)30 b(Solution)p 2040
2016 1993 4 v 2040 2244 a Fk(Since)e(w)n(e)g(abstract)g(b)r(oth)g(t)n
(yp)r(es)f(and)g(t)n(yp)r(e)g(constructors,)i(in)f(the)2040
2332 y(de\014nition)e(of)h(cast)g(w)n(e)f(annotate)h
Fe(\013)p Fk(,)g Fe(\014)t Fk(,)f(and)g Fe(\015)k Fk(with)d(their)f
(kinds.)2040 2419 y(As)e Fe(\013)g Fk(and)f Fe(\014)28
b Fk(are)c(t)n(yp)r(es,)g(they)f(are)i(annotated)e(with)h(kind)63
b Fn(\003)p Fk(,)24 b(but)2040 2506 y Fe(\015)j Fk(is)d(a)g(function)f
(from)g(t)n(yp)r(es)g(to)g(t)n(yp)r(es,)h(and)f(so)g(has)h(kind)e
Fn(\003)40 b(!)f(\003)p Fk(.)2040 2593 y(W)-6 b(e)25
b(initially)i(call)g Ff(cast')g Fk(with)f(the)f(iden)n(tit)n(y)g
(function.)2040 2839 y Ff(let)40 b(cast)g(=)2197 2926
y Fk(\003)p Fe(\013)p Fk(:)18 b Fn(\003)f Fe(:)d Fk(\003)p
Fe(\014)t Fk(:)j Fn(\003)h Fe(:)40 b Ff(cast')p Fk([)p
Fe(\013)p Fk(][)p Fe(\014)t Fk(][)p Fe(\025\016)s Fk(:)20
b Fn(\003)d Fe(:\016)s Fk(])2040 3171 y(With)26 b(the)g(recursiv)n(e)h
(call)g(to)g Ff(cast')p Fk(,)h(in)e(the)g(branc)n(h)g(for)h(pro)r(duct)
2040 3258 y(t)n(yp)r(es)21 b(w)n(e)h(create)h(a)f(function)f(to)h(cast)
g(the)g(\014rst)f(comp)r(onen)n(t)g(of)h(the)2040 3346
y(tuple)i(\(con)n(v)n(erting)g Fe(\013)2686 3354 y Fa(1)2745
3346 y Fk(to)h Fe(\014)2881 3354 y Fa(1)2916 3346 y Fk(\))f(b)n(y)f
(supplying)h(the)g(t)n(yp)r(e)g(construc-)2040 3433 y(tor)30
b Fe(\025\016)s Fk(:)19 b Fn(\003)h Fe(:\015)t Fk(\()p
Fe(\016)j Fn(\002)c Fe(\013)2628 3441 y Fa(2)2663 3433
y Fk(\))29 b(for)h Fe(\015)t Fk(.)45 b(As)29 b Ff(x)h
Fk(is)f(of)i(t)n(yp)r(e)d Fe(\015)t Fk(\()p Fe(\013)3610
3441 y Fa(1)3664 3433 y Fn(\002)19 b Fe(\013)3792 3441
y Fa(2)3827 3433 y Fk(\),)30 b(this)2040 3520 y(application)e(results)g
(in)f(something)g(of)h(t)n(yp)r(e)e Fe(\015)t Fk(\()p
Fe(\014)3524 3528 y Fa(1)3577 3520 y Fn(\002)18 b Fe(\013)3704
3528 y Fa(2)3739 3520 y Fk(\).)38 b(In)27 b(the)2040
3607 y(next)19 b(recursiv)n(e)g(call,)k(for)d(the)f(second)h(comp)r
(onen)n(t)e(of)i(the)g(pair,)h(the)2040 3694 y(\014rst)d(comp)r(onen)n
(t)f(is)i(already)g(of)g(t)n(yp)r(e)f Fe(\014)3199 3702
y Fa(2)3234 3694 y Fk(,)i(so)f(the)f(t)n(yp)r(e)f(constructor)2040
3782 y(argumen)n(t)25 b(re\015ects)h(that)f(fact.)2040
3956 y(Surprisingly)-6 b(,)45 b(the)c(branc)n(h)g(for)h(comparing)f
(function)g(t)n(yp)r(es)g(is)2040 4043 y(analogous)f(to)f(that)f(of)h
(pro)r(ducts.)72 b(W)-6 b(e)38 b(co)r(erce)i(the)e(argumen)n(t)2040
4130 y(t)n(yp)r(e)27 b(of)h(the)f(function)g(in)g(the)g(same)g(manner)f
(as)i(w)n(e)g(co)r(erced)g(the)2040 4217 y(\014rst)36
b(comp)r(onen)n(t)f(of)h(the)g(tuple;)41 b(calling)d
Ff(cast')f Fk(recursiv)n(ely)f(to)2040 4305 y(pro)r(duce)31
b(a)h(function)g(to)f(cast)h(from)g(t)n(yp)r(e)e Fe(\015)t
Fk(\()p Fe(\013)3467 4313 y Fa(1)3533 4305 y Fn(!)h Fe(\013)3690
4313 y Fa(2)3725 4305 y Fk(\))g(to)g(t)n(yp)r(e)2040
4392 y Fe(\015)t Fk(\()p Fe(\014)2157 4400 y Fa(1)2213
4392 y Fn(!)21 b Fe(\013)2360 4400 y Fa(2)2395 4392 y
Fk(\).)34 b(A)23 b(second)i(recursiv)n(e)f(call)h(handles)f(the)g
(result)g(t)n(yp)r(e)2040 4479 y(of)j(the)e(function.)2040
4676 y Fl(4.)99 b(HASKELL)2040 4767 y Fk(The)35 b(language)h(Hask)n
(ell)f([13])h(pro)n(vides)f(a)g(di\013eren)n(t)f(form)h(of)h(ad)2040
4855 y(ho)r(c)24 b(p)r(olymorphism,)g(through)f(the)h(use)g(of)h(t)n
(yp)r(e)e(classes.)36 b(Instead)2040 4942 y(of)22 b(de\014ning)e(one)h
(function)g(that)f(b)r(eha)n(v)n(es)g(di\013eren)n(tly)h(for)g
(di\013eren)n(t)2040 5029 y(t)n(yp)r(es,)g(Hask)n(ell)f(allo)n(ws)h(y)n
(ou)e(to)h(de\014ne)f(sev)n(eral)h(functions)g(with)g(the)2040
5116 y(same)26 b(name)e(that)i(di\013er)f(in)h(their)g(t)n(yp)r(es.)
2040 5290 y(F)-6 b(or)26 b(example,)f(the)g(Hask)n(ell)i(standard)e
(prelude)h(de\014nes)f(the)g(class)2040 5378 y(of)20
b(t)n(yp)r(es)e(that)h(supp)r(ort)f(a)i(con)n(v)n(ersion)f(to)g(a)g
(string)h(represen)n(tation.)p eop
%%Page: 5 5
5 4 bop -152 -69 a Fk(This)27 b(class)g(is)f(declared)g(b)n(y)-152
136 y Ff(class)41 b(Show)f Fe(\013)f Ff(where)-73 223
y(show)h(::)g Fe(\013)f Fn(!)g Ff(string)-152 427 y Fk(This)25
b(declaration)g(states)g(that)e(the)h(t)n(yp)r(e)f Fe(\013)h
Fk(is)g(in)g(the)f(class)65 b Ff(Show)-152 514 y Fk(if)39
b(there)e(is)i(some)e(function)h(named)f Ff(show)h Fk(de\014ned)f(for)i
(t)n(yp)r(e)e Fe(\013)-152 602 y Fn(!)i Ff(string)p Fk(.)j(W)-6
b(e)27 b(can)g(de\014ne)g Ff(show)h Fk(for)h(in)n(tegers)f(with)g(a)f
(built-in)-152 689 y(primitiv)n(e)e(b)n(y)-152 893 y
Ff(instance)41 b(Show)g(int)e(where)-73 980 y(show)h(x)f(=)h
(primIntToString)i(x)-152 1185 y Fk(W)-6 b(e)27 b(can)g(also)h
(de\014ne)e Ff(show)h Fk(for)h(t)n(yp)r(e)e(constructors)h(lik)n(e)g
(pro)r(duct.)-152 1272 y(In)c(order)h(to)g(con)n(v)n(ert)g(a)g(pro)r
(duct)f(to)h(a)g(string)g(w)n(e)g(need)g(to)g(b)r(e)f(able)-152
1359 y(to)j Ff(show)g Fk(eac)n(h)g(comp)r(onen)n(t)e(of)i(the)f(pro)r
(duct.)34 b(Hask)n(ell)26 b(allo)n(ws)h(y)n(ou)-152 1446
y(to)37 b(express)f(these)h(conditions)g(in)f(the)g(instan)n(tiation)h
(of)g(a)g(t)n(yp)r(e)-152 1533 y(constructor:)-152 1738
y Ff(instance)k(\(Show)g Fe(\013)p Ff(,)e(Show)i Fe(\014)t
Ff(\))e(=>)h(Show)g(\()p Fe(\013;)14 b(\014)t Ff(\))39
b(where)-73 1825 y(show)h(\(a,b\))g(=)g("\(")g(++)f(show)h(a)g(++)g
(",")g(++)f(show)h(b)g("\)".)-152 2029 y Fk(This)28 b(co)r(de)f
(declares)i(that)d(as)i(long)g(as)f Fe(\013)g Fk(and)g
Fe(\014)k Fk(are)d(mem)n(b)r(ers)d(of)-152 2117 y(the)e(class)i
Ff(Show)p Fk(,)g(then)e(their)g(pro)r(duct)g(\(Hask)n(ell)h(uses)f
Ff(,)h Fk(instead)g(of)-152 2204 y Fn(\002)30 b Fk(for)h(pro)r(duct\))f
(is)h(a)g(mem)n(b)r(er)d(of)j(class)71 b Ff(Show)p Fk(.)49
b(Consequen)n(tly)-6 b(,)-152 2291 y(the)36 b(function)g
Ff(show)g Fk(for)h(pro)r(ducts)f(is)g(de\014ned)f(in)g(terms)h(of)g
(the)-152 2378 y Ff(show)27 b Fk(functions)f(for)g(its)g(sub)r(comp)r
(onen)n(ts.)-152 2563 y Fl(4.1)99 b(First)25 b(Solution)g(in)g(Hask)o
(ell)-152 2654 y Fk(Co)r(ding)f(the)f(cast)h(example)e(in)h(Hask)n(ell)
h(is)f(a)h(little)g(tric)n(ky)e(b)r(ecause)-152 2741
y(of)31 b(the)f(t)n(w)n(o)h(nested)f Ff(typecase)i Fk(terms)d(\(hidden)
h(b)n(y)f(the)h(pattern-)-152 2828 y(matc)n(hing)g(syn)n(tax\).)48
b(F)-6 b(or)30 b(this)h(reason)g(w)n(e)g(will)h(de\014ne)e(t)n(w)n(o)h
(t)n(yp)r(e)-152 2915 y(classes)k(|)d(one)h(called)g
Ff(CF)g Fk(\(for)h(Cast)f(F)-6 b(rom\))32 b(that)g(corresp)r(onds)-152
3003 y(to)g(the)f(outer)71 b Ff(typecase)p Fk(,)35 b(and)c(the)h(other)
f(called)i Ff(CT)f Fk(\(for)g(Cast)-152 3090 y(T)-6 b(o\))36
b(that)f(will)i(implemen)n(t)c(all)j(of)g(the)f(inner)g
Ff(typecase)p Fk(s.)66 b(The)-152 3177 y(\014rst)22 b(class)h(just)f
(de\014nes)f(the)h(cast)g(function,)h(but)e(the)g(second)h(class)-152
3264 y(needs)f(to)f(include)h(three)f(functions,)i(describing)g(ho)n(w)
e(to)h(complete)-152 3351 y(the)28 b(cast)g(using)g(the)g(kno)n(wledge)
g(that)g(the)f(\014rst)h(t)n(yp)r(e)f(w)n(as)h(an)g(in-)-152
3438 y(teger,)h(pro)r(duct,)f(or)g(function.)41 b(Note)27
b(the)g(con)n(tra)n(v)l(ariance)i(in)e(the)-152 3526
y(t)n(yp)r(e)j(of)37 b Ff(doFn)31 b Fk(b)r(elo)n(w:)45
b(Because)31 b(w)n(e)g(will)h(ha)n(v)n(e)d(to)i(cast)g(from)f
Fe(\014)1806 3534 y Fa(1)-152 3613 y Fk(to)c Fe(\013)-9
3621 y Fa(1)26 3613 y Fk(,)g(w)n(e)g(need)f Fe(\013)414
3621 y Fa(1)475 3613 y Fk(to)h(b)r(e)f(in)h(the)f(class)i
Ff(CT)f Fk(instead)g(of)32 b Ff(CF)p Fk(.)-152 3826 y
Ff(class)41 b(CF)e Fe(\013)h Ff(where)-73 3914 y(cast)g(::)g(CT)f
Fe(\014)44 b Ff(=>)39 b Fe(\013)h Fn(!)f Fe(\014)-152
4001 y Ff(class)i(CT)e Fe(\014)44 b Ff(where)-73 4088
y(doInt)79 b(::)40 b(Int)g Fn(!)f Fe(\014)-73 4175 y
Ff(doProd)h(::)g(\(CF)g Fe(\013)525 4183 y Fa(1)560 4175
y Ff(,)f(CF)h Fe(\013)805 4183 y Fa(2)840 4175 y Ff(\))f(=>)h(\()p
Fe(\013)1124 4183 y Fa(1)1159 4175 y Fe(;)52 b(\013)1281
4183 y Fa(2)1316 4175 y Ff(\))40 b Fn(!)f Fe(\014)-73
4262 y Ff(doFn)118 b(::)40 b(\(CT)g Fe(\013)525 4270
y Fa(1)560 4262 y Ff(,)f(CF)h Fe(\013)805 4270 y Fa(2)840
4262 y Ff(\))f(=>)h(\()p Fe(\013)1124 4270 y Fa(1)1180
4262 y Fn(!)21 b Fe(\013)1327 4270 y Fa(2)1362 4262 y
Ff(\))40 b Fn(!)f Fe(\014)-152 4476 y Fk(Just)32 b(as)g(in)g
Fe(\025)263 4444 y Fc(ML)263 4490 y Fb(i)355 4476 y Fk(,)i(where)e(the)
f(outer)h Ff(typecase)h Fk(led)f(to)f(an)h(inner)-152
4563 y Ff(typecase)27 b Fk(in)f(eac)n(h)f(branc)n(h,)g(the)g(separate)i
(instances)f(of)g(the)f(\014rst)-152 4650 y(class)20
b(just)f(dispatc)n(h)f(to)g(the)g(second,)i(marking)e(the)g(head)g
(construc-)-152 4737 y(tor)26 b(of)h(the)e(\014rst)g(t)n(yp)r(e)g(b)n
(y)g(the)g(function)h(called:)-152 4942 y Ff(instance)41
b(CF)f(Int)g(where)5 5029 y(cast)g(=)g(doInt)-152 5116
y(instance)h(\(CF)f Fe(\013)p Ff(,)g(CF)g Fe(\014)t Ff(\))f(=>)h(CF)g
(\()p Fe(\013)p Ff(,)g Fe(\014)t Ff(\))f(where)5 5203
y(cast)h(=)g(doProd)-152 5290 y(instance)h(\(CT)f Fe(\013)p
Ff(,)g(CF)g Fe(\014)t Ff(\))f(=>)h(CF)g(\()p Fe(\013)p
Fn(!)p Fe(\014)t Ff(\))g(where)5 5378 y(cast)g(=)g(doFn)2040
-69 y Fk(The)24 b(instances)h(of)f(the)f(second)h(t)n(yp)r(e)f(class)i
(either)f(implemen)n(t)e(the)2040 19 y(branc)n(h)30 b(\(if)g(the)g(t)n
(yp)r(es)g(matc)n(h\))e(or)j(signal)g(an)f(error.)49
b(In)29 b(the)h Ff(Int)2040 106 y Fk(instance)24 b(of)31
b Ff(CT)p Fk(,)25 b(the)e Ff(doInt)i Fk(function)f(is)h(an)f(iden)n
(tit)n(y)f(function)h(as)2040 193 y(b)r(efore,)j(while)g(the)e(others)h
(pro)r(duce)f(the)h(error)65 b Ff("CantCast")p Fk(.)2040
443 y Ff(instance)41 b(CT)f(Int)g(where)2197 530 y(doInt)g(x)g(=)f(x)
2197 617 y(doProd)i(x)e(=)h(error)g("CantCast")2197 704
y(doFn)g(x)g(=)f(error)h("CantCast")2040 954 y Fk(The)32
b Ff(doProd)h Fk(function)f(of)h(the)f(pro)r(duct)f(instance)h(should)g
(b)r(e)g(of)2040 1041 y(t)n(yp)r(e)51 b Ff(\(CF)40 b
Fe(\013)2445 1049 y Fa(1)2480 1041 y Ff(,)f(CF)h Fe(\013)2725
1049 y Fa(2)2760 1041 y Ff(\))f(=>)h(\()p Fe(\013)3044
1049 y Fa(1)3079 1041 y Ff(,)g Fe(\013)3207 1049 y Fa(2)3241
1041 y Ff(\))g Fn(!)f Ff(\()p Fe(\014)3518 1049 y Fa(1)3553
1041 y Ff(,)g Fe(\014)3674 1049 y Fa(2)3709 1041 y Ff(\))p
Fk(.)114 b(This)2040 1128 y(function)32 b(calls)g Ff(cast)h
Fk(recursiv)n(ely)e(on)h Ff(x)f Fk(and)g Ff(y)p Fk(,)j(the)d(sub)r
(comp)r(o-)2040 1215 y(nen)n(ts)k(of)h(the)f(pro)r(duct)g(\(tak)n(en)g
(apart)h(via)f(pattern)g(matc)n(hing\).)2040 1302 y(As)27
b(the)f(t)n(yp)r(es)g(of)34 b Ff(x)27 b Fk(and)f Ff(y)h
Fk(are)g Fe(\013)3047 1310 y Fa(1)3109 1302 y Fk(and)f
Fe(\013)3308 1310 y Fa(2)3343 1302 y Fk(,)h(and)g(w)n(e)g(are)g(allo)n
(w)n(ed)2040 1390 y(to)h(assume)f(they)g(are)h(in)f(the)h(class)g
Ff(CF)40 b Fk(,)28 b(w)n(e)g(can)g(call)g Ff(cast)p Fk(.)41
b(The)2040 1477 y(declaration)30 b(of)75 b Ff(cast)29
b Fk(requires)g(that)g(its)g(result)g(t)n(yp)r(e)f(b)r(e)g(in)h(the)
2040 1564 y(class)e Ff(CT)p Fk(,)f(so)g(w)n(e)g(require)f(that)g
Fe(\014)3019 1572 y Fa(1)3079 1564 y Fk(and)g Fe(\014)3271
1572 y Fa(2)3332 1564 y Fk(b)r(e)g(in)g(the)g(class)i
Ff(CT)f Fk(for)2040 1651 y(this)g(instan)n(tiation.)2040
1901 y Ff(instance)41 b(\(CT)f Fe(\014)2593 1909 y Fa(1)2628
1901 y Ff(,)f(CT)h Fe(\014)2867 1909 y Fa(2)2902 1901
y Ff(\))f(=>)h(CT)g(\()p Fe(\014)3298 1909 y Fa(1)3333
1901 y Ff(,)f Fe(\014)3454 1909 y Fa(2)3489 1901 y Ff(\))h(where)2197
1988 y(doInt)g(x)g(=)f(error)i("CantCast")2197 2075 y(doProd)g(\(x,y\))
f(=)f(\(cast)i(x,)79 b(cast)40 b(y\))2197 2162 y(doFn)g(x)g(=)f(error)h
("CantCast")2040 2412 y Fk(Finally)-6 b(,)37 b(in)d(the)g(instance)g
(for)h(the)f(function)h(t)n(yp)r(e)e(constructor,)2040
2499 y Ff(doFn)19 b Fk(needs)f(to)g(wrap)g(its)g(argumen)n(t)f(in)h
(recursiv)n(e)g(calls)h(to)f Ff(cast)p Fk(,)j(as)2040
2586 y(in)g(the)g(\014rst)g Fe(\025)2452 2555 y Fc(ML)2452
2600 y Fb(i)2566 2586 y Fk(solution.)34 b(As)21 b(the)g(t)n(yp)r(e)f
(of)i(this)f(function)h(should)2040 2674 y(b)r(e)57 b
Ff(\(CT)40 b Fe(\013)2382 2682 y Fa(1)2417 2674 y Ff(,)g(CF)f
Fe(\013)2662 2682 y Fa(2)2697 2674 y Ff(\))h(=>)f(\()p
Fe(\013)2981 2682 y Fa(1)3056 2674 y Fn(!)g Fe(\013)3221
2682 y Fa(2)3255 2674 y Ff(\))h Fn(!)f Ff(\()p Fe(\014)3532
2682 y Fa(1)3606 2674 y Fn(!)g Fe(\014)3765 2682 y Fa(2)3800
2674 y Ff(\))p Fk(,)66 b(the)2040 2761 y(t)n(yp)r(e)31
b(of)i(the)f(argumen)n(t)f Ff(x)i Fk(is)g(of)f(a)h(function)f(of)h(t)n
(yp)r(e)f Fe(\013)3752 2769 y Fa(1)3819 2761 y Fn(!)f
Fe(\013)3976 2769 y Fa(2)4011 2761 y Fk(.)2040 2848 y(T)-6
b(o)25 b Ff(cast)g Fk(the)e(result)i(of)g(this)f(function,)h(w)n(e)g
(need)e(the)h Fe(\013)3700 2856 y Fa(2)3759 2848 y Fk(instance)2040
2935 y(of)32 b Ff(CF)p Fk(,)27 b(that)e(requires)h(that)f
Fe(\014)2923 2943 y Fa(2)2983 2935 y Fk(b)r(e)h(in)f(the)g(class)i
Ff(CT)p Fk(.)f(Ho)n(w)n(ev)n(er,)g(w)n(e)2040 3022 y(w)n(ould)h(also)g
(lik)n(e)f(to)g Ff(cast)h Fk(the)f(argumen)n(t)f(of)i(the)f(function)g
(in)g(the)2040 3110 y(opp)r(osite)i(direction,)g(from)f
Fe(\014)2916 3118 y Fa(1)2977 3110 y Fk(to)g Fe(\013)3121
3118 y Fa(1)3156 3110 y Fk(.)38 b(Therefore)29 b(w)n(e)e(need)g
Fe(\014)3903 3118 y Fa(1)3964 3110 y Fk(to)2040 3197
y(b)r(e)22 b(in)f(the)h(class)h Ff(CF)p Fk(,)f(and)g
Fe(\013)2847 3205 y Fa(1)2903 3197 y Fk(to)g(b)r(e)g(in)f(the)h(class)h
Ff(CT)p Fk(.)f(The)g(instance)2040 3284 y(for)27 b(function)g(t)n(yp)r
(es)e(is)i(then)f(\(Hask)n(ell)g(uses)h Ff(f)39 b(.)79
b(g)26 b Fk(for)h(function)2040 3371 y(comp)r(osition\))2040
3621 y Ff(instance)41 b(\(CF)f Fe(\014)2593 3629 y Fa(1)2628
3621 y Ff(,)f(CT)h Fe(\014)2867 3629 y Fa(2)2902 3621
y Ff(\))f(=>)h(CT)g(\()p Fe(\014)3298 3629 y Fa(1)3333
3621 y Fn(!)p Fe(\014)3453 3629 y Fa(2)3488 3621 y Ff(\))f(where)2197
3708 y(doInt)h(x)g(=)f(error)i("CantCast")2197 3795 y(doProd)g(x)e(=)h
(error)g("CantCast")2197 3882 y(doFn)g(x)g(=)f(cast)h(.)g(x)f(.)h(cast)
2040 4132 y Fk(No)n(w)30 b(with)g(these)g(de\014nitions)g(w)n(e)g(can)g
(de\014ne)f(the)g(sym)n(b)r(ol)g(table)2040 4219 y(using)36
b(an)g(existen)n(tial)h(t)n(yp)r(e)d(to)i(hide)g(the)f(t)n(yp)r(e)g(of)
i(the)e(elemen)n(t)2040 4306 y(in)23 b(the)g(table.)34
b(Though)24 b(not)f(in)g(the)g(curren)n(t)g(language)i(de\014nition,)
2040 4393 y(sev)n(eral)19 b(implemen)n(tations)f(of)h(Hask)n(ell)g
(supp)r(ort)f(existen)n(tial)h(t)n(yp)r(es.)2040 4481
y(Existen)n(tial)37 b(t)n(yp)r(es)f(in)h(Hask)n(ell)g(are)g(denoted)e
(with)i(the)f Ff(forall)2040 4568 y Fk(k)n(eyw)n(ord)30
b(as)h(the)g(data)g(constructors)g(that)f(carry)h(them)e(ma)n(y)h(b)r
(e)2040 4655 y(instan)n(tiated)c(with)g(an)n(y)f(t)n(yp)r(e.)2040
4929 y Ff(data)40 b(EntryT)h(=)e(forall)i Fe(\013)e Ff(.)h(CF)g
Fe(\013)f Ff(=>)79 b(Entry)40 b(String)h Fe(\013)2040
5016 y Ff(type)f(table)h(=)e([)h(EntryT)g(])2040 5290
y Fk(The)g Ff(find)g Fk(function)f(is)h(v)n(ery)e(similar)i(to)f(b)r
(efore,)44 b(except)39 b(that)2040 5378 y(Hask)n(ell)26
b(infers)g(that)f(the)f(existen)n(tial)i(t)n(yp)r(e)f(should)g(b)r(e)g
(unpac)n(k)n(ed.)p eop
%%Page: 6 6
6 5 bop -152 -69 a Ff(find)40 b(::)79 b(CT)40 b Fe(\013)g
Ff(=>)f(table)i Fn(!)e Ff(String)h Fn(!)f Fe(\013)-152
19 y Ff(find)h(\()g(\(Entry)h(s2)e(val\))h(:)g(rest)g(\))f(s1)h(=)123
106 y(if)g(s1)f(==)h(s2)g(then)201 193 y(cast)h(val)123
280 y(else)f(find)g(rest)g(s1)-152 367 y(find)g([])g(s)g(=)f(error)h
("Not)h(in)e(List")-152 569 y Fl(4.2)99 b(Second)27 b(Solution)e(in)g
(Hask)o(ell)-152 661 y Fk(T)-6 b(o)40 b(implemen)n(t)c(the)j(second)g
(v)n(ersion)g(in)g(Hask)n(ell,)k(w)n(e)c(need)g(to)-152
748 y(c)n(hange)21 b(the)g(t)n(yp)r(e)e(of)j(cast)f(to)g(abstract)g
(the)g(t)n(yp)r(e)e(constructor)j Fe(\015)i Fk(as)-152
835 y(w)n(ell)k(as)g Fe(\013)f Fk(and)f Fe(\014)t Fk(.)38
b(This)28 b(addition)f(leads)g(to)g(the)g(new)g(de\014nitions)-152
922 y(of)i Ff(CT)23 b Fk(and)f Ff(CF)p Fk(.)h(Note)g(that)f(in)g(the)g
(t)n(yp)r(e)g(of)29 b Ff(doFn)p Fk(,)24 b Fe(\013)1378
930 y Fa(1)1435 922 y Fk(should)f(b)r(e)f(in)-152 1009
y(the)f(class)h Ff(CF)f Fk(instead)h(of)f(the)g(class)h
Ff(CT)p Fk(,)g(re\015ecting)f(that)g(w)n(e)g(are)g(go-)-152
1097 y(ing)i(to)f(a)n(v)n(oid)h(the)e(con)n(tra)n(v)l(arian)n(t)i(cast)
g(of)g(the)e(function)i(argumen)n(t)-152 1184 y(that)j(w)n(e)g(needed)f
(in)g(the)h(previous)f(solution.)-152 1419 y Ff(class)41
b(CF)e Fe(\013)h Ff(where)-34 1507 y(cast')g(::)g(CT)g
Fe(\014)j Ff(=>)d Fe(\015)j(\013)c Fn(!)g Fe(\015)44
b(\014)-152 1594 y Ff(class)d(CT)e Fe(\014)44 b Ff(where)-34
1681 y(doInt)80 b(::)39 b Fe(\015)k Ff(Int)d Fn(!)f Fe(\015)44
b(\014)-34 1768 y Ff(doProd)d(::)e(\(CF)h Fe(\013)564
1776 y Fa(1)599 1768 y Ff(,)f(CF)h Fe(\013)844 1776 y
Fa(2)879 1768 y Ff(\))f(=>)476 1855 y Fe(\015)k Ff(\()p
Fe(\013)647 1863 y Fa(1)682 1855 y Ff(,)d Fe(\013)810
1863 y Fa(2)844 1855 y Ff(\))g Fn(!)f Fe(\015)k(\014)-34
1942 y Ff(doFn)119 b(::)39 b(\(CF)h Fe(\013)564 1950
y Fa(1)599 1942 y Ff(,)f(CF)h Fe(\013)844 1950 y Fa(2)879
1942 y Ff(\))f(=>)476 2030 y Fe(\015)k Ff(\()p Fe(\013)647
2038 y Fa(1)682 2030 y Fn(!)p Fe(\013)808 2038 y Fa(2)843
2030 y Ff(\))c Fn(!)g Fe(\015)k(\014)-152 2265 y Fk(The)23
b(instances)h(for)f Ff(CF)g Fk(remain)g(the)f(same)h(as)g(b)r(efore,)i
(dispatc)n(hing)-152 2352 y(to)34 b(the)e(appropriate)i(functions.)57
b(Also)34 b(the)e(instance)i Ff(CT)40 b(Int)33 b Fk(is)-152
2440 y(still)f(the)e(iden)n(tit)n(y)g(function.)49 b(But)30
b(recall)i(the)e(branc)n(h)g(for)h(pro)r(d-)-152 2527
y(ucts:)-152 2762 y Ff(typecase)41 b(\()p Fe(\013;)14
b(\014)t Ff(\))40 b(of)-34 2850 y(...)-34 2937 y(|)f(\()p
Fe(\013)132 2945 y Fa(1)185 2937 y Fn(\002)16 b Fe(\013)310
2945 y Fa(2)345 2937 y Fe(;)d(\014)422 2945 y Fa(1)474
2937 y Fn(\002)k Fe(\014)594 2945 y Fa(2)629 2937 y Ff(\))39
b(=>)123 3024 y(let)h(val)g(f)f(=)h(cast'[)p Fe(\013)877
3032 y Fa(1)913 3024 y Ff(][)p Fe(\014)1034 3032 y Fa(1)1069
3024 y Ff(][)p Fe(\025\016)s Fk(:)18 b Fn(\003)f Fe(:)40
b(\015)t Fk(\()p Fe(\016)19 b Fn(\002)e Fe(\013)1637
3032 y Fa(2)1672 3024 y Fk(\))p Ff(])280 3111 y(val)40
b(g)f(=)h(cast'[)p Fe(\013)877 3119 y Fa(2)913 3111 y
Ff(][)p Fe(\014)1034 3119 y Fa(2)1069 3111 y Ff(][)p
Fe(\025\016)s Fk(:)18 b Fn(\003)f Fe(:)40 b(\015)t Fk(\()p
Fe(\014)1501 3119 y Fa(1)1552 3111 y Fn(\002)17 b Fe(\016)s
Fk(\))p Ff(])123 3198 y(in)201 3285 y(fn)40 b(\(x:)p
Fe(\015)t Fk(\()p Fe(\013)559 3293 y Fa(1)611 3285 y
Fn(\002)17 b Fe(\013)737 3293 y Fa(2)772 3285 y Fk(\))p
Ff(\))39 b(=>)280 3373 y(g)g(\(f)h(x\))123 3460 y(end)-152
3695 y Fk(The)20 b(strategy)g(w)n(as)h(to)e(cast)i(the)e(left)h(side)g
(of)g(the)g(pro)r(duct)f(\014rst)g(and)-152 3783 y(then)24
b(to)g(cast)g(the)g(righ)n(t)g(side,)h(using)f(the)g(t)n(yp)r
(e-constructor)f(argu-)-152 3870 y(men)n(t)28 b(to)h(relate)g(the)g(t)n
(yp)r(e)f(of)i(the)e(term)g(argumen)n(t)g(to)h(the)f(t)n(yp)r(es)-152
3957 y(b)r(eing)d(examineded.)33 b(In)25 b(Hask)n(ell)g(w)n(e)g(cannot)
g(explicitly)g(instan)n(ti-)-152 4044 y(ate)e(the)g(t)n(yp)r(e)e
(constructor)j(argumen)n(t)d(as)j(w)n(e)f(did)f(in)h
Fe(\025)1479 4012 y Fc(ML)1479 4058 y Fb(i)1571 4044
y Fk(,)h(but)d(w)n(e)-152 4131 y(can)28 b(giv)n(e)f(Hask)n(ell)h
(enough)f(hin)n(ts)g(to)g(infer)h(the)f(correct)h(one.)1679
4100 y Fa(4)1753 4131 y Fk(T)-6 b(o)-152 4218 y(represen)n(t)25
b(the)f(t)n(w)n(o)i(t)n(yp)r(e)d(constructor)j(argumen)n(ts)e(ab)r(o)n
(v)n(e)h(w)n(e)g(use)-152 4306 y(the)h(data)g(constructors)g
Ff(LP)g Fk(and)f Ff(RP)p Fk(,)i(de\014ned)d(b)r(elo)n(w.)-152
4559 y Ff(newtype)41 b(LProd)g Fe(\013)e(\015)k(\016)f
Ff(=)e(LP)f(\()p Fe(\015)44 b Ff(\()p Fe(\016)s Ff(,)39
b Fe(\013)p Ff(\)\))-152 4646 y(newtype)i(RProd)g Fe(\013)e(\015)k
(\016)f Ff(=)e(RP)f(\()p Fe(\015)44 b Ff(\()p Fe(\013)p
Ff(,)c Fe(\016)s Ff(\)\))-152 4733 y(instance)h(\(CT)f
Fe(\014)401 4741 y Fa(1)436 4733 y Ff(,)g(CT)f Fe(\014)675
4741 y Fa(2)710 4733 y Ff(\))h(=>)f(CT)h(\()p Fe(\014)1106
4741 y Fa(1)1141 4733 y Ff(,)g Fe(\014)1263 4741 y Fa(2)1297
4733 y Ff(\))g(where)-34 4820 y(doInt)g(x)g(=)f(error)i("CantCast")-34
4907 y(doProd)g(z)e(=)h(x)162 4994 y(where)h(LP)e(y)h(=)f(cast')h(\(LP)
g(z\))398 5082 y(RP)f(x)h(=)f(cast')h(\(RP)g(y\))-34
5169 y(doFn)g(x)g(=)f(error)h("CantCast")p -152 5217
797 4 v -148 5271 a Fa(4)-113 5303 y Fk(Jones)30 b([8])g(describ)r(es)h
(this)e(sort)h(of)g(implicit)g(higher-order)f(p)r(oly-)-152
5378 y(morphism)24 b(in)i(Hask)n(ell.)2040 -69 y(Ho)n(w)37
b(do)r(es)h(this)f(co)r(de)h(t)n(yp)r(ec)n(hec)n(k?)67
b(In)36 b(this)i(instance,)i Ff(doProd)2040 19 y Fk(should)26
b(b)r(e)f(of)i(t)n(yp)r(e)2040 245 y Ff(\(CF)40 b Fe(\013)2246
253 y Fa(1)2281 245 y Ff(,)f(CF)h Fe(\013)2526 253 y
Fa(2)2561 245 y Ff(\))f(=>)h Fe(\015)j Ff(\()p Fe(\013)2928
253 y Fa(1)2963 245 y Ff(,)p Fe(\013)3051 253 y Fa(2)3086
245 y Ff(\))d Fn(!)f Fe(\015)k Fk(\()p Fe(\014)3437 253
y Fa(1)3471 245 y Ff(,)p Fe(\014)3553 253 y Fa(2)3589
245 y Ff(\).)2040 471 y Fk(Therefore)29 b Ff(z)f Fk(is)f(of)i(t)n(yp)r
(e)d Fe(\015)32 b Fk(\()p Fe(\013)2950 479 y Fa(1)2984
471 y Fk(,)c Fe(\013)3082 479 y Fa(2)3117 471 y Fk(\))f(so)68
b Ff(LP)39 b(z)28 b Fk(is)g(of)g(t)n(yp)r(e)e Ff(LProd)2040
559 y Fe(\013)2089 567 y Fa(2)2163 559 y Fe(\015)43 b(\013)2295
567 y Fa(1)2330 559 y Fk(.)34 b(A)n(t)23 b(\014rst)h(glance,)h(it)f
(seems)g(lik)n(e)g(w)n(e)h(cannot)e(call)i Ff(cast')2040
646 y Fk(on)h(this)f(argumen)n(t)g(b)r(ecause)h(w)n(e)f(ha)n(v)n(e)g
(not)h(declared)g(an)f(instance)2040 733 y(of)h Ff(CF)20
b Fk(for)g(the)f(t)n(yp)r(e)f(constructor)i Ff(LProd)p
Fk(.)33 b(Ho)n(w)n(ev)n(er,)21 b(the)e(instances)2040
820 y(of)37 b Ff(cast')32 b Fk(are)f(all)g(of)h(t)n(yp)r(e)d
Fn(8)p Fe(\015)2966 788 y Fd(0)2988 820 y Ff(.\(CT)41
b Fe(\014)t Ff(\))e(=>)h Fe(\015)3472 788 y Fd(0)3494
820 y Fe(\013)g Fn(!)f Fe(\015)3743 788 y Fd(0)3765 820
y Fe(\014)t Fk(,)32 b(so)f(to)2040 907 y(t)n(yp)r(ec)n(hec)n(k)23
b(the)g(call)i Ff(cast')41 b(\(LP)f(z\))p Fk(,)25 b(w)n(e)f(only)g
(need)f(to)h(\014nd)f(an)h Fe(\013)2040 995 y Fk(in)f(the)g(class)h
Ff(CT)f Fk(and)g(a)g Fe(\015)2787 963 y Fd(0)2833 995
y Fk(suc)n(h)f(that)h Fe(\015)3211 963 y Fd(0)3233 995
y Fe(\013)g Fk(is)h(equal)f(to)g(the)g(t)n(yp)r(e)f(of)2040
1082 y Ff(LP)40 b(z)p Fk(.)35 b(As)26 b(Hask)n(ell)h(do)r(es)f(not)g(p)
r(ermit)f(the)h(creation)h(of)f(t)n(yp)r(e-lev)n(el)2040
1169 y(t)n(yp)r(e)33 b(abstractions)i([8],)j(the)33 b(t)n(yp)r(e)h(of)
40 b Ff(LP)g(z)34 b Fk(m)n(ust)f(explicitly)h(b)r(e)2040
1256 y(a)28 b(t)n(yp)r(e)e(constructor)i(applied)f(to)h(a)f(t)n(yp)r(e)
g(in)g(order)g(to)h(t)n(yp)r(ec)n(hec)n(k.)2040 1343
y(Therefore)35 b(determining)d Fe(\015)2874 1311 y Fd(0)2929
1343 y Fk(and)h Fe(\013)g Fk(is)g(a)h(simple)f(matc)n(h)e({)j
Fe(\015)3926 1311 y Fd(0)3981 1343 y Fk(is)2040 1430
y(the)28 b(partial)g(application)h Ff(LProd)41 b Fe(\013)3108
1438 y Fa(2)3182 1430 y Fe(\015)31 b Fk(and)d Fe(\013)g
Fk(is)g Fe(\013)3610 1438 y Fa(1)3645 1430 y Fk(.)41
b(Th)n(us,)29 b(the)2040 1518 y(result)g(of)74 b Ff(cast')29
b Fk(is)g(of)g(t)n(yp)r(e)e Ff(\(LProd)41 b Fe(\013)3285
1526 y Fa(2)3359 1518 y Fe(\015)t Ff(\))e Fe(\014)t Fk(,)29
b(for)g(some)f Fe(\014)33 b Fk(in)2040 1605 y Ff(CT)p
Fk(,)26 b(and)g Ff(y)g Fk(is)g(of)g(t)n(yp)r(e)f Fe(\015)30
b Fk(\()p Fe(\014)t Fk(,)c Fe(\013)2960 1613 y Fa(2)2994
1605 y Fk(\).)2040 1779 y(No)n(w)31 b Ff(RP)40 b(y)29
b Fk(is)h(of)h(t)n(yp)r(e)d Ff(RProd)41 b Fe(\014)i(\015)g(\013)3209
1787 y Fa(2)3244 1779 y Fk(,)31 b(so)f(w)n(e)g(need)f(the)g
Fe(\013)3879 1787 y Fa(2)3943 1779 y Fk(in-)2040 1866
y(stance)c(of)31 b Ff(cast')26 b Fk(for)f(the)f(second)h(call.)35
b(This)25 b(instance)g(is)g(of)g(t)n(yp)r(e)2040 1953
y Fn(8)p Fe(\015)2127 1922 y Fd(00)2167 1953 y Ff(.)79
b(CT)40 b Fe(\014)2450 1922 y Fd(0)2511 1953 y Ff(=>)g
Fe(\015)2673 1922 y Fd(00)2753 1953 y Fe(\013)2802 1961
y Fa(2)2876 1953 y Fn(!)f Fe(\015)3036 1922 y Fd(00)3116
1953 y Fe(\014)3163 1922 y Fd(0)3185 1953 y Fk(.)34 b(This)23
b Fe(\015)3456 1922 y Fd(00)3518 1953 y Fk(uni\014es)f(with)h(the)2040
2041 y(partial)31 b(application)g Ff(\(RProd)40 b Fe(\014)k(\015)t
Ff(\))29 b Fk(so)i(the)e(return)g(t)n(yp)r(e)g(of)h(this)2040
2128 y(cast)j(is)f Ff(RProd)40 b Fe(\014)k(\015)f(\014)2740
2096 y Fd(0)2762 2128 y Fk(,)34 b(the)d(t)n(yp)r(e)g(of)39
b Ff(RP)h(x)p Fk(.)53 b(That)32 b(mak)n(es)f Ff(x)h Fk(of)2040
2215 y(t)n(yp)r(e)d Fe(\015)34 b Fk(\()p Fe(\014)t Fk(,)d
Fe(\014)2467 2183 y Fd(0)2490 2215 y Fk(\).)47 b(Comparing)30
b(this)g(t)n(yp)r(e)f(to)h(the)f(return)h(t)n(yp)r(e)f(of)2040
2302 y Ff(doProd)p Fk(,)c(w)n(e)e(unify)f Fe(\014)k Fk(with)d
Fe(\014)2907 2310 y Fa(1)2964 2302 y Fk(and)f Fe(\014)3157
2270 y Fd(0)3202 2302 y Fk(with)h Fe(\014)3417 2310 y
Fa(2)3452 2302 y Fk(.)33 b(This)24 b(uni\014cation)2040
2389 y(satis\014es)33 b(our)e(constrain)n(ts)h(for)g(the)f(t)n(w)n(o)h
(calls)g(to)71 b Ff(cast')p Fk(,)34 b(as)e(w)n(e)2040
2476 y(assumed)25 b(that)h(b)r(oth)f Fe(\014)2739 2484
y Fa(1)2799 2476 y Fk(and)h Fe(\014)2992 2484 y Fa(2)3052
2476 y Fk(are)g(in)g(the)f(class)i Ff(CT)p Fk(.)2040
2651 y(Just)i(as)g(in)g(the)f(second)h Fe(\025)2832 2619
y Fc(ML)2832 2665 y Fb(i)2953 2651 y Fk(solution,)h(function)f(t)n(yp)r
(es)f(w)n(ork)h(in)2040 2738 y(exactly)c(the)f(same)g(w)n(a)n(y)h(as)g
(pro)r(duct)f(t)n(yp)r(es,)h(using)g(similar)g(decla-)2040
2825 y(rations)i(of)32 b Ff(LArrow)27 b Fk(and)e Ff(RArrow)p
Fk(.)2040 3052 y Ff(newtype)41 b(LArrow)g Fe(\013)e(\015)k(\016)f
Ff(=)e(LA)f(\()p Fe(\015)44 b Ff(\()p Fe(\016)e Fn(!)d
Fe(\013)p Ff(\)\))2040 3139 y(newtype)i(RArrow)g Fe(\013)e(\015)k(\016)
f Ff(=)e(RA)f(\()p Fe(\015)44 b Ff(\()p Fe(\013)c Fn(!)f
Fe(\016)s Ff(\)\))2040 3365 y Fk(T)-6 b(o)18 b(encapsulate)h
Ff(cast')p Fk(,)i(w)n(e)d(pro)n(vide)f(the)h(iden)n(tit)n(y)f(t)n(yp)r
(e)g(construc-)2040 3452 y(tor:)2040 3679 y Ff(newtype)41
b(Id)f Fe(\013)f Ff(=)h(I)f Fe(\013)2040 3766 y Ff(cast)h(::)g(\(CF)g
Fe(\013)p Ff(,)g(CT)f Fe(\014)t Ff(\))h(=>)g Fe(\013)f
Fn(!)g Fe(\014)2040 3853 y Ff(cast)h(x)g(=)f(y)h(where)g(\(I)g(y\))f(=)
h(cast')g(\(I)g(x\))2040 4080 y Fk(The)27 b(complete)f(Hask)n(ell)h(co)
r(de)g(for)h(this)e(solution)i(app)r(ears)f(in)g(Ap-)2040
4167 y(p)r(endix)e(A.)2040 4362 y Fl(5.)99 b(IMPLEMENTING)26
b(TYPE)g(D)l(YN)n(AMIC)2040 4454 y Fk(Just)f(as)h Fn(9)p
Fe(\013:\013)g Fk(implemen)n(ts)d(a)i(dynamic)f(t)n(yp)r(e)g(in)h
Fe(\025)3574 4422 y Fc(ML)3574 4468 y Fb(i)3667 4454
y Fk(,)g Fn(9)p Fe(\013:)40 b Ff(CF)f Fe(\013)2040 4541
y Ff(=>)h Fe(\013)21 b Fk(is)g(a)g(dynamic)e(t)n(yp)r(e)h(in)g(Hask)n
(ell.)34 b(Adding)19 b(t)n(yp)r(e)h(Dynamic)f(to)2040
4628 y(a)f(statically)h(t)n(yp)r(ed)e(language)i(is)g(nothing)e(new,)j
(so)f(it)f(is)g(in)n(teresting)2040 4715 y(to)26 b(compare)f(this)h
(implemen)n(tation)e(to)i(previous)g(w)n(ork.)2040 4890
y(One)21 b(w)n(a)n(y)h(to)f(implemen)n(t)f(t)n(yp)r(e)g(Dynamic)h
(\(explored)g(b)n(y)f(Henglein)2040 4977 y([7]\))27 b(is)f(to)g(use)f
(a)h(univ)n(ersal)g(datat)n(yp)r(e.)2040 5203 y Ff(data)40
b(Dynamic)h(=)f(Base)g(Int)2550 5290 y(|)g(Pair)g(\(Dynamic,)h
(Dynamic\))2550 5378 y(|)f(Fn)118 b(\(Dynamic)41 b Fn(!)e
Ff(Dynamic\))p eop
%%Page: 7 7
7 6 bop -152 -69 a Fk(Here,)28 b(in)f(creating)g(a)h(v)l(alue)e(of)i(t)
n(yp)r(e)e Ff(Dynamic)p Fk(,)j(a)f(term)d(is)j(tagged)-152
19 y(with)e(only)e(the)h(head)g(constructor)g(of)h(its)f(t)n(yp)r(e.)34
b(Ho)n(w)n(ev)n(er,)25 b(b)r(efore)-152 106 y(a)36 b(term)f(ma)n(y)g(b)
r(e)h(injected)g(in)n(to)g(this)f(t)n(yp)r(e,)j(if)f(it)f(is)g(a)g
(pair,)j(its)-152 193 y(sub)r(comp)r(onen)n(ts)30 b(m)n(ust)f(b)r(e)h
(co)r(erced,)i(and)e(if)i(it)e(is)h(a)g(function,)h(it)-152
280 y(m)n(ust)22 b(b)r(e)i(con)n(v)n(erted)e(to)i(a)f(function)h(from)f
Ff(Dynamic)41 b Fn(!)e Ff(Dynamic)p Fk(.)-152 367 y(W)-6
b(e)29 b(could)g(implemen)n(t)e(this)i(injection)h(\(and)e(its)h(asso)r
(ciated)i(pro-)-152 454 y(jection\))c(with)f(Hask)n(ell)g(t)n(yp)r(e)f
(classes)i(as)f(follo)n(ws:)-152 665 y Ff(class)41 b(UD)e
Fe(\013)h Ff(where)-73 752 y(toD)118 b(::)40 b Fe(\013)f
Fn(!)g Ff(Dynamic)-73 839 y(fromD)h(::)g(Dynamic)h Fn(!)e
Fe(\013)-152 1060 y Ff(instance)i(UD)f(Int)g(where)-73
1147 y(toD)g(x)f(=)h(Base)g(x)-73 1234 y(fromD)g(\(Base)h(x\))e(=)h(x)
-152 1321 y(instance)h(\(UD)f Fe(\013)p Ff(,)g(UD)g Fe(\014)t
Ff(\))f(=>)h(UD)g(\()p Fe(\013)p Ff(,)p Fe(\014)t Ff(\))g(where)-73
1408 y(toD)g(\(x1,x2\))h(=)e(Pair)h(\(toD)g(x1,)g(toD)g(x2\))-73
1496 y(fromD)g(\(Pair)h(\(d1,)f(d2\)\))g(=)f(\(fromD)i(d1,)f(fromD)g
(d2\))-152 1583 y(instance)h(\(UD)f Fe(\013)p Ff(,)g(UD)g
Fe(\014)t Ff(\))f(=>)h(UD)g(\()p Fe(\013)p Fn(!)p Fe(\014)t
Ff(\))g(where)-73 1670 y(toD)g(f)f(=)79 b(Fn)40 b(\(toD)g(.)f(f)h(.)f
(fromD\))-73 1757 y(fromD)h(\(Fn)g(f\))g(=)f(fromD)i(.)e(f)g(.)h(toD)
-152 1978 y Fk(This)c(implemen)n(tation)d(resem)n(bles)h(our)h(\014rst)
f(cast)i(solutions,)i(in)-152 2065 y(that)20 b(it)g(m)n(ust)f(destruct)
h(the)g(argumen)n(t)f(to)h(reco)n(v)n(er)g(its)h(t)n(yp)r(e.)32
b(Also,)-152 2152 y(pro)t(jecting)19 b(a)e(function)g(from)g(t)n(yp)r
(e)g(Dynamic)e(results)j(in)f(a)h(wrapp)r(ed)-152 2239
y(v)n(ersion.)50 b(Henglein,)33 b(in)d(order)h(to)g(mak)n(e)e(this)i
(strategy)g(e\016cien)n(t,)-152 2327 y(designs)22 b(an)e(algorithm)h
(to)g(pro)r(duce)f(w)n(ell-t)n(yp)r(ed)g(co)r(de)h(with)g(as)g(few)-152
2414 y(co)r(ercions)28 b(to)d(and)h(from)f(the)h(dynamic)e(t)n(yp)r(e)h
(as)h(p)r(ossible.)-152 2588 y(Another)i(w)n(a)n(y)h(to)g(implemen)n(t)
e(t)n(yp)r(e)g(Dynamic)h(is)h(to)g(pair)g(an)g(ex-)-152
2675 y(pression)35 b(with)f(the)68 b Fi(ful)t(l)40 b
Fk(description)35 b(of)f(its)g(t)n(yp)r(e)f([1,)k(9].)60
b(The)-152 2762 y(implemen)n(tations)33 b(GHC)g(and)g(Hugs)g(use)h
(this)f(strategy)h(to)f(pro-)-152 2850 y(vide)i(a)g(library)g(supp)r
(orting)h(t)n(yp)r(e)e(Dynamic)f(in)i(Hask)n(ell.)63
b(This)-152 2937 y(library)31 b(uses)g(t)n(yp)r(e)f(classes)i(to)e
(de\014ne)g(term)g(represen)n(tations)h(for)-152 3024
y(eac)n(h)21 b(t)n(yp)r(e.)32 b(Injecting)22 b(a)f(v)l(alue)f(in)n(to)h
(t)n(yp)r(e)f(Dynamic)g(in)n(v)n(olv)n(es)h(tag-)-152
3111 y(ging)32 b(it)e(with)h(its)g(represen)n(tation,)i(and)d(pro)t
(jecting)i(it)f(compares)-152 3198 y(the)22 b(represen)n(tation)h(with)
g(a)g(giv)n(en)g(represen)n(tation)g(to)f(c)n(hec)n(k)g(that)-152
3285 y(the)k(t)n(yp)r(es)g(matc)n(h.)36 b(A)n(t)26 b(\014rst)g(glance)i
(this)e(sc)n(heme)g(is)h(surprisingly)-152 3373 y(similar)i(to)f(an)g
(implemen)n(tation)e(of)j(cast)f(using)h Ff(typecase)h
Fk(in)e Fe(\025)1791 3381 y Fb(R)-152 3460 y Fk([2],)42
b(a)37 b(v)n(ersion)h(of)g Fe(\025)483 3428 y Fc(ML)483
3474 y Fb(i)613 3460 y Fk(in)f(whic)n(h)g(t)n(yp)r(es)g(are)h
(explicitly)f(repre-)-152 3547 y(sen)n(ted)e(b)n(y)f(dep)r(enden)n(tly)
f(t)n(yp)r(ed)h(terms.)61 b(Ho)n(w)n(ev)n(er)35 b(there)f(is)i(an)-152
3634 y(imp)r(ortan)n(t)30 b(distinction:)46 b(Though)31
b(t)n(yp)r(e)g(classes)h(can)f(create)h(ap-)-152 3721
y(propriate)39 b(term)e(represen)n(tations)i(for)h(eac)n(h)e(t)n(yp)r
(e,)j(there)d(is)h(no)-152 3808 y(supp)r(ort)33 b(for)g(dep)r(endency)
-6 b(,)33 b(so)g(the)f(last)h(step)g(of)g(the)f(pro)t(jection)-152
3896 y(requires)26 b(an)g(unsafe)g(t)n(yp)r(e)f(co)r(ercion.)-152
4070 y(Although)20 b(the)f Ff(cast)i Fk(solution)g(is)f(more)g
(e\016cien)n(t)g(than)f(the)h(univ)n(er-)-152 4157 y(sal)g(datat)n(yp)r
(e)f(and)f(more)h(t)n(yp)r(e-safe)g(than)f(the)h(GHC/Hugs)h(library)
-152 4244 y(implemen)n(tation,)25 b(it)h(su\013ers)g(in)g(terms)f(of)i
(extensibilit)n(y)-6 b(.)34 b(The)27 b(ex-)-152 4332
y(ample)17 b(implemen)n(tations)g(of)24 b Ff(cast)18
b Fk(only)f(consider)h(three)f(t)n(yp)r(e)g(con-)-152
4419 y(structors,)27 b(for)h(in)n(tegers,)f(pro)r(ducts)f(and)g
(functions.)36 b(Others)26 b(ma)n(y)-152 4506 y(b)r(e)f(added,)g(b)r
(oth)f(primitiv)n(e)g(\(suc)n(h)g(as)h Ff(Char)p Fk(,)h
Ff(IO)p Fk(,)f(or)g Ff([])p Fk(\))g(and)g(user)-152 4593
y(de\014ned)j(\(suc)n(h)g(as)h(from)f(datat)n(yp)r(e)g(and)g(newt)n(yp)
r(e)g(declarations\),)-152 4680 y(but)21 b(only)g(through)h(mo)r
(di\014cation)f(of)i(the)e Ff(CT)h Fk(t)n(yp)r(e)f(class.)34
b(F)-6 b(urther-)-152 4767 y(more,)27 b(all)h(curren)n(t)e(instan)n
(tiations)i(of)72 b Ff(CT)27 b Fk(need)g(to)f(b)r(e)h(extended)-152
4855 y(with)36 b(error)h(functions)f(for)g(eac)n(h)g(additional)h(t)n
(yp)r(e)e(constructor.)-152 4942 y(In)26 b(con)n(trast,)i(the)e
(library)h(implemen)n(tation)e(can)i(b)r(e)f(extended)g(to)-152
5029 y(supp)r(ort)i(new)g(t)n(yp)r(e)g(constructors)h(without)f(mo)r
(difying)g(previous)-152 5116 y(co)r(de.)-152 5290 y(A)g(third)f
(implemen)n(tation)f(of)j(t)n(yp)r(e)e(Dynamic)f(that)i(is)g(t)n(yp)r
(e)f(safe,)-152 5378 y(e\016cien)n(t)22 b(and)f(easily)h(extensible)f
(uses)h(references)g(\(see)g(W)-6 b(eeks)20 b([17])2040
-69 y(for)31 b(the)f(original)i(SML)e(v)n(ersion\).)48
b(Though)30 b(the)g(use)g(of)h(m)n(utable)2040 19 y(references)g(is)f
(not)f(t)n(ypically)g(encouraged)h(\(or)g(ev)n(en)e(p)r(ossible\))j(in)
2040 106 y(a)c(purely)e(functional)i(language,)h(GHC)f(and)f(Hugs)g
(supp)r(ort)g(their)2040 193 y(use)h(b)n(y)g(encapsulation)h(in)f(the)g
(IO)g(monad.)38 b(While)28 b(the)f(previous)2040 280
y(implemen)n(tations)35 b(of)i(t)n(yp)r(e)f(Dynamic)f(de\014ned)g(the)h
(description)2040 367 y(of)c(a)g(t)n(yp)r(e)e(at)h(compile)g(time,)i
(references)f(allo)n(w)h(the)e(creation)h(of)2040 454
y(a)k(description)g(for)g(an)n(y)f(t)n(yp)r(e)g(at)h(run)f(time,)i(and)
e(so)i(are)f(easily)2040 542 y(extendable)f(to)h(new)g(t)n(yp)r(es.)63
b(Because)37 b(eac)n(h)f(reference)g(created)2040 629
y(b)n(y)77 b Ff(newIORef)39 b Fk(is)f(unique,)i(a)d(unit)g(reference)h
(can)g(b)r(e)f(used)g(to)2040 716 y(implemen)n(t)21 b(a)i(unique)f(tag)
i(for)f(a)h(giv)n(en)f(t)n(yp)r(e.)32 b(A)23 b(mem)n(b)r(er)e(of)i(t)n
(yp)r(e)2040 803 y(Dynamic)34 b(is)i(then)f(a)h(pair)f(of)i(a)e(tag)h
(and)f(a)h(computation)f(that)2040 890 y(hides)26 b(the)f(stored)h(v)l
(alue)g(in)f(its)h(closure.)3246 859 y Fa(5)2040 1141
y Ff(data)40 b(Dyn)g(=)g(Dyn)g({)f(tag)h(::)g(IORef)g(\(\))g(,)f(get)h
(::)79 b(IO)40 b(\(\))f(})2040 1391 y Fk(T)-6 b(o)27
b(reco)n(v)n(er)g(the)g(v)l(alue)f(hidden)g(in)h(the)f(closure,)i(the)f
Ff(get)g Fk(compu-)2040 1478 y(tation)g(writes)h(that)f(v)l(alue)f(to)h
(a)g(reference)h(stored)f(in)f(the)h(closure)2040 1566
y(of)g(the)e(pro)t(jection)i(from)f(the)f(dynamic)g(t)n(yp)r(e.)34
b(The)26 b(computation)2040 1653 y Ff(make)19 b Fk(b)r(elo)n(w)g
(creates)g(injection)g(and)f(pro)t(jection)i(functions)e(for)h(an)n(y)
2040 1740 y(t)n(yp)r(e.)2040 1974 y Ff(make)40 b(::)79
b(IO)40 b(\()p Fe(\013)g Ff(->)f(Dyn,)h(Dyn)g(->)g(IO)g
Fe(\013)p Ff(\))2040 2061 y(make)g(=)g(do)f Fn(f)h Ff(newtag)h(<-)e
(newIORef)i(\(\))2432 2148 y(;)f(r)f(<-)h(newIORef)h(Nothing)2432
2236 y(;)f(return)2511 2323 y(\(\\a)g(->)f(Dyn)h Fn(f)g
Ff(tag)g(=)f(newtag,)2825 2410 y(get)h(=)f(writeIORef)j(r)d(\(Just)h
(a\))g Fn(g)p Ff(,)2550 2497 y(\\d)g(->)f(if)h(\(newtag)h(==)f(tag)g
(d\))2550 2584 y(then)2550 2671 y(do)g Fn(f)f Ff(get)h(d)2668
2759 y(;)f(Just)h(x)g(<-)f(readIORef)j(r)2668 2846 y(;)d(return)i(x)
2668 2933 y Fn(g)2550 3020 y Ff(else)f(error)h("Ill)f(typed"\))2432
3107 y Fn(g)2040 3341 y Fk(This)18 b(implemen)n(tation)e(of)j(t)n(yp)r
(e)d(dynamic)g(is)i(more)f(di\016cult)h(to)f(use,)2040
3428 y(as)j(it)g(m)n(ust)e(b)r(e)h(threaded)g(through)g(the)g(IO)g
(monad.)32 b(F)-6 b(urthermore,)2040 3516 y(b)r(ecause)24
b(the)f(tag)h(is)h(created)f(dynamically)-6 b(,)23 b(it)g(cannot)h(b)r
(e)f(used)h(in)2040 3603 y(an)18 b(implemen)n(tation)e(for)j
(marshalling)f(and)g(unmarshalling.)32 b(Also,)2040 3690
y(the)20 b(user)g(m)n(ust)f(b)r(e)h(careful)h(to)f(call)i
Ff(make)e Fk(only)g(once)h(for)g(eac)n(h)f(t)n(yp)r(e,)2040
3777 y(lest)j(she)g(confuse)h(them.)32 b(\(Con)n(v)n(ersely)-6
b(,)23 b(the)f(user)h(is)g(free)h(to)f(create)2040 3864
y(more)i(distinctions)h(b)r(et)n(w)n(een)f(t)n(yp)r(es,)h(in)f(m)n(uc)n
(h)f(the)h(same)g(manner)2040 3951 y(as)33 b(the)f(newt)n(yp)r(e)g(mec)
n(hanism\).)54 b(Unlik)n(e)31 b(the)i(previous)f(v)n(ersions)2040
4039 y(that)23 b(could)h(not)f(handle)h(t)n(yp)r(es)f(with)h(binding)f
(structure)g(\(suc)n(h)g(as)2040 4126 y Ff(forall)41
b(a.)79 b(a)39 b(->)h(a)p Fk(\),)30 b(this)e(solution)i(can)f(hide)f
(an)n(y)g(t)n(yp)r(e.)43 b(Ad-)2040 4213 y(ditionally)-6
b(,)22 b(the)e(complexit)n(y)f(of)i(pro)t(jection)g(from)f(a)h(dynamic)
d(t)n(yp)r(e)2040 4300 y(do)r(es)27 b(not)g(dep)r(end)f(on)h(the)f(t)n
(yp)r(e)g(itself.)39 b(Ho)n(w)n(ev)n(er,)27 b(the)g(ab)r(o)n(v)n(e)f
(so-)2040 4387 y(lution)e(has)h(a)f(redundan)n(t)f(comparison)h({)g(if)
h(the)f(tags)g(matc)n(h)f(then)2040 4474 y(the)33 b(pattern)g(matc)n(h)
71 b Ff(Just)40 b(x)34 b Fk(will)h(nev)n(er)d(fail,)37
b(but)c(the)g(imple-)2040 4562 y(men)n(tation)26 b(m)n(ust)f(still)j(c)
n(hec)n(k)e(that)g(that)h(the)f(reference)h(do)r(es)h(not)2040
4649 y(con)n(tain)e Ff(Nothing)p Fk(.)2040 4823 y(If)31
b(w)n(e)f(w)n(ander)h(outside)g(of)g(the)f(language)h(Hask)n(ell,)i(w)n
(e)d(\014nd)g(lan-)2040 4910 y(guage)20 b(supp)r(ort)e(for)h(a)g(more)f
(natural)h(implemen)n(tation)e(of)j(tagging,)2040 4998
y(thereb)n(y)30 b(eliminating)i(this)g(redundan)n(t)e(c)n(hec)n(k.)51
b(F)-6 b(or)31 b(example,)i(if)2040 5085 y(the)28 b(language)h(supp)r
(orts)g(an)f(extensible)g(sum)f(t)n(yp)r(e)h(\(suc)n(h)f(as)i(the)2040
5172 y(exception)35 b(t)n(yp)r(e)e(in)i(SML\))g(then)f(that)g(t)n(yp)r
(e)g(can)h(b)r(e)f(view)n(ed)h(as)p 2040 5217 797 4 v
2044 5271 a Fa(5)2078 5303 y Fk(Whic)n(h)c(can)h(b)r(e)f(view)n(ed)g
(as)h(hiding)g(the)f(v)l(alue)g(within)g(an)h(exis-)2040
5378 y(ten)n(tial)26 b(t)n(yp)r(e)f([11].)p eop
%%Page: 8 8
8 7 bop -152 -69 a Fk(t)n(yp)r(e)22 b(Dynamic)e([17].)35
b(The)23 b(declaration)g(of)g(a)g(new)f(exception)g(con-)-152
19 y(structor,)j Ff(E)p Fk(,)f(carrying)f(some)h(t)n(yp)r(e)e
Fe(\034)32 b Fk(pro)n(vides)23 b(an)h(injection)g(from)-152
106 y Fe(\034)41 b Fk(in)n(to)33 b(the)f(exception)g(t)n(yp)r(e.)55
b(Co)r(ercing)34 b(a)f(v)l(alue)f(from)h(the)f(dy-)-152
193 y(namic)24 b(t)n(yp)r(e)g(to)g Fe(\034)33 b Fk(is)25
b(matc)n(hing)f(the)g(exception)g(constructor)h(with)-152
280 y Ff(E)p Fk(.)-152 454 y(Alternativ)n(ely)-6 b(,)22
b(if)g(the)e(language)j(supp)r(orts)e(subt)n(yping)e(and)i(do)n(wn-)
-152 542 y(casting,)h(then)d(a)h(maximal)e(sup)r(ert)n(yp)r(e)g(serv)n
(es)i(as)g(a)f(dynamic)f(t)n(yp)r(e.)-152 629 y(Ignoring)26
b(the)e(primitiv)n(e)g(t)n(yp)r(es)g(\(suc)n(h)g(as)i(in)n(t\),)f(Ja)n
(v)l(a)g([5])g(is)h(an)f(ex-)-152 716 y(ample)31 b(of)g(suc)n(h)g(a)g
(language.)52 b(An)n(y)29 b(reference)j(t)n(yp)r(e)e(ma)n(y)g(b)r(e)h
(co-)-152 803 y(erced)18 b(to)f(t)n(yp)r(e)f(Ob)t(ject,)k(without)d(an)
n(y)g(run)f(time)h(o)n(v)n(erhead.)31 b(Co)r(erc-)-152
890 y(ing)c(from)g(t)n(yp)r(e)e(Ob)t(ject)i(requires)g(c)n(hec)n(king)f
(whether)g(the)g(v)l(alue's)-152 977 y(class)f(\(tagged)f(with)g(the)e
(v)l(alue\))h(is)h(a)g(subt)n(yp)r(e)e(of)i(the)f(giv)n(en)g(class.)
-152 1183 y Fl(6.)100 b(P)-7 b(ARAMETRIC)24 b(POL)-9
b(YMORPHISM)-152 1275 y Fk(The)38 b(purp)r(ose)f(of)h(this)f(pap)r(er)g
(is)h(not)f(to)g(\014nd)f(the)h(b)r(est)g(imple-)-152
1362 y(men)n(tation)30 b(of)h(dynamic)e(t)n(yping,)i(but)e(instead)i
(to)f(explore)g(what)-152 1449 y(language)f(supp)r(ort)d(is)i
(necessary)g(to)f(implemen)n(t)e(it)i(and)g(at)g(what)-152
1536 y(cost.)34 b(With)21 b(the)g(addition)h(of)g(\014rst-class)g(p)r
(olymorphism)e(\(suc)n(h)h(as)-152 1623 y(supp)r(orted)32
b(b)n(y)e(GHC)i(or)g(Hugs\),)i(Hask)n(ell)e(t)n(yp)r(e)f(classes)i(ma)n
(y)e(b)r(e)-152 1711 y(completely)26 b(compiled)f(a)n(w)n(a)n(y)h
([16].)36 b(Therefore,)28 b(the)e(\014nal)f(Hask)n(ell)-152
1798 y(t)n(yp)r(eclass)j(solution)h(can)f(b)r(e)f(con)n(v)n(erted)g(to)
h(a)g(framew)n(ork)g(for)g(im-)-152 1885 y(plemen)n(ting)18
b(heterogeneous)i(sym)n(b)r(ol)e(tables)i(in)f(a)g(system)f(of)i(para-)
-152 1972 y(metric)35 b(p)r(olymorphism.)61 b(App)r(endix)34
b(B)h(sho)n(ws)h(the)f(result)h(of)f(a)-152 2059 y(standard)21
b(translation)i(to)e(dictionary-passing)h(st)n(yle,)g(plus)f(a)h(sam-)
-152 2147 y(ple)k(run.)-152 2321 y(The)35 b(original)i(problem)d(w)n(e)
i(had)e(with)h(the)g(function)g Ff(find)h Fk(w)n(as)-152
2408 y(with)21 b(its)f(t)n(yp)r(e;)i(though)d Fe(\013)i
Fk(w)n(as)g(univ)n(ersally)f(quan)n(ti\014ed,)g(it)g(did)g(not)-152
2495 y(app)r(ear)32 b(negativ)n(ely)-6 b(.)52 b(The)31
b(translation)i(of)f(the)f(Hask)n(ell)h(solution)-152
2582 y(sho)n(ws)25 b(us)f(exactly)f(what)h(additional)h(argumen)n(t)e
(w)n(e)h(need)f(to)h(pass)-152 2670 y(to)j Ff(find)g
Fk(\(the)f Ff(CT)h Fk(dictionary)g(for)h(the)e(result)h(t)n(yp)r(e\),)f
(and)g(exactly)-152 2757 y(what)18 b(additional)g(information)g(w)n(e)g
(need)e(to)i(store)g(with)f(eac)n(h)h(en)n(try)-152 2844
y(in)26 b(the)g(sym)n(b)r(ol)g(table)g(\(the)g Ff(CF)h
Fk(dictionary)f(for)h(the)f(en)n(try's)g(t)n(yp)r(e\))-152
2931 y(in)g(order)g(to)g(reco)n(v)n(er)f(the)h(t)n(yp)r(e.)-152
3137 y Fl(7.)100 b(A)-5 b(CKNO)g(WLEDGEMENTS)-152 3228
y Fk(Thanks)36 b(to)g(Karl)h(Crary)-6 b(,)38 b(F)-6 b(ergus)37
b(Henderson,)h(Chris)f(Ok)l(asaki,)-152 3316 y(Greg)k(Morrisett,)k(Da)n
(v)n(e)39 b(W)-6 b(alk)n(er,)44 b(Stev)n(e)39 b(Zdancewic,)45
b(and)39 b(the)-152 3403 y(ICFP)31 b(review)n(ers)h(for)g(their)e(man)n
(y)f(commen)n(ts)g(on)i(earlier)h(drafts)-152 3490 y(of)27
b(this)f(pap)r(er.)-152 3696 y Fl(8.)100 b(REFERENCES)-113
3783 y Fk([1])38 b(M.)26 b(Abadi,)g(L.)g(Cardelli,)i(B.)e(Pierce,)h
(and)e(G.)h(Plotkin.)5 3870 y(Dynamic)e(t)n(yping)h(in)h(a)g
(statically-t)n(yp)r(ed)g(language.)h Fi(A)n(CM)5 3957
y(T)-6 b(r)l(ansactions)30 b(on)e(Pr)l(o)l(gr)l(amming)g(L)l(anguages)i
(and)5 4045 y(Systems)p Fk(,)e(13\(2\):237{268,)i(April)25
b(1991.)-113 4198 y([2])38 b(K.)26 b(Crary)-6 b(,)26
b(S.)f(W)-6 b(eiric)n(h,)26 b(and)g(G.)g(Morrisett.)h(In)n(tensional)5
4286 y(p)r(olymorphism)d(in)i(t)n(yp)r(e-erasure)f(seman)n(tics.)h(In)f
Fi(1998)5 4373 y(A)n(CM)i(International)i(Confer)l(enc)l(e)g(on)f(F)-6
b(unctional)5 4460 y(Pr)l(o)l(gr)l(amming)p Fk(,)27 b(pages)g(301{312,)
h(Baltimore,)f(Sept.)e(1998.)5 4547 y(Extended)g(v)n(ersion)h
(published)f(as)h(Cornell)h(Univ)n(ersit)n(y)5 4634 y(tec)n(hnical)f
(rep)r(ort)g(TR98-1721.)-113 4788 y([3])38 b(C.)27 b(Dub)r(ois,)f(F.)g
(Rouaix,)f(and)h(P)-6 b(.)26 b(W)-6 b(eis.)26 b(Extensional)5
4875 y(p)r(olymorphism.)f(In)f Fi(Twenty-Se)l(c)l(ond)31
b(A)n(CM)c(Symp)l(osium)5 4962 y(on)h(Principles)g(of)f(Pr)l(o)l(gr)l
(amming)h(L)l(anguages)p Fk(,)g(pages)5 5050 y(118{129,)h(San)c(F)-6
b(rancisco,)27 b(Jan.)g(1995.)-113 5203 y([4])38 b(J.-Y.)26
b(Girard.)g Fi(Interpr)n(\023)-37 b(etation)30 b(fonctionel)t(le)e(et)e
(\023)-37 b(elimination)5 5290 y(des)28 b(c)l(oupur)l(es)i(de)e
(l'arithm)n(\023)-37 b(etique)28 b(d'or)l(dr)l(e)h(sup)n(\023)-37
b(erieur)p Fk(.)27 b(PhD)5 5378 y(thesis,)g(Univ)n(ersit)n(\023)-36
b(e)25 b(P)n(aris)i(VI)r(I,)e(1972.)2078 -69 y([5])39
b(J.)26 b(Gosling,)i(B.)e(Jo)n(y)-6 b(,)26 b(and)f(G.)i(Steele.)f
Fi(The)i(Java)g(L)l(anguage)2197 19 y(Sp)l(e)l(ci\014c)l(ation)p
Fk(.)f(Addison-W)-6 b(esley)g(,)25 b(1996.)2078 211 y([6])39
b(R.)25 b(Harp)r(er)h(and)f(G.)h(Morrisett.)i(Compiling)e(p)r
(olymorphism)2197 298 y(using)g(in)n(tensional)g(t)n(yp)r(e)f
(analysis.)i(In)e Fi(Twenty-Se)l(c)l(ond)2197 385 y(A)n(CM)i(Symp)l
(osium)h(on)g(Principles)f(of)h(Pr)l(o)l(gr)l(amming)2197
472 y(L)l(anguages)p Fk(,)g(pages)e(130{141,)j(San)c(F)-6
b(rancisco,)28 b(Jan.)e(1995.)2078 665 y([7])39 b(F.)26
b(Henglein.)g(Dynamic)f(t)n(yping.)g(In)g(B.)h(Krieg-Br)r(\177)-41
b(uc)n(kner,)2197 752 y(editor,)26 b Fi(F)-6 b(ourth)29
b(Eur)l(op)l(e)l(an)h(Symp)l(osium)d(on)h(Pr)l(o)l(gr)l(amming)p
Fk(,)2197 839 y(n)n(um)n(b)r(er)c(582)i(in)g(Lecture)g(Notes)f(in)h
(Computer)f(Science,)2197 926 y(pages)h(233{253.)j(Springer-V)-6
b(erlag,)26 b(F)-6 b(eb.)26 b(1992.)2078 1119 y([8])39
b(M.)26 b(P)-6 b(.)26 b(Jones.)h(A)e(system)g(of)h(constructor)g
(classes:)2197 1206 y(o)n(v)n(erloading)h(and)e(implicit)g
(higher-order)h(p)r(olymorphism.)2197 1293 y Fi(Journal)i(of)f(F)-6
b(unctional)29 b(Pr)l(o)l(gr)l(amming)p Fk(,)e(5\(1\),)f(Jan.)h(1995.)
2078 1485 y([9])39 b(X.)25 b(Lero)n(y)h(and)f(M.)i(Maun)n(y)-6
b(.)25 b(Dynamics)f(in)i(ML.)g(In)2197 1572 y(J.)g(Hughes,)g(editor,)g
Fi(F)-6 b(unctional)29 b(Pr)l(o)l(gr)l(amming)f(L)l(anguages)2197
1660 y(and)g(Computer)h(A)n(r)l(chite)l(ctur)l(e)p Fk(,)g(n)n(um)n(b)r
(er)23 b(523)k(in)f(Lecture)2197 1747 y(Notes)g(in)f(Computer)g
(Science,)h(pages)h(406{426.)2197 1834 y(Springer-V)-6
b(erlag,)26 b(Aug.)f(1991.)2040 2026 y([10])39 b(R.)25
b(Milner,)i(M.)g(T)-6 b(ofte,)26 b(R.)g(Harp)r(er,)g(and)f(D.)h
(MacQueen.)2197 2113 y Fi(The)i(De\014nition)f(of)h(Standar)l(d)h(ML)e
(\(R)l(evise)l(d\))p Fk(.)h(The)e(MIT)2197 2201 y(Press,)h(Cam)n
(bridge,)f(Massac)n(h)n(usetts,)h(1997.)2040 2393 y([11])39
b(Y.)25 b(Minamide,)h(G.)g(Morrisett,)i(and)d(R.)h(Harp)r(er.)g(T)n(yp)
r(ed)2197 2480 y(closure)h(con)n(v)n(ersion.)f(In)f Fi(Twenty-Thir)l(d)
k(A)n(CM)e(Symp)l(osium)2197 2567 y(on)h(Principles)f(of)h(Pr)l(o)l(gr)
l(amming)g(L)l(anguages)p Fk(,)g(pages)2197 2654 y(271{283,)h(St.)c(P)n
(etersburg,)h(Florida,)i(Jan.)e(1996.)2040 2847 y([12])39
b(J.)26 b(C.)h(Mitc)n(hell)f(and)g(G.)g(D.)f(Plotkin.)i(Abstract)e(t)n
(yp)r(es)g(ha)n(v)n(e)2197 2934 y(existen)n(tial)h(t)n(yp)r(e.)f
Fi(A)n(CM)j(T)-6 b(r)l(ansactions)29 b(on)f(Pr)l(o)l(gr)l(amming)2197
3021 y(L)l(anguages)h(and)f(Systems)p Fk(,)g(10\(3\):470{502,)i(July)c
(1988.)2040 3213 y([13])39 b(S.)26 b(P)n(eyton)f(Jones)h(and)g(J.)g
(Hughes)f(\(editors\).)i(Rep)r(ort)e(on)2197 3301 y(the)g(programming)g
(language)i(Hask)n(ell)f(98,)h(a)f(non-strict)2197 3388
y(purely)f(functional)h(language.)i(T)-6 b(ec)n(hnical)26
b(Rep)r(ort)2197 3475 y(Y)-6 b(ALEU/DCS/RR-1106,)25 b(Y)-6
b(ale)26 b(Univ)n(ersit)n(y)-6 b(,)25 b(Departmen)n(t)2197
3562 y(of)h(Computer)f(Science,)h(F)-6 b(eb.)26 b(1999.)h(Av)l(ailable)
f(from)2197 3649 y(h)n(ttp://www.hask)n(ell.org/de\014nition/.)2040
3842 y([14])39 b(J.)26 b(C.)h(Reynolds.)e(T)-6 b(o)n(w)n(ards)27
b(a)f(theory)f(of)i(t)n(yp)r(e)d(structure.)i(In)2197
3929 y Fi(Pr)l(o)l(gr)l(amming)i(Symp)l(osium)p Fk(,)f(v)n(olume)d(19)j
(of)f Fi(L)l(e)l(ctur)l(e)k(Notes)2197 4016 y(in)d(Computer)i(Scienc)l
(e)p Fk(,)e(pages)f(408{425,)j(1974.)2040 4208 y([15])39
b(P)-6 b(.)26 b(W)-6 b(adler.)26 b(Theorems)g(for)g(free!)35
b(In)25 b Fi(F)-6 b(ourth)29 b(Confer)l(enc)l(e)2197
4296 y(on)f(F)-6 b(unctional)28 b(Pr)l(o)l(gr)l(amming)h(L)l(anguages)g
(and)f(Computer)2197 4383 y(A)n(r)l(chite)l(ctur)l(e)p
Fk(,)h(London,)d(Sept.)f(1989.)2040 4575 y([16])39 b(P)-6
b(.)26 b(W)-6 b(adler)25 b(and)h(S.)f(Blott.)i(Ho)n(w)f(to)g(mak)n(e)e
(ad-ho)r(c)2197 4662 y(p)r(olymorphism)g(less)j(ad-ho)r(c.)f(In)f
Fi(Sixte)l(enth)k(A)n(CM)2197 4749 y(Symp)l(osium)f(on)g(Principles)f
(of)g(Pr)l(o)l(gr)l(amming)i(L)l(anguages)p Fk(,)2197
4837 y(pages)d(60{76.)i(A)n(CM,)f(1989.)2040 5029 y([17])39
b(S.)26 b(W)-6 b(eeks.)25 b(NJ)h(PearLS)g({)g(dynamically)f(extensible)
h(data)2197 5116 y(structures)g(in)f(Standard)g(ML.)h(T)-6
b(alk)26 b(presen)n(ted)f(at)h(New)2197 5203 y(Jersey)g(Programming)g
(Languages)g(and)g(Systems)e(Seminar,)2197 5290 y(Sept.)h(1998.)j(T)-6
b(ransparencies)27 b(a)n(v)l(ailable)f(at)2197 5378 y(h)n
(ttp://www.star-lab.com/sw)n(eeks/talks.h)n(tml.)p eop
%%Page: 9 9
9 8 bop -152 -69 a Fl(APPENDIX)-152 57 y(A.)100 b(HASKELL)25
b(LISTING)h(FOR)e(SOLUTION)h(2)-152 149 y Ff(newtype)41
b(LProd)g(a)e(g)g(d)h(=)f(LP)h(\(g)g(\(d,)g(a\)\))-152
236 y(newtype)h(RProd)g(a)e(g)g(d)h(=)f(RP)h(\(g)g(\(a,)g(d\)\))-152
323 y(newtype)h(LArrow)g(a)e(g)h(d)f(=)h(LA)f(\(g)h(\(d)g(->)f(a\)\))
-152 410 y(newtype)i(RArrow)g(a)e(g)h(d)f(=)h(RA)f(\(g)h(\(a)g(->)f
(d\)\))-152 497 y(newtype)i(Id)f(a)f(=)h(I)f(a)-152 672
y(class)i(CF)e(a)h(where)5 759 y(cast')h(::)e(CT)h(b)f(=>)h(g)g(a)f(->)
h(g)f(b)-152 846 y(instance)i(CF)f(Int)g(where)5 933
y(cast')h(=)e(doInt)-152 1020 y(instance)i(\(CF)f(a,)g(CF)g(b\))f(=>)h
(CF)g(\(a,)g(b\))f(where)5 1107 y(cast')i(=)e(doProd)-152
1195 y(instance)i(\(CF)f(a,)g(CF)g(b\))f(=>)h(CF)g(\(a->b\))g(where)5
1282 y(cast')h(=)e(doFn)-152 1456 y(class)i(CT)e(b)h(where)5
1543 y(doInt)80 b(::)40 b(g)f(Int)h(->)g(g)f(b)5 1631
y(doProd)i(::)f(\(CF)f(a1,)h(CF)g(a2\))g(=>)554 1718
y(g)g(\(a1,)g(a2\))g(->)g(g)f(b)5 1805 y(doFn)119 b(::)40
b(\(CF)f(a1,)h(CF)g(a2\))g(=>)554 1892 y(g)g(\(a1->a2\))h(->)f(g)f(b)
-152 1979 y(instance)i(CT)f(Int)g(where)5 2066 y(doInt)h(x)e(=)h(x)5
2154 y(doProd)h(x)e(=)h(error)g("CantCF")5 2241 y(doFn)g(x)g(=)f(error)
i("CantCast")-152 2328 y(instance)g(\(CT)f(b1,)g(CT)g(b2\))g(=>)f(CT)h
(\(b1,)g(b2\))g(where)5 2415 y(doInt)h(x)e(=)h(error)g("CantCast")5
2502 y(doProd)h(z)e(=)h(x)162 2589 y(where)h(LP)e(y)h(=)f(cast')h(\(LP)
g(z\))162 2677 y(where)h(RP)e(x)h(=)f(cast')h(\(RP)g(y\))5
2764 y(doFn)g(x)g(=)f(error)i("CantCast")-152 2851 y(instance)g(\(CT)f
(b1,)g(CT)g(b2\))g(=>)f(CT)h(\(b1->b2\))h(where)5 2938
y(doInt)g(x)e(=)h(error)g("CantCast")5 3025 y(doProd)h(x)e(=)h(error)g
("CantCast")5 3112 y(doFn)g(z)g(=)f(x)162 3200 y(where)i(LA)e(y)h(=)f
(cast')h(\(LA)g(z\))162 3287 y(where)h(RA)e(x)h(=)f(cast')h(\(RA)g(y\))
-152 3461 y(cast)g(::)g(\(CF)g(a,)g(CT)f(b\))h(=>)g(a)f(->)h(b)-152
3548 y(cast)g(x)g(=)f(y)h(where)g(I)g(y)f(=)h(cast')g(\(I)g(x\))-152
3761 y Fl(B.)100 b(P)-7 b(ARAMETRIC)25 b(SYMBOL)h(T)-9
b(ABLE)-152 3891 y(B.1)100 b(Dictionary\255passing)25
b(Implementation)-152 3983 y Ff(newtype)41 b(LProd)g(a)e(g)g(d)h(=)f
(LP)h(\(g)g(\(d,)g(a\)\))-152 4070 y(newtype)h(RProd)g(a)e(g)g(d)h(=)f
(RP)h(\(g)g(\(a,)g(d\)\))-152 4157 y(newtype)h(LArrow)g(a)e(g)h(d)f(=)h
(LA)f(\(g)h(\(d)g(->)f(a\)\))-152 4244 y(newtype)i(RArrow)g(a)e(g)h(d)f
(=)h(RA)f(\(g)h(\(a)g(->)f(d\)\))-152 4332 y(newtype)i(Id)f(a)f(=)h(I)f
(a)-152 4506 y(data)h(CF)g(a)g(=)f(CastFromDict)-73 4593
y({)g(cast')i(::)e(forall)i(b)e(g.)h(CT)g(b)f(->)h(g)f(a)h(->)f(g)h(b)f
(})-152 4767 y(data)h(CT)g(b)g(=)-73 4855 y(CastToDict)-73
4942 y({)f(doInt)80 b(::)40 b(\(forall)g(g.)g(g)f(Int)h(->)g(g)g(b\),)5
5029 y(doProd)h(::)f(\(forall)g(a1)g(a2)g(g.)84 5116
y(CF)f(a1)h(->)g(CF)f(a2)h(->)g(g)f(\(a1,a2\))i(->)f(g)f(b\),)5
5203 y(doFn)119 b(::)40 b(\(forall)g(a1)g(a2)g(g.)f(CF)h(a1)g(->)84
5290 y(CF)f(a2)h(->)g(g)f(\(a1->a2\)->)j(g)d(b\))h(})2040
-69 y(--)g(CF)f(dictionary)j(constructors)2040 106 y(cfInt)e(::)g(CF)g
(Int)2040 193 y(cfInt)80 b(=)39 b(CastFromDict)j({)e(cast')g(=)f(doInt)
i(})2040 367 y(cfProd)g(::)e(CF)h(a)g(->)f(CF)h(b)f(->)h(CF)g(\(a,b\))
2040 454 y(cfProd)h(=)e(\\x)h(->)g(\\y)f(->)h(CastFromDict)2158
542 y({)f(cast')i(=)e(\(\\ct)h(->)g(\(doProd)h(ct)e(x)h(y\)\))g(})2040
716 y(cfFn)g(::)g(CF)g(a)f(->)h(CF)f(b)h(->)g(CF)f(\(a->b\))2040
803 y(cfFn)119 b(=)39 b(\\x)h(->)g(\\y)f(->)h(CastFromDict)2158
890 y({)f(cast')i(=)e(\(\\ct)h(->)g(\(doFn)g(ct)g(x)f(y\)\))h(})2040
1065 y(--)g(CT)f(dictionary)j(constructors)2040 1239
y(ctInt)e(::)g(CT)g(Int)2040 1326 y(ctInt)g(=)g(CastToDict)2119
1413 y({)f(doInt)80 b(=)39 b(\(\\x)h(->)g(x\),)2197 1500
y(doProd)h(=)e(\(\\x)h(->)g(error)g("CantCast"\),)2197
1588 y(doFn)119 b(=)39 b(\(\\x)h(->)g(error)g("CantCast"\))i(})2040
1762 y(ctProd)f(::)e(CT)h(b1)g(->)f(CT)h(b2)g(->)f(CT)h(\(b1,)g(b2\))
2040 1849 y(ctProd)h(=)e(\\ctb1)i(->)e(\\ctb2)i(->)e(CastToDict)2119
1936 y({)g(doInt)80 b(=)39 b(\(\\x)h(->)g(error)g("CantCast"\),)2197
2023 y(doProd)h(=)e(\(\\cfa1)i(->)e(\\cfa2)i(->)e(\\z)h(->)2236
2111 y(let)g(LP)g(y)f(=)h(cast')g(cfa1)g(ctb1)g(\(LP)g(z\))2393
2198 y(RP)g(x)f(=)h(cast')g(cfa2)g(ctb2)g(\(RP)g(y\))2236
2285 y(in)g(x\),)2197 2372 y(doFn)119 b(=)39 b(\(\\x)h(->)g(error)g
("CantCast"\))i(})2040 2547 y(ctFn)e(::)g(CT)g(b1)f(->)h(CT)g(b2)f(->)h
(CT)g(\(b1)g(->)f(b2\))2040 2634 y(ctFn)h(=)g(\\ctb1)g(->)g(\\ctb2)g
(->)g(CastToDict)2119 2721 y({)f(doInt)80 b(=)39 b(\(\\x)h(->)g(error)g
("CantCast"\),)2197 2808 y(doProd)h(=)e(\(\\x)h(->)g(error)g
("CantCast"\),)2197 2895 y(doFn)119 b(=)39 b(\(\\cfa1)i(->)e(\\cfa2)i
(->)e(\\z)h(->)2275 2982 y(let)g(LA)g(y)g(=)f(cast')h(cfa1)g(ctb1)h
(\(LA)f(z\))2432 3070 y(RA)g(x)g(=)f(cast')h(cfa2)g(ctb2)h(\(RA)f(y\))
2275 3157 y(in)g(x\))g(})2040 3331 y(--)g(Wrapping)h(up)f(cast')2040
3505 y(cast)g(::)g(CF)g(a)f(->)h(CT)f(b)h(->)g(a)f(->)h(b)2040
3593 y(cast)g(cfa)g(ctb)g(x)g(=)f(y)2197 3680 y(where)h(\(I)g(y\))g(=)f
(cast')i(cfa)e(ctb)h(\(I)g(x\))2040 3891 y Fl(B.2)100
b(Symbol)25 b(T)-9 b(able)25 b(Implementation)2040 3983
y Ff(data)40 b(EntryT)h(=)e(forall)i(b)e(.)h(Entry)g(String)h(b)e(\(CF)
h(b\))2040 4070 y(type)g(Table)h(=)e([)h(EntryT)g(])2040
4244 y(empty)g(::)g(Table)2040 4332 y(empty)g(=)g([])2040
4506 y(--)g(Insertion)h(requires)g(the)f(correct)h(CF)f(dictionary)2040
4593 y(insert)h(::)e(CF)h(a)g(->)f(Table)i(->)e(\(String,)i(a\))f(->)g
(Table)2040 4680 y(insert)h(cf)e(t)h(\(s,a\))g(=)g(\(Entry)g(s)g(a)f
(cf\))h(:)g(t)2040 4855 y(--)g(The)g(first)g(argument)h(to)f(find)g(is)
g(a)f(Cast)h(To)2040 4942 y(--)g(dictionary)2040 5029
y(find)g(::)g(CT)g(a)f(->)h(Table)g(->)g(String)g(->)g(a)2040
5116 y(find)g(ct)g([])g(s)f(=)h(error)g("Not)g(in)g(List")2040
5203 y(find)g(ct)g(\(\()g(Entry)g(s2)g(val)g(cf\))f(:)h(rest\))g(s1)g
(=)2315 5290 y(if)f(s1)h(==)g(s2)f(then)i(cast)f(cf)f(ct)h(val)2315
5378 y(else)g(find)g(ct)g(rest)g(s1)p eop
%%Page: 10 10
10 9 bop -152 19 a Ff(--)40 b(Create)h(a)e(symbol)i(table)f(by)g
(providing)h(the)-152 106 y(--)f(CF)g(dictionary)h(for)f(each)g(entry)
-152 280 y(table)h(::)e(Table)-152 367 y(t1)h(=)f(insert)i(ctInt)f
(empty)h(\(``foo'',)g(6\))-152 454 y(t2)f(=)f(insert)i(\(cfProd)g
(cfInt)f(cfInt\))h(t1)f(\("bar",)g(\(6,6\)\))-152 542
y(table)h(=)e(insert)i(\(cfFn)f(cfInt)g(cfInt\))h(t2)280
629 y(\("add1")g(\(\\x->x+1\))2040 -69 y Fl(B.3)100 b(Sample)25
b(Run)2040 110 y Ff(Main>)40 b(\(find)h(\(ctFn)f(int)g(int\))g(table)h
("add1"\))f(7)2040 197 y(8)2040 284 y(Main>)g(find)h(\(ctProd)f(int)g
(int\))g(table)h("bar")2040 371 y(\(6,6\))2040 459 y(Main>)f(find)h
(\(ctProd)f(int)g(\(ctProd)h(int)f(int\)\))g(table)h("bar")2040
633 y(Program)g(error:)g(CantCast)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
